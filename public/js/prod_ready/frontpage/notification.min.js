function notificationItemOnClick(i){mixpanel.track("Check_Notifications"),window.location=i}function bind_notify_button_toggle(){bind_notify_all_toggle(),bind_notify_msg_toggle(),bind_settings_btn_click()}function bind_notify_all_toggle(){var i=$(".notify_all_unique"),n=$("#notify_all_pane"),e=$(".top-nav-noti-pan-arrow.top-nav-all-noti-arrow"),s=$(".settings-topnav-menu-pane"),t=$(".top-nav-settings-arrow");i.bind("click",function(i){if(i.stopPropagation(),$.ajax({url:"/ajax/notifications/setRead",type:"GET",data:{type:"notify"}}).done(function(){notificationHeartBeat()}),n.is(":visible"))n.slideUp(250,"easeInOutExpo"),e.css("visibility","hidden");else{var a=$(".notify_pane:visible"),o=$(".top-nav-noti-pan-arrow:visible");a.length?(a.slideUp(250,"easeInOutExpo",function(){n.slideDown(250,"easeInOutExpo")}),o.css("visibility","hidden"),e.css("visibility","visible")):(n.slideDown(250,"easeInOutExpo"),e.css("visibility","visible"))}s.hide(),t.css("visibility","hidden")})}function bind_notify_msg_toggle(){var i=$(".notify_msg_unique"),n=$("#notify_msg_pane"),e=$(".top-nav-noti-pan-arrow.top-nav-msg-noti-arrow"),s=$(".settings-topnav-menu-pane"),t=$(".top-nav-settings-arrow");i.click(function(i){if(i.stopPropagation(),$.ajax({url:"/ajax/notifications/setRead",type:"GET",data:{type:"msg"}}).done(function(){newMessageAudio.setUnreadMessageCount(0),notificationHeartBeat()}),n.is(":visible"))n.slideUp(250,"easeInOutExpo"),e.css("visibility","hidden");else{var a=$(".notify_pane:visible"),o=$(".top-nav-noti-pan-arrow:visible");a.length?(a.slideUp(250,"easeInOutExpo",function(){n.slideDown(250,"easeInOutExpo")}),o.css("visibility","hidden"),e.css("visibility","visible")):(n.slideDown(250,"easeInOutExpo"),e.css("visibility","visible"))}s.hide(),t.css("visibility","hidden")})}function bind_settings_btn_click(){var i=$(".settings-menu-icon-section"),n=$(".settings-topnav-menu-pane"),e=$(".top-nav-settings-arrow"),s=$(".top-nav-noti-pan-arrow"),t=$("#notify_msg_pane"),a=$("#notify_all_pane");i.on("click",function(i){i.stopPropagation(),n.hasClass("visible")?(n.show(),n.removeClass("visible"),e.css("visibility","hidden")):(n.addClass("visible"),n.show(),e.css("visibility","visible")),t.slideUp(250,"easeInOutExpo"),a.slideUp(250,"easeInOutExpo"),s.css("visibility","hidden")})}function notificationHeartBeat(){var i=$(".notify_all_unique .unread_count"),n=0;n=void 0==i?0:i.text();var e=$(".notify_msg_unique .unread_count"),s=e.text();void 0==s&&(s=0),setTimeout(function(){$.ajax({url:"/ajax/getTopNavNotification",type:"POST"}).done(function(t){var a=$.parseJSON(t),o="",l=a.notification.unread_cnt,d=a.notification.data,c=$("#notify_all_pane .notify_pane_container");$.each(d,function(i,n){o+='<div class="row notify_page_notify_item" onclick=\'notificationItemOnClick("'+n.link+"\");' >",o+='<div class="small-1 columns '+n.img+'"></div>',o+='<div class="small-8 column notify_message">',o+='<span class="notify_title">'+n.name+"</span>",o+='<span class="notify_snippet">'+n.msg+"</span>",o+="</div>",o+='<div class="small-3 column text-right">',o+='<span class="notify_time">',o+=n.date,o+="</span>",o+="</div>",o+="</div>"}),0==l?(i.removeClass("active"),i.text(l),c.html(o)):l!=n&&(c.html(o),i.text(l),i.addClass("active")),o="";var u=a.messages.unread_cnt,r=a.messages.data,p=$("#notify_msg_pane .notify_pane_container");$.each(r,function(i,n){o+='<div class="row notify_item" onclick=\'notificationItemOnClick("'+n.link+"\");' >",o+='<div class="small-2 column notify_image">',o+='<img src="'+n.img+'"/>',o+="</div>",o+='<div class="small-8 column">',o+='<div class="row">',o+='<div class="small-12 column notify_title">',o+="<span>",o+=n.Name,o+="</span>",o+="</div>",o+="</div>",o+='<div class="row">',o+='<div class="small-12 column notify_snippet">',o+="<span>",o+=n.msg,o+="</span>",o+="</div>",o+="</div>",o+="</div>",o+='<div class="small-2 column notify_date">',o+="<span>",o+=n.date,o+="</span>",o+="</div>",o+="</div>"}),0==u?(e.removeClass("active"),e.text(u),p.html(o)):u!=s&&(p.html(o),e.text(u),e.addClass("active")),$("messageTab.portalTab").hasClass("activeTab")&&$(".messingingWrapper").is(":visible")||newMessageAudio.hasUnreadCountChanged(),notificationHeartBeat()})},5e3)}newMessageAudio={current_unread_count:0,id:0},$(document).ready(function(){bind_notify_button_toggle();var i=parseInt($("#notify_msg .unread_count").text());i=isNaN(i)?0:i,newMessageAudio.setUnreadMessageCount(i)}),$(document).ready(function(){notificationHeartBeat()}),newMessageAudio.setUnreadMessageCount=function(i){newMessageAudio.current_unread_count=i},newMessageAudio.getUnreadMessagesCount=function(){return parseInt($("#notify_msg .unread_count").text())},newMessageAudio.hasUnreadCountChanged=function(){var i=newMessageAudio.getUnreadMessagesCount();i>newMessageAudio.current_unread_count&&(newMessageAudio.setUnreadMessageCount(i),newMessageAudio.makeNewMessageSound())},newMessageAudio.makeNewMessageSound=function(){var i=newMessageAudio.id,n='<iframe id="'+i+'" class="message-sound-clip" style="display: none;" width="0%" scrolling="no" frameborder="no" src="https://s3-us-west-2.amazonaws.com/asset.plexuss.com/college/sounds/pop_drip.wav"></iframe>';$("body").append(n),newMessageAudio.removeSoundElem(i),newMessageAudio.id++},newMessageAudio.removeSoundElem=function(i){setTimeout(function(){var n="iframe.message-sound-clip:not(#"+i+")";$("body").find(n).remove()},5e3)};