function runJoyride(){var t=new EnjoyHint({onStart:function(){$(".joyride-layer").show()},onEnd:function(){$(".joyride-layer").hide(),ride||hasTakenARideofJoy()},onSkip:function(){$(".joyride-layer").hide(),ride||hasTakenARideofJoy()}}),e=[{'next .item[data-name="navtoggle"]':"Use this to open and close your menu.",showSkip:!1},{'next .item[data-name="portal"]':"This is your list. Here, you can add colleges that you are interested in or want to be recruited by.",showSkip:!1},{"next .action.addschools":"Add schools to your list by clicking here.",showSkip:!1},{"next .action.trash":"Move school to trash.",showSkip:!1},{"next .action.compare":"Compare schools side by side to see which one fits your needs more.",showSkip:!1},{'next .item[data-name="messages"]':"This is your Message Inbox. This is where we keep track of all your communication between you and colleges.",showSkip:!1},{'next .item[data-name="recommendationlist"]':'Plexuss will recommend you colleges, you can say "yes" to add to your list, or "no" to remove.',showSkip:!1},{'next .item[data-name="collegesrecruityou"]':'Schools that want to recruit you will show up here. You can say "yes" to add to your list, or "no" to remove.',showSkip:!1},{'next .item[data-name="collegesviewedprofile"]':'Here you can see colleges that have viewed you. You can say "yes" to add to your list, or "no" to remove.',showSkip:!1},{'next .item[data-name="getTrashSchoolList"]':"Restore schools you have blocked communication with.",showSkip:!1}];t.set(e),t.run()}function hasTakenARideofJoy(){$.ajax({url:"/ajax/portal/didJoyride",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{data:1},type:"POST"}).done(function(t){})}function initFunctions(){$(document).foundation(),Plex.messages.initialize()}function loadPortalTabs(t,e){setTopBlackTabs(t);$("#ajaxloader").show();var n;"messages"==t&&e?(console.log("messages called"),n="/ajax/portal/"+t+"/"+e+"/college"):n="/ajax/portal/"+t,$.ajax({type:"GET",url:n,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){$("#ajaxloader").hide(),$("#portalListwrapper").html(e).data("type",t),"messages"===t&&initUserSocketClient()}})}function setTopBlackTabs(t){$(".portalTab").removeClass("activeTab"),"portal"!=t&&"recommendationlist"!=t&&"getTrashSchoolList"!=t||$(".schoolTab").addClass("activeTab"),"messages"==t&&$(".messageTab").addClass("activeTab")}function loadMessageScripts(){Plex.messages.getTopicList(),Plex.messages.startMessageHeartBeatTimer()}function killmessageScripts(){Plex.messages.stopMessageHeartBeatTimer()}function showMenu(t,e){$("."+e).slideToggle(500,function(){$("."+t).toggleClass("run")})}function settingPopup(){$("#portalSettingModel").foundation("reveal","open")}function addSchoolPopup(){$("#portalAddSchoolModel").foundation("reveal","open"),setAutoCompleteForAddSchool()}function setAutoCompleteForAddSchool(){$("#addschool_1").autocomplete({source:"/getAutoCompleteData?zipcode=95376&type=college",minLength:1,select:function(t,e){$(this).data("hsname",e.item.label),$("#addTomyList").data("revealAjax","/ajax/recruiteme/"+e.item.id)}}),$("#addschool_1").change(function(){var t=$(this);t.val()!==t.data("hsname")&&t.val("")})}function applyScholarshipPopup(){$("#applyScholarshipModel").foundation("reveal","open")}function setIframeHeight(t){$("iframe").each(function(e,n){$(n).is(":visible")&&$(this).height(t+"px")})}function stickFooter(t){$(document).scroll(function(t,e){})}function WriteMsg(t){$(".msgloader").show(),$.ajax({type:"GET",url:"/portal/writemessage",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){$(".msgloader").hide(),$("#"+t).html(e)}})}function messageThread(t,e){$(".msgloader").show(),$.ajax({type:"GET",url:"/portal/messagethread",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{ID:e},success:function(e){$(".msgloader").hide(),$("#"+t).html(e)}})}function setCurrMonthText(){$("#curr_month").html($("#calendar .fc-header-title").html())}function addRow(t){var e=document.getElementById(t),n=e.rows.length,i=e.insertRow(n);rowcountvar=document.getElementById("rowcountvar").value,rowcountvar=1*rowcountvar,nval=rowcountvar+1,document.getElementById("rowcountvar").value=nval,i.id="r"+nval,strconc="'dataTable'";var a=i.insertCell(0);a.innerHTML=' <input type="text" name="addschool[]" id="addschool_'+nval+'" placeholder="Start typing college name"><input type="hidden" name="college_id[]" id="college_id_'+nval+'" value="" class="addschool-txt">';var r=i.insertCell(1);r.innerHTML='<img src="/images/nav-icons/deleteIcon.png" title="Delete" onclick="deleteRow('+nval+","+strconc+')" />',collegeAutocomplete("addschool_"+nval,"college_id_"+nval)}function deleteRow(t,e){try{for(var n=document.getElementById(e),i=n.rows.length,a=0;a<i;a++){var r=n.rows[a];r.id=="r"+t&&(n.deleteRow(a),i--,a--)}}catch(s){alert(s)}}function addSchoolList(t){var e=$(".addschool-txt").val();""!=e?(accessLoader(".model-inner-div"),datastring=$(".addschool-txt").serialize(),$.ajax({type:"GET",url:"/addschool",data:{datastring:datastring},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){accessLoader(".model-inner-div"),""!=t&&($("#portalAddSchoolModel").foundation("reveal","close"),loadPortalTabs("manageschool","menu1"))}})):alert("Select College First.")}function setlistStatus(t,e){$(".msgloader").show(),$.ajax({type:"GET",url:"/setliststatus",dataType:"JSON",data:{status:t,ID:e},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){$("#menu-nav-div-"+e).hide(),$(".msgloader").hide();var n="";n='<span class="expand-toggle-span" id="status-span-'+e+'"></span>',$("#status_val"+e).html(t.status_val+""+n),$("#trrow_"+e).css("background-color",t.trcolor)}})}function trashSchool(t){var e={};if(t)e={0:""+t};else{var n=$("#content-list-div input:checked");if(n.length<1)return void alert("Please select a school to place in the trash");$.each(n,function(t,n){var i=$(n).data("info");e[t]=i.id})}json_data=JSON.stringify(e),$.ajax({type:"POST",url:"/ajax/recruiteme/adduserschooltotrash",data:{obj:json_data},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){loadPortalTabs($("#portalListwrapper").data("type"))}})}function restoreSchool(t){var e={};if(t)e={0:t};else{var n=$("#content-list-div input:checked");if(n.length<1)return void alert("Please select a school to restore or click the restore button.");$.each(n,function(t,n){e[t]=$(n).val()})}json_data=JSON.stringify(e),$.ajax({type:"POST",url:"/ajax/recruiteme/restore",data:{obj:json_data},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){loadPortalTabs($("#portalListwrapper").data("type"))}})}function selectCheckbox(t){var e="",n=!1;if($(".check_group").each(function(t,i){$(i).is(":checked")&&(e+=$(i).val()+"|",n=!0)}),e+="0",n){var a,r;"restoreschool"==t?(a="Are you sure want to restore ?",r="The colleges you selected have been restored successfully."):"deleteschool"==t?(a="Are you sure want to permanantly delete?",r="The colleges you selected have been deleted successfully."):(a="Are you sure want to trash ?",r="The colleges you selected have been moved to the trash.");var s=confirm(a);if(1!=s)return!1;accessLoader(".list-table"),$.ajax({url:"/"+t,type:"GET",data:{ID:e},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){accessLoader(".list-table");var n=e.split("|"),a=n.length;for(i=0;i<a;i++){var s=n[i].split("-");$("#trrow_"+s[0]).remove()}$(".menu-nav-div").hide(),alertMsg(r,"success")},error:function(t){$("#Notification-Popup").foundation("reveal","open"),$(document).on("opened.fndtn.reveal","#Notification-Popup",function(){$(".alert-msg-div").html("Server error try again.")})}})}else $("#Notification-Popup").foundation("reveal","open"),$(document).on("opened.fndtn.reveal","#Notification-Popup",function(){$(".alert-msg-div").html("Please choose a record.")})}function checkall(t){$(t).is(":checked")?$(".check_group").each(function(t,e){$(e).prop("checked",!0)}):$(".check_group").each(function(t,e){$(e).prop("checked",!1)})}function Opendiv(t,e,n,i){var a=$(t).parents("tr"),r=$(a).attr("id");if($(a).next("tr").hasClass("subtr"))return void $(a).next("tr").slideToggle("fast");var s=r.split("_");accessLoader(".list-table"),$.ajax({type:"GET",url:"/getnotificationdeatils/"+Plex.ajaxtoken,data:{list_ID:e,tab:n,menu:i},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){accessLoader(".list-table"),$('<tr class="subtr" id="subtr_'+s[1]+'" style="display: none;"><td colspan="6">'+t+"</td></tr>").insertAfter(a),setTimeout(function(){$(a).next("tr").slideToggle("fast")},1e3)},error:function(t){$("#Notification-Popup").foundation("reveal","open"),$(document).on("opened.fndtn.reveal","#Notification-Popup",function(){$(".alert-msg-div").html("Server error try again.")})}})}function settingStatus(t){accessLoader(".model-inner-div");var e=$(".setting_form").serialize();$.ajax({url:"/portal/settingstatus/"+Plex.ajaxtoken,data:{datastring:e,UserId:t},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){accessLoader(".model-inner-div"),$("#portalSettingModel").foundation("reveal","close"),$(".menu-nav-div").hide(),alertMsg("Settings save sucsessfully","info")},error:function(t){$("#Notification-Popup").foundation("reveal","open"),$(document).on("opened.fndtn.reveal","#Notification-Popup",function(){$(".alert-msg-div").html("Server error try again.")})}})}function interestedReasonSetting(t,e){accessLoader(".model-inner-div");var n=$('[name="interested_reason"]').serialize();$.ajax({url:"/portal/interestedSetting/"+Plex.ajaxtoken,data:{datastring:n,UserId:t,collegeID:e},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){accessLoader(".model-inner-div"),$("#PlexussNotificationPopup").foundation("reveal","close"),alertMsg("Settings save sucsessfully","info")},error:function(t){$("#Notification-Popup").foundation("reveal","open"),$(document).on("opened.fndtn.reveal","#Notification-Popup",function(){$(".alert-msg-div").html("Server error try again.")})}})}function orderListSortable(){$("#list-table tbody").sortable({cursor:"move",update:function(t,e){var n="";$("#list-table input[name=check_group]").each(function(t){n=n+","+$(this).val()}),accessLoader(".list-table"),$.getJSON("/portal/updategridorder",{method:"YourMethod",returnFormat:"JSON",listIDs:n},function(t){1==t?(accessLoader(".list-table"),$("#Notification-Popup").foundation("reveal","open"),$(document).on("opened.fndtn.reveal","#Notification-Popup",function(){$(".alert-msg-div").html("Display order updated.")})):($("#Notification-Popup").foundation("reveal","open"),$(document).on("opened.fndtn.reveal","#Notification-Popup",function(){$(".alert-msg-div").html("Sorry, there was a problem updating the display order.")}))})}})}function alertMsg(t,e){$(".portal_alert").show(),$(".portal_alert").addClass(e),$(".alert-div-msg").html(t),$(".portal_alert").delay(4e3).fadeOut(3e3)}function portalCompareSchools(){var t=$('#content-list-div input:not("#select-all-schools"):checked');if(t.length<1)return void alert("Please select a school to compare.");var e="/comparison?UrlSlugs=";$.each(t,function(t,n){var i=$(n).data("info");e+=i.slug+","}),window.location=e}function getUserCollegeInfo(t,e){var t=$(t),n=t.find(".smallArrow"),i=t.parents(".item:first"),a=i.find(".schooldropdown");n.hasClass("active")?(a.hide(300),n.removeClass("active")):($("#ajaxloader").show(),n.addClass("active"),$.ajax({type:"GET",url:"/ajax/recruiteme/portalcollegeinfo/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){$("#ajaxloader").hide(),a.html(t).show(300)}}))}function showUserrecruitInfo(t,e){var t=$(t),n=t.find(".smallArrow"),i=t.parents(".item:first"),a=i.find(".schooldropdown");n.hasClass("active")?(a.hide(300),n.removeClass("active")):($("#ajaxloader").show(),n.addClass("active"),$("#ajaxloader").hide(),a.show(300))}(function(t){function e(t,e,n){switch(arguments.length){case 2:return null!=t?t:e;case 3:return null!=t?t:null!=e?e:n;default:throw new Error("Implement me")}}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function i(t){vt.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function a(t,e){var n=!0;return d(function(){return n&&(i(t),n=!1),e.apply(this,arguments)},e)}function r(t,e){fe[t]||(i(e),fe[t]=!0)}function s(t,e){return function(n){return g(t.call(this,n),e)}}function o(t,e){return function(n){return this.localeData().ordinal(t.call(this,n),e)}}function c(){}function l(t,e){e!==!1&&P(t),u(this,t),this._d=new Date((+t._d))}function h(t){var e=w(t),n=e.year||0,i=e.quarter||0,a=e.month||0,r=e.week||0,s=e.day||0,o=e.hour||0,c=e.minute||0,l=e.second||0,h=e.millisecond||0;this._milliseconds=+h+1e3*l+6e4*c+36e5*o,this._days=+s+7*r,this._months=+a+3*i+12*n,this._data={},this._locale=vt.localeData(),this._bubble()}function d(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return e.hasOwnProperty("toString")&&(t.toString=e.toString),e.hasOwnProperty("valueOf")&&(t.valueOf=e.valueOf),t}function u(t,e){var n,i,a;if("undefined"!=typeof e._isAMomentObject&&(t._isAMomentObject=e._isAMomentObject),"undefined"!=typeof e._i&&(t._i=e._i),"undefined"!=typeof e._f&&(t._f=e._f),"undefined"!=typeof e._l&&(t._l=e._l),"undefined"!=typeof e._strict&&(t._strict=e._strict),"undefined"!=typeof e._tzm&&(t._tzm=e._tzm),"undefined"!=typeof e._isUTC&&(t._isUTC=e._isUTC),"undefined"!=typeof e._offset&&(t._offset=e._offset),"undefined"!=typeof e._pf&&(t._pf=e._pf),"undefined"!=typeof e._locale&&(t._locale=e._locale),Mt.length>0)for(n in Mt)i=Mt[n],a=e[i],"undefined"!=typeof a&&(t[i]=a);return t}function f(t){return 0>t?Math.ceil(t):Math.floor(t)}function g(t,e,n){for(var i=""+Math.abs(t),a=t>=0;i.length<e;)i="0"+i;return(a?n?"+":"":"-")+i}function p(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function m(t,e){var n;return e=R(e,t),t.isBefore(e)?n=p(t,e):(n=p(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function v(t,e){return function(n,i){var a,s;return null===i||isNaN(+i)||(r(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period)."),s=n,n=i,i=s),n="string"==typeof n?+n:n,a=vt.duration(n,i),_(this,a,t),this}}function _(t,e,n,i){var a=e._milliseconds,r=e._days,s=e._months;i=null==i||i,a&&t._d.setTime(+t._d+a*n),r&&dt(t,"Date",ht(t,"Date")+r*n),s&&lt(t,ht(t,"Month")+s*n),i&&vt.updateOffset(t,r||s)}function y(t){return"[object Array]"===Object.prototype.toString.call(t)}function b(t){return"[object Date]"===Object.prototype.toString.call(t)||t instanceof Date}function S(t,e,n){var i,a=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0;for(i=0;a>i;i++)(n&&t[i]!==e[i]||!n&&T(t[i])!==T(e[i]))&&s++;return s+r}function x(t){if(t){var e=t.toLowerCase().replace(/(.)s$/,"$1");t=se[t]||oe[e]||e}return t}function w(t){var e,n,i={};for(n in t)t.hasOwnProperty(n)&&(e=x(n),e&&(i[e]=t[n]));return i}function C(e){var n,i;if(0===e.indexOf("week"))n=7,i="day";else{if(0!==e.indexOf("month"))return;n=12,i="month"}vt[e]=function(a,r){var s,o,c=vt._locale[e],l=[];if("number"==typeof a&&(r=a,a=t),o=function(t){var e=vt().utc().set(i,t);return c.call(vt._locale,e,a||"")},null!=r)return o(r);for(s=0;n>s;s++)l.push(o(s));return l}}function T(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=e>=0?Math.floor(e):Math.ceil(e)),n}function K(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function D(t,e,n){return rt(vt([t,11,31+e-n]),e,n).week}function k(t){return F(t)?366:365}function F(t){return t%4===0&&t%100!==0||t%400===0}function P(t){var e;t._a&&-2===t._pf.overflow&&(e=t._a[Ct]<0||t._a[Ct]>11?Ct:t._a[Tt]<1||t._a[Tt]>K(t._a[wt],t._a[Ct])?Tt:t._a[Kt]<0||t._a[Kt]>23?Kt:t._a[Dt]<0||t._a[Dt]>59?Dt:t._a[kt]<0||t._a[kt]>59?kt:t._a[Ft]<0||t._a[Ft]>999?Ft:-1,t._pf._overflowDayOfYear&&(wt>e||e>Tt)&&(e=Tt),t._pf.overflow=e)}function M(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length)),t._isValid}function A(t){return t?t.toLowerCase().replace("_","-"):t}function I(t){for(var e,n,i,a,r=0;r<t.length;){for(a=A(t[r]).split("-"),e=a.length,n=A(t[r+1]),n=n?n.split("-"):null;e>0;){if(i=L(a.slice(0,e).join("-")))return i;if(n&&n.length>=e&&S(a,n,!0)>=e-1)break;e--}r++}return null}function L(t){var e=null;if(!Pt[t]&&At)try{e=vt.locale(),require("./locale/"+t),vt.locale(e)}catch(n){}return Pt[t]}function R(t,e){return e._isUTC?vt(t).zone(e._offset||0):vt(t).local()}function N(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function G(t){var e,n,i=t.match(Nt);for(e=0,n=i.length;n>e;e++)i[e]=ue[i[e]]?ue[i[e]]:N(i[e]);return function(a){var r="";for(e=0;n>e;e++)r+=i[e]instanceof Function?i[e].call(a,t):i[e];return r}}function j(t,e){return t.isValid()?(e=$(e,t.localeData()),ce[e]||(ce[e]=G(e)),ce[e](t)):t.localeData().invalidDate()}function $(t,e){function n(t){return e.longDateFormat(t)||t}var i=5;for(Gt.lastIndex=0;i>=0&&Gt.test(t);)t=t.replace(Gt,n),Gt.lastIndex=0,i-=1;return t}function O(t,e){var n,i=e._strict;switch(t){case"Q":return Xt;case"DDDD":return Jt;case"YYYY":case"GGGG":case"gggg":return i?Vt:Ot;case"Y":case"G":case"g":return Zt;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?Qt:Ut;case"S":if(i)return Xt;case"SS":if(i)return qt;case"SSS":if(i)return Jt;case"DDD":return $t;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Et;case"a":case"A":return e._locale._meridiemParse;case"X":return Bt;case"Z":case"ZZ":return Yt;case"T":return Wt;case"SSSS":return Ht;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?qt:jt;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return jt;case"Do":return zt;default:return n=new RegExp(q(X(t.replace("\\","")),"i"))}}function U(t){t=t||"";var e=t.match(Yt)||[],n=e[e.length-1]||[],i=(n+"").match(ae)||["-",0,0],a=+(60*i[1])+T(i[2]);return"+"===i[0]?-a:a}function H(t,e,n){var i,a=n._a;switch(t){case"Q":null!=e&&(a[Ct]=3*(T(e)-1));break;case"M":case"MM":null!=e&&(a[Ct]=T(e)-1);break;case"MMM":case"MMMM":i=n._locale.monthsParse(e),null!=i?a[Ct]=i:n._pf.invalidMonth=e;break;case"D":case"DD":null!=e&&(a[Tt]=T(e));break;case"Do":null!=e&&(a[Tt]=T(parseInt(e,10)));break;case"DDD":case"DDDD":null!=e&&(n._dayOfYear=T(e));break;case"YY":a[wt]=vt.parseTwoDigitYear(e);break;case"YYYY":case"YYYYY":case"YYYYYY":a[wt]=T(e);break;case"a":case"A":n._isPm=n._locale.isPM(e);break;case"H":case"HH":case"h":case"hh":a[Kt]=T(e);break;case"m":case"mm":a[Dt]=T(e);break;case"s":case"ss":a[kt]=T(e);break;case"S":case"SS":case"SSS":case"SSSS":a[Ft]=T(1e3*("0."+e));break;case"X":n._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=U(e);break;case"dd":case"ddd":case"dddd":i=n._locale.weekdaysParse(e),null!=i?(n._w=n._w||{},n._w.d=i):n._pf.invalidWeekday=e;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":t=t.substr(0,1);case"gggg":case"GGGG":case"GGGGG":t=t.substr(0,2),e&&(n._w=n._w||{},n._w[t]=T(e));break;case"gg":case"GG":n._w=n._w||{},n._w[t]=vt.parseTwoDigitYear(e)}}function E(t){var n,i,a,r,s,o,c;n=t._w,null!=n.GG||null!=n.W||null!=n.E?(s=1,o=4,i=e(n.GG,t._a[wt],rt(vt(),1,4).year),a=e(n.W,1),r=e(n.E,1)):(s=t._locale._week.dow,o=t._locale._week.doy,i=e(n.gg,t._a[wt],rt(vt(),s,o).year),a=e(n.w,1),null!=n.d?(r=n.d,s>r&&++a):r=null!=n.e?n.e+s:s),c=st(i,a,r,o,s),t._a[wt]=c.year,t._dayOfYear=c.dayOfYear}function Y(t){var n,i,a,r,s=[];if(!t._d){for(a=B(t),t._w&&null==t._a[Tt]&&null==t._a[Ct]&&E(t),t._dayOfYear&&(r=e(t._a[wt],a[wt]),t._dayOfYear>k(r)&&(t._pf._overflowDayOfYear=!0),i=et(r,0,t._dayOfYear),t._a[Ct]=i.getUTCMonth(),t._a[Tt]=i.getUTCDate()),n=0;3>n&&null==t._a[n];++n)t._a[n]=s[n]=a[n];for(;7>n;n++)t._a[n]=s[n]=null==t._a[n]?2===n?1:0:t._a[n];t._d=(t._useUTC?et:tt).apply(null,s),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()+t._tzm)}}function W(t){var e;t._d||(e=w(t._i),t._a=[e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond],Y(t))}function B(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function z(t){if(t._f===vt.ISO_8601)return void V(t);t._a=[],t._pf.empty=!0;var e,n,i,a,r,s=""+t._i,o=s.length,c=0;for(i=$(t._f,t._locale).match(Nt)||[],e=0;e<i.length;e++)a=i[e],n=(s.match(O(a,t))||[])[0],n&&(r=s.substr(0,s.indexOf(n)),r.length>0&&t._pf.unusedInput.push(r),s=s.slice(s.indexOf(n)+n.length),c+=n.length),ue[a]?(n?t._pf.empty=!1:t._pf.unusedTokens.push(a),H(a,n,t)):t._strict&&!n&&t._pf.unusedTokens.push(a);t._pf.charsLeftOver=o-c,s.length>0&&t._pf.unusedInput.push(s),t._isPm&&t._a[Kt]<12&&(t._a[Kt]+=12),t._isPm===!1&&12===t._a[Kt]&&(t._a[Kt]=0),Y(t),P(t)}function X(t){return t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,i,a){return e||n||i||a})}function q(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function J(t){var e,i,a,r,s;if(0===t._f.length)return t._pf.invalidFormat=!0,void(t._d=new Date(NaN));for(r=0;r<t._f.length;r++)s=0,e=u({},t),e._pf=n(),e._f=t._f[r],z(e),M(e)&&(s+=e._pf.charsLeftOver,s+=10*e._pf.unusedTokens.length,e._pf.score=s,(null==a||a>s)&&(a=s,i=e));d(t,i||e)}function V(t){var e,n,i=t._i,a=te.exec(i);if(a){for(t._pf.iso=!0,e=0,n=ne.length;n>e;e++)if(ne[e][1].exec(i)){t._f=ne[e][0]+(a[6]||" ");break}for(e=0,n=ie.length;n>e;e++)if(ie[e][1].exec(i)){t._f+=ie[e][0];break}i.match(Yt)&&(t._f+="Z"),z(t)}else t._isValid=!1}function Q(t){V(t),t._isValid===!1&&(delete t._isValid,vt.createFromInputFallback(t))}function Z(e){var n,i=e._i;i===t?e._d=new Date:b(i)?e._d=new Date((+i)):null!==(n=It.exec(i))?e._d=new Date((+n[1])):"string"==typeof i?Q(e):y(i)?(e._a=i.slice(0),Y(e)):"object"==typeof i?W(e):"number"==typeof i?e._d=new Date(i):vt.createFromInputFallback(e)}function tt(t,e,n,i,a,r,s){var o=new Date(t,e,n,i,a,r,s);return 1970>t&&o.setFullYear(t),o}function et(t){var e=new Date(Date.UTC.apply(null,arguments));return 1970>t&&e.setUTCFullYear(t),e}function nt(t,e){if("string"==typeof t)if(isNaN(t)){if(t=e.weekdaysParse(t),"number"!=typeof t)return null}else t=parseInt(t,10);return t}function it(t,e,n,i,a){return a.relativeTime(e||1,!!n,t,i)}function at(t,e,n){var i=vt.duration(t).abs(),a=xt(i.as("s")),r=xt(i.as("m")),s=xt(i.as("h")),o=xt(i.as("d")),c=xt(i.as("M")),l=xt(i.as("y")),h=a<le.s&&["s",a]||1===r&&["m"]||r<le.m&&["mm",r]||1===s&&["h"]||s<le.h&&["hh",s]||1===o&&["d"]||o<le.d&&["dd",o]||1===c&&["M"]||c<le.M&&["MM",c]||1===l&&["y"]||["yy",l];return h[2]=e,h[3]=+t>0,h[4]=n,it.apply({},h)}function rt(t,e,n){var i,a=n-e,r=n-t.day();return r>a&&(r-=7),a-7>r&&(r+=7),i=vt(t).add(r,"d"),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function st(t,e,n,i,a){var r,s,o=et(t,0,1).getUTCDay();return o=0===o?7:o,n=null!=n?n:a,r=a-o+(o>i?7:0)-(a>o?7:0),s=7*(e-1)+(n-a)+r+1,{year:s>0?t:t-1,dayOfYear:s>0?s:k(t-1)+s}}function ot(e){var n=e._i,i=e._f;return e._locale=e._locale||vt.localeData(e._l),null===n||i===t&&""===n?vt.invalid({nullInput:!0}):("string"==typeof n&&(e._i=n=e._locale.preparse(n)),vt.isMoment(n)?new l(n,(!0)):(i?y(i)?J(e):z(e):Z(e),new l(e)))}function ct(t,e){var n,i;if(1===e.length&&y(e[0])&&(e=e[0]),!e.length)return vt();for(n=e[0],i=1;i<e.length;++i)e[i][t](n)&&(n=e[i]);return n}function lt(t,e){var n;return"string"==typeof e&&(e=t.localeData().monthsParse(e),"number"!=typeof e)?t:(n=Math.min(t.date(),K(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t)}function ht(t,e){return t._d["get"+(t._isUTC?"UTC":"")+e]()}function dt(t,e,n){return"Month"===e?lt(t,n):t._d["set"+(t._isUTC?"UTC":"")+e](n)}function ut(t,e){return function(n){return null!=n?(dt(this,t,n),vt.updateOffset(this,e),this):ht(this,t)}}function ft(t){return 400*t/146097}function gt(t){return 146097*t/400}function pt(t){vt.duration.fn[t]=function(){return this._data[t]}}function mt(t){"undefined"==typeof ender&&(_t=St.moment,St.moment=t?a("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",vt):vt)}for(var vt,_t,yt,bt="2.8.1",St="undefined"!=typeof global?global:this,xt=Math.round,wt=0,Ct=1,Tt=2,Kt=3,Dt=4,kt=5,Ft=6,Pt={},Mt=[],At="undefined"!=typeof module&&module.exports,It=/^\/?Date\((\-?\d+)/i,Lt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Rt=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Nt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Gt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,jt=/\d\d?/,$t=/\d{1,3}/,Ot=/\d{1,4}/,Ut=/[+\-]?\d{1,6}/,Ht=/\d+/,Et=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Yt=/Z|[\+\-]\d\d:?\d\d/gi,Wt=/T/i,Bt=/[\+\-]?\d+(\.\d{1,3})?/,zt=/\d{1,2}/,Xt=/\d/,qt=/\d\d/,Jt=/\d{3}/,Vt=/\d{4}/,Qt=/[+-]?\d{6}/,Zt=/[+-]?\d+/,te=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ee="YYYY-MM-DDTHH:mm:ssZ",ne=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],ie=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ae=/([\+\-]|\d\d)/gi,re=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),se={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},oe={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ce={},le={s:45,m:45,h:22,d:26,M:11},he="DDD w W M D d".split(" "),de="M D H h m s w W".split(" "),ue={M:function(){return this.month()+1},MMM:function(t){return this.localeData().monthsShort(this,t)},MMMM:function(t){return this.localeData().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.localeData().weekdaysMin(this,t)},ddd:function(t){return this.localeData().weekdaysShort(this,t)},dddd:function(t){return this.localeData().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return g(this.year()%100,2)},YYYY:function(){return g(this.year(),4)},YYYYY:function(){return g(this.year(),5)},YYYYYY:function(){var t=this.year(),e=t>=0?"+":"-";return e+g(Math.abs(t),6)},gg:function(){return g(this.weekYear()%100,2)},gggg:function(){return g(this.weekYear(),4)},ggggg:function(){return g(this.weekYear(),5)},GG:function(){return g(this.isoWeekYear()%100,2)},GGGG:function(){return g(this.isoWeekYear(),4)},GGGGG:function(){return g(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return T(this.milliseconds()/100)},SS:function(){return g(T(this.milliseconds()/10),2)},SSS:function(){return g(this.milliseconds(),3)},SSSS:function(){return g(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+g(T(t/60),2)+":"+g(T(t)%60,2)},ZZ:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+g(T(t/60),2)+g(T(t)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},fe={},ge=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];he.length;)yt=he.pop(),ue[yt+"o"]=o(ue[yt],yt);for(;de.length;)yt=de.pop(),ue[yt+yt]=s(ue[yt],2);ue.DDDD=s(ue.DDD,3),d(c.prototype,{set:function(t){var e,n;for(n in t)e=t[n],"function"==typeof e?this[n]=e:this["_"+n]=e},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t){var e,n,i;for(this._monthsParse||(this._monthsParse=[]),e=0;12>e;e++)if(this._monthsParse[e]||(n=vt.utc([2e3,e]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[e]=new RegExp(i.replace(".",""),"i")),this._monthsParse[e].test(t))return e},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(n=vt([2e3,1]).day(e),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[e]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e){var n=this._calendar[t];return"function"==typeof n?n.apply(e):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,n,i){var a=this._relativeTime[n];return"function"==typeof a?a(t,e,n,i):a.replace(/%d/i,t)},pastFuture:function(t,e){var n=this._relativeTime[t>0?"future":"past"];return"function"==typeof n?n(e):n.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",preparse:function(t){return t},postformat:function(t){return t},week:function(t){return rt(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),vt=function(e,i,a,r){var s;return"boolean"==typeof a&&(r=a,a=t),s={},s._isAMomentObject=!0,s._i=e,s._f=i,s._l=a,s._strict=r,s._isUTC=!1,s._pf=n(),ot(s)},vt.suppressDeprecationWarnings=!1,vt.createFromInputFallback=a("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(t){
t._d=new Date(t._i)}),vt.min=function(){var t=[].slice.call(arguments,0);return ct("isBefore",t)},vt.max=function(){var t=[].slice.call(arguments,0);return ct("isAfter",t)},vt.utc=function(e,i,a,r){var s;return"boolean"==typeof a&&(r=a,a=t),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=a,s._i=e,s._f=i,s._strict=r,s._pf=n(),ot(s).utc()},vt.unix=function(t){return vt(1e3*t)},vt.duration=function(t,e){var n,i,a,r,s=t,o=null;return vt.isDuration(t)?s={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(s={},e?s[e]=t:s.milliseconds=t):(o=Lt.exec(t))?(n="-"===o[1]?-1:1,s={y:0,d:T(o[Tt])*n,h:T(o[Kt])*n,m:T(o[Dt])*n,s:T(o[kt])*n,ms:T(o[Ft])*n}):(o=Rt.exec(t))?(n="-"===o[1]?-1:1,a=function(t){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*n},s={y:a(o[2]),M:a(o[3]),d:a(o[4]),h:a(o[5]),m:a(o[6]),s:a(o[7]),w:a(o[8])}):"object"==typeof s&&("from"in s||"to"in s)&&(r=m(vt(s.from),vt(s.to)),s={},s.ms=r.milliseconds,s.M=r.months),i=new h(s),vt.isDuration(t)&&t.hasOwnProperty("_locale")&&(i._locale=t._locale),i},vt.version=bt,vt.defaultFormat=ee,vt.ISO_8601=function(){},vt.momentProperties=Mt,vt.updateOffset=function(){},vt.relativeTimeThreshold=function(e,n){return le[e]!==t&&(n===t?le[e]:(le[e]=n,!0))},vt.lang=a("moment.lang is deprecated. Use moment.locale instead.",function(t,e){return vt.locale(t,e)}),vt.locale=function(t,e){var n;return t&&(n="undefined"!=typeof e?vt.defineLocale(t,e):vt.localeData(t),n&&(vt.duration._locale=vt._locale=n)),vt._locale._abbr},vt.defineLocale=function(t,e){return null!==e?(e.abbr=t,Pt[t]||(Pt[t]=new c),Pt[t].set(e),vt.locale(t),Pt[t]):(delete Pt[t],null)},vt.langData=a("moment.langData is deprecated. Use moment.localeData instead.",function(t){return vt.localeData(t)}),vt.localeData=function(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return vt._locale;if(!y(t)){if(e=L(t))return e;t=[t]}return I(t)},vt.isMoment=function(t){return t instanceof l||null!=t&&t.hasOwnProperty("_isAMomentObject")},vt.isDuration=function(t){return t instanceof h};for(yt=ge.length-1;yt>=0;--yt)C(ge[yt]);vt.normalizeUnits=function(t){return x(t)},vt.invalid=function(t){var e=vt.utc(NaN);return null!=t?d(e._pf,t):e._pf.userInvalidated=!0,e},vt.parseZone=function(){return vt.apply(null,arguments).parseZone()},vt.parseTwoDigitYear=function(t){return T(t)+(T(t)>68?1900:2e3)},d(vt.fn=l.prototype,{clone:function(){return vt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date((+this)):this._d},toISOString:function(){var t=vt(this).utc();return 0<t.year()&&t.year()<=9999?j(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):j(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return M(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&S(this._a,(this._isUTC?vt.utc(this._a):vt(this._a)).toArray())>0)},parsingFlags:function(){return d({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(t){return this.zone(0,t)},local:function(t){return this._isUTC&&(this.zone(0,t),this._isUTC=!1,t&&this.add(this._d.getTimezoneOffset(),"m")),this},format:function(t){var e=j(this,t||vt.defaultFormat);return this.localeData().postformat(e)},add:v(1,"add"),subtract:v(-1,"subtract"),diff:function(t,e,n){var i,a,r=R(t,this),s=6e4*(this.zone()-r.zone());return e=x(e),"year"===e||"month"===e?(i=432e5*(this.daysInMonth()+r.daysInMonth()),a=12*(this.year()-r.year())+(this.month()-r.month()),a+=(this-vt(this).startOf("month")-(r-vt(r).startOf("month")))/i,a-=6e4*(this.zone()-vt(this).startOf("month").zone()-(r.zone()-vt(r).startOf("month").zone()))/i,"year"===e&&(a/=12)):(i=this-r,a="second"===e?i/1e3:"minute"===e?i/6e4:"hour"===e?i/36e5:"day"===e?(i-s)/864e5:"week"===e?(i-s)/6048e5:i),n?a:f(a)},from:function(t,e){return vt.duration({to:this,from:t}).locale(this.locale()).humanize(!e)},fromNow:function(t){return this.from(vt(),t)},calendar:function(t){var e=t||vt(),n=R(e,this).startOf("day"),i=this.diff(n,"days",!0),a=-6>i?"sameElse":-1>i?"lastWeek":0>i?"lastDay":1>i?"sameDay":2>i?"nextDay":7>i?"nextWeek":"sameElse";return this.format(this.localeData().calendar(a,this))},isLeapYear:function(){return F(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=nt(t,this.localeData()),this.add(t-e,"d")):e},month:ut("Month",!0),startOf:function(t){switch(t=x(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t?this.weekday(0):"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(t){return t=x(t),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")},isAfter:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)>+vt(t).startOf(e)},isBefore:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)<+vt(t).startOf(e)},isSame:function(t,e){return e=e||"ms",+this.clone().startOf(e)===+R(t,this).startOf(e)},min:a("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(t){return t=vt.apply(null,arguments),this>t?this:t}),max:a("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(t){return t=vt.apply(null,arguments),t>this?this:t}),zone:function(t,e){var n,i=this._offset||0;return null==t?this._isUTC?i:this._d.getTimezoneOffset():("string"==typeof t&&(t=U(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&e&&(n=this._d.getTimezoneOffset()),this._offset=t,this._isUTC=!0,null!=n&&this.subtract(n,"m"),i!==t&&(!e||this._changeInProgress?_(this,vt.duration(i-t,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,vt.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(t){return t=t?vt(t).zone():0,(this.zone()-t)%60===0},daysInMonth:function(){return K(this.year(),this.month())},dayOfYear:function(t){var e=xt((vt(this).startOf("day")-vt(this).startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},quarter:function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},weekYear:function(t){var e=rt(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==t?e:this.add(t-e,"y")},isoWeekYear:function(t){var e=rt(this,1,4).year;return null==t?e:this.add(t-e,"y")},week:function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},isoWeek:function(t){var e=rt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},weekday:function(t){var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},isoWeeksInYear:function(){return D(this.year(),1,4)},weeksInYear:function(){var t=this.localeData()._week;return D(this.year(),t.dow,t.doy)},get:function(t){return t=x(t),this[t]()},set:function(t,e){return t=x(t),"function"==typeof this[t]&&this[t](e),this},locale:function(e){return e===t?this._locale._abbr:(this._locale=vt.localeData(e),this)},lang:a("moment().lang() is deprecated. Use moment().localeData() instead.",function(e){return e===t?this.localeData():(this._locale=vt.localeData(e),this)}),localeData:function(){return this._locale}}),vt.fn.millisecond=vt.fn.milliseconds=ut("Milliseconds",!1),vt.fn.second=vt.fn.seconds=ut("Seconds",!1),vt.fn.minute=vt.fn.minutes=ut("Minutes",!1),vt.fn.hour=vt.fn.hours=ut("Hours",!0),vt.fn.date=ut("Date",!0),vt.fn.dates=a("dates accessor is deprecated. Use date instead.",ut("Date",!0)),vt.fn.year=ut("FullYear",!0),vt.fn.years=a("years accessor is deprecated. Use year instead.",ut("FullYear",!0)),vt.fn.days=vt.fn.day,vt.fn.months=vt.fn.month,vt.fn.weeks=vt.fn.week,vt.fn.isoWeeks=vt.fn.isoWeek,vt.fn.quarters=vt.fn.quarter,vt.fn.toJSON=vt.fn.toISOString,d(vt.duration.fn=h.prototype,{_bubble:function(){var t,e,n,i=this._milliseconds,a=this._days,r=this._months,s=this._data,o=0;s.milliseconds=i%1e3,t=f(i/1e3),s.seconds=t%60,e=f(t/60),s.minutes=e%60,n=f(e/60),s.hours=n%24,a+=f(n/24),o=f(ft(a)),a-=f(gt(o)),r+=f(a/30),a%=30,o+=f(r/12),r%=12,s.days=a,s.months=r,s.years=o},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return f(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*T(this._months/12)},humanize:function(t){var e=at(this,!t,this.localeData());return t&&(e=this.localeData().pastFuture(+this,e)),this.localeData().postformat(e)},add:function(t,e){var n=vt.duration(t,e);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(t,e){var n=vt.duration(t,e);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(t){return t=x(t),this[t.toLowerCase()+"s"]()},as:function(t){var e,n;if(t=x(t),e=this._days+this._milliseconds/864e5,"month"===t||"year"===t)return n=this._months+12*ft(e),"month"===t?n:n/12;switch(e+=gt(this._months/12),t){case"week":return e/7;case"day":return e;case"hour":return 24*e;case"minute":return 24*e*60;case"second":return 24*e*60*60;case"millisecond":return 24*e*60*60*1e3;default:throw new Error("Unknown unit "+t)}},lang:vt.fn.lang,locale:vt.fn.locale,toIsoString:a("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var t=Math.abs(this.years()),e=Math.abs(this.months()),n=Math.abs(this.days()),i=Math.abs(this.hours()),a=Math.abs(this.minutes()),r=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(t?t+"Y":"")+(e?e+"M":"")+(n?n+"D":"")+(i||a||r?"T":"")+(i?i+"H":"")+(a?a+"M":"")+(r?r+"S":""):"P0D"},localeData:function(){return this._locale}});for(yt in re)re.hasOwnProperty(yt)&&pt(yt.toLowerCase());vt.duration.fn.asMilliseconds=function(){return this.as("ms")},vt.duration.fn.asSeconds=function(){return this.as("s")},vt.duration.fn.asMinutes=function(){return this.as("m")},vt.duration.fn.asHours=function(){return this.as("h")},vt.duration.fn.asDays=function(){return this.as("d")},vt.duration.fn.asWeeks=function(){return this.as("weeks")},vt.duration.fn.asMonths=function(){return this.as("M")},vt.duration.fn.asYears=function(){return this.as("y")},vt.locale("en",{ordinal:function(t){var e=t%10,n=1===T(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),At?module.exports=vt:"function"==typeof define&&define.amd?(define("moment",function(t,e,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(St.moment=_t),vt}),mt(!0)):mt()}).call(this),function(t,e,n){!function(t){"use strict";"function"==typeof define&&define.amd?define("datatables",["jquery"],t):"object"==typeof exports?t(require("jquery")):jQuery&&!jQuery.fn.dataTable&&t(jQuery)}(function(i){"use strict";function a(t){var e,n,r="a aa ai ao as b fn i m o s ",s={};i.each(t,function(i,o){e=i.match(/^([^A-Z]+?)([A-Z])/),e&&r.indexOf(e[1]+" ")!==-1&&(n=i.replace(e[0],e[2].toLowerCase()),s[n]=i,"o"===e[1]&&a(t[i]))}),t._hungarianMap=s}function r(t,e,s){t._hungarianMap||a(t);var o;i.each(e,function(a,c){o=t._hungarianMap[a],o===n||!s&&e[o]!==n||("o"===o.charAt(0)?(e[o]||(e[o]={}),i.extend(!0,e[o],e[a]),r(t[o],e[o],s)):e[o]=e[a])})}function s(t){var e=Xt.defaults.oLanguage,n=t.sZeroRecords;!t.sEmptyTable&&n&&"No data available in table"===e.sEmptyTable&&Gt(t,t,"sZeroRecords","sEmptyTable"),!t.sLoadingRecords&&n&&"Loading..."===e.sLoadingRecords&&Gt(t,t,"sZeroRecords","sLoadingRecords"),t.sInfoThousands&&(t.sThousands=t.sInfoThousands);var i=t.sDecimal;i&&Bt(i)}function o(t){ve(t,"ordering","bSort"),ve(t,"orderMulti","bSortMulti"),ve(t,"orderClasses","bSortClasses"),ve(t,"orderCellsTop","bSortCellsTop"),ve(t,"order","aaSorting"),ve(t,"orderFixed","aaSortingFixed"),ve(t,"paging","bPaginate"),ve(t,"pagingType","sPaginationType"),ve(t,"pageLength","iDisplayLength"),ve(t,"searching","bFilter");var e=t.aoSearchCols;if(e)for(var n=0,i=e.length;n<i;n++)e[n]&&r(Xt.models.oSearch,e[n])}function c(t){ve(t,"orderable","bSortable"),ve(t,"orderData","aDataSort"),ve(t,"orderSequence","asSorting"),ve(t,"orderDataType","sortDataType")}function l(t){var e=t.oBrowser,n=i("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(i("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(i('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),a=n.find(".test");e.bScrollOversize=100===a[0].offsetWidth,e.bScrollbarLeft=1!==a.offset().left,n.remove()}function h(t,e,i,a,r,s){var o,c=a,l=!1;for(i!==n&&(o=i,l=!0);c!==r;)t.hasOwnProperty(c)&&(o=l?e(o,t[c],c,t):t[c],l=!0,c+=s);return o}function d(t,n){var a=Xt.defaults.column,r=t.aoColumns.length,s=i.extend({},Xt.models.oColumn,a,{nTh:n?n:e.createElement("th"),sTitle:a.sTitle?a.sTitle:n?n.innerHTML:"",aDataSort:a.aDataSort?a.aDataSort:[r],mData:a.mData?a.mData:r,idx:r});t.aoColumns.push(s);var o=t.aoPreSearchCols;o[r]=i.extend({},Xt.models.oSearch,o[r]),u(t,r,null)}function u(t,e,a){var s=t.aoColumns[e],o=t.oClasses,l=i(s.nTh);if(!s.sWidthOrig){s.sWidthOrig=l.attr("width")||null;var h=(l.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);h&&(s.sWidthOrig=h[1])}a!==n&&null!==a&&(c(a),r(Xt.defaults.column,a),a.mDataProp===n||a.mData||(a.mData=a.mDataProp),a.sType&&(s._sManualType=a.sType),a.className&&!a.sClass&&(a.sClass=a.className),i.extend(s,a),Gt(s,a,"sWidth","sWidthOrig"),"number"==typeof a.iDataSort&&(s.aDataSort=[a.iDataSort]),Gt(s,a,"aDataSort"));var d=s.mData,u=D(d),f=s.mRender?D(s.mRender):null,g=function(t){return"string"==typeof t&&t.indexOf("@")!==-1};s._bAttrSrc=i.isPlainObject(d)&&(g(d.sort)||g(d.type)||g(d.filter)),s.fnGetData=function(t,e,i){var a=u(t,e,n,i);return f&&e?f(a,e,t,i):a},s.fnSetData=function(t,e,n){return k(d)(t,e,n)},t.oFeatures.bSort||(s.bSortable=!1,l.addClass(o.sSortableNone));var p=i.inArray("asc",s.asSorting)!==-1,m=i.inArray("desc",s.asSorting)!==-1;s.bSortable&&(p||m)?p&&!m?(s.sSortingClass=o.sSortableAsc,s.sSortingClassJUI=o.sSortJUIAscAllowed):!p&&m?(s.sSortingClass=o.sSortableDesc,s.sSortingClassJUI=o.sSortJUIDescAllowed):(s.sSortingClass=o.sSortable,s.sSortingClassJUI=o.sSortJUI):(s.sSortingClass=o.sSortableNone,s.sSortingClassJUI="")}function f(t){if(t.oFeatures.bAutoWidth!==!1){var e=t.aoColumns;_t(t);for(var n=0,i=e.length;n<i;n++)e[n].nTh.style.width=e[n].sWidth}var a=t.oScroll;""===a.sY&&""===a.sX||mt(t),Ut(t,null,"column-sizing",[t])}function g(t,e){var n=v(t,"bVisible");return"number"==typeof n[e]?n[e]:null}function p(t,e){var n=v(t,"bVisible"),a=i.inArray(e,n);return a!==-1?a:null}function m(t){return v(t,"bVisible").length}function v(t,e){var n=[];return i.map(t.aoColumns,function(t,i){t[e]&&n.push(i)}),n}function _(t){var e,i,a,r,s,o,c,l,h,d=t.aoColumns,u=t.aoData,f=Xt.ext.type.detect;for(e=0,i=d.length;e<i;e++)if(c=d[e],h=[],!c.sType&&c._sManualType)c.sType=c._sManualType;else if(!c.sType){for(a=0,r=f.length;a<r;a++){for(s=0,o=u.length;s<o&&(h[s]===n&&(h[s]=C(t,s,e,"type")),l=f[a](h[s],t),l&&"html"!==l);s++);if(l){c.sType=l;break}}c.sType||(c.sType="string")}}function y(t,e,a,r){var s,o,c,l,h,u,f,g=t.aoColumns;if(e)for(s=e.length-1;s>=0;s--){f=e[s];var p=f.targets!==n?f.targets:f.aTargets;for(i.isArray(p)||(p=[p]),c=0,l=p.length;c<l;c++)if("number"==typeof p[c]&&p[c]>=0){for(;g.length<=p[c];)d(t);r(p[c],f)}else if("number"==typeof p[c]&&p[c]<0)r(g.length+p[c],f);else if("string"==typeof p[c])for(h=0,u=g.length;h<u;h++)("_all"==p[c]||i(g[h].nTh).hasClass(p[c]))&&r(h,f)}if(a)for(s=0,o=a.length;s<o;s++)r(s,a[s])}function b(t,e,n,a){var r=t.aoData.length,s=i.extend(!0,{},Xt.models.oRow,{src:n?"dom":"data"});s._aData=e,t.aoData.push(s);for(var o=t.aoColumns,c=0,l=o.length;c<l;c++)n&&T(t,r,c,C(t,r,c)),o[c].sType=null;return t.aiDisplayMaster.push(r),!n&&t.oFeatures.bDeferRender||L(t,r,n,a),r}function S(t,e){var n;return e instanceof i||(e=i(e)),e.map(function(e,i){return n=I(t,i),b(t,n.data,i,n.cells)})}function x(t,e){return e._DT_RowIndex!==n?e._DT_RowIndex:null}function w(t,e,n){return i.inArray(n,t.aoData[e].anCells)}function C(t,e,i,a){var r=t.iDraw,s=t.aoColumns[i],o=t.aoData[e]._aData,c=s.sDefaultContent,l=s.fnGetData(o,a,{settings:t,row:e,col:i});if(l===n)return t.iDrawError!=r&&null===c&&(Nt(t,0,"Requested unknown parameter "+("function"==typeof s.mData?"{function}":"'"+s.mData+"'")+" for row "+e,4),t.iDrawError=r),c;if(l!==o&&null!==l||null===c){if("function"==typeof l)return l.call(o)}else l=c;return null===l&&"display"==a?"":l}function T(t,e,n,i){var a=t.aoColumns[n],r=t.aoData[e]._aData;a.fnSetData(r,i,{settings:t,row:e,col:n})}function K(t){return i.map(t.match(/(\\.|[^\.])+/g),function(t){return t.replace(/\\./g,".")})}function D(t){if(i.isPlainObject(t)){var e={};return i.each(t,function(t,n){n&&(e[t]=D(n))}),function(t,i,a,r){var s=e[i]||e._;return s!==n?s(t,i,a,r):t}}if(null===t)return function(t){return t};if("function"==typeof t)return function(e,n,i,a){return t(e,n,i,a)};if("string"!=typeof t||t.indexOf(".")===-1&&t.indexOf("[")===-1&&t.indexOf("(")===-1)return function(e,n){return e[t]};var a=function(t,e,i){var r,s,o,c;if(""!==i)for(var l=K(i),h=0,d=l.length;h<d;h++){if(r=l[h].match(_e),s=l[h].match(ye),r){l[h]=l[h].replace(_e,""),""!==l[h]&&(t=t[l[h]]),o=[],l.splice(0,h+1),c=l.join(".");for(var u=0,f=t.length;u<f;u++)o.push(a(t[u],e,c));var g=r[0].substring(1,r[0].length-1);t=""===g?o:o.join(g);break}if(s)l[h]=l[h].replace(ye,""),t=t[l[h]]();else{if(null===t||t[l[h]]===n)return n;t=t[l[h]]}}return t};return function(e,n){return a(e,n,t)}}function k(t){if(i.isPlainObject(t))return k(t._);if(null===t)return function(){};if("function"==typeof t)return function(e,n,i){t(e,"set",n,i)};if("string"!=typeof t||t.indexOf(".")===-1&&t.indexOf("[")===-1&&t.indexOf("(")===-1)return function(e,n){e[t]=n};var e=function(t,i,a){for(var r,s,o,c,l,h=K(a),d=h[h.length-1],u=0,f=h.length-1;u<f;u++){if(s=h[u].match(_e),o=h[u].match(ye),s){h[u]=h[u].replace(_e,""),t[h[u]]=[],r=h.slice(),r.splice(0,u+1),l=r.join(".");for(var g=0,p=i.length;g<p;g++)c={},e(c,i[g],l),t[h[u]].push(c);return}o&&(h[u]=h[u].replace(ye,""),t=t[h[u]](i)),null!==t[h[u]]&&t[h[u]]!==n||(t[h[u]]={}),t=t[h[u]]}d.match(ye)?t=t[d.replace(ye,"")](i):t[d.replace(_e,"")]=i};return function(n,i){return e(n,i,t)}}function F(t){return ue(t.aoData,"_aData")}function P(t){t.aoData.length=0,t.aiDisplayMaster.length=0,t.aiDisplay.length=0}function M(t,e,i){for(var a=-1,r=0,s=t.length;r<s;r++)t[r]==e?a=r:t[r]>e&&t[r]--;a!=-1&&i===n&&t.splice(a,1)}function A(t,e,i,a){var r,s,o=t.aoData[e];if("dom"!==i&&(i&&"auto"!==i||"dom"!==o.src)){var c,l=o.anCells;if(l)for(r=0,s=l.length;r<s;r++){for(c=l[r];c.childNodes.length;)c.removeChild(c.firstChild);l[r].innerHTML=C(t,e,r,"display")}}else o._aData=I(t,o).data;o._aSortData=null,o._aFilterData=null;var h=t.aoColumns;if(a!==n)h[a].sType=null;else for(r=0,s=h.length;r<s;r++)h[r].sType=null;R(o)}function I(t,e){var n,a,r,s,o=[],c=[],l=e.firstChild,h=0,d=t.aoColumns,u=function(t,e,n){if("string"==typeof t){var i=t.indexOf("@");if(i!==-1){var a=t.substring(i+1);r["@"+a]=n.getAttribute(a)}}},f=function(t){a=d[h],s=i.trim(t.innerHTML),a&&a._bAttrSrc?(r={display:s},u(a.mData.sort,r,t),u(a.mData.type,r,t),u(a.mData.filter,r,t),o.push(r)):o.push(s),h++};if(l)for(;l;)n=l.nodeName.toUpperCase(),"TD"!=n&&"TH"!=n||(f(l),c.push(l)),l=l.nextSibling;else{c=e.anCells;for(var g=0,p=c.length;g<p;g++)f(c[g])}return{data:o,cells:c}}function L(t,n,i,a){var r,s,o,c,l,h=t.aoData[n],d=h._aData,u=[];if(null===h.nTr){for(r=i||e.createElement("tr"),h.nTr=r,h.anCells=u,r._DT_RowIndex=n,R(h),c=0,l=t.aoColumns.length;c<l;c++)o=t.aoColumns[c],s=i?a[c]:e.createElement(o.sCellType),u.push(s),i&&!o.mRender&&o.mData===c||(s.innerHTML=C(t,n,c,"display")),o.sClass&&(s.className+=" "+o.sClass),o.bVisible&&!i?r.appendChild(s):!o.bVisible&&i&&s.parentNode.removeChild(s),o.fnCreatedCell&&o.fnCreatedCell.call(t.oInstance,s,C(t,n,c),d,n,c);Ut(t,"aoRowCreatedCallback",null,[r,d,n])}h.nTr.setAttribute("role","row")}function R(t){var e=t.nTr,n=t._aData;if(e){if(n.DT_RowId&&(e.id=n.DT_RowId),n.DT_RowClass){var a=n.DT_RowClass.split(" ");t.__rowc=t.__rowc?me(t.__rowc.concat(a)):a,i(e).removeClass(t.__rowc.join(" ")).addClass(n.DT_RowClass)}n.DT_RowData&&i(e).data(n.DT_RowData)}}function N(t){var e,n,a,r,s,o=t.nTHead,c=t.nTFoot,l=0===i("th, td",o).length,h=t.oClasses,d=t.aoColumns;for(l&&(r=i("<tr/>").appendTo(o)),e=0,n=d.length;e<n;e++)s=d[e],a=i(s.nTh).addClass(s.sClass),l&&a.appendTo(r),t.oFeatures.bSort&&(a.addClass(s.sSortingClass),s.bSortable!==!1&&(a.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),Pt(t,s.nTh,e))),s.sTitle!=a.html()&&a.html(s.sTitle),Et(t,"header")(t,a,s,h);if(l&&U(t.aoHeader,o),i(o).find(">tr").attr("role","row"),i(o).find(">tr>th, >tr>td").addClass(h.sHeaderTH),i(c).find(">tr>th, >tr>td").addClass(h.sFooterTH),null!==c){var u=t.aoFooter[0];for(e=0,n=u.length;e<n;e++)s=d[e],s.nTf=u[e].cell,s.sClass&&i(s.nTf).addClass(s.sClass)}}function G(t,e,a){var r,s,o,c,l,h,d,u,f,g=[],p=[],m=t.aoColumns.length;if(e){for(a===n&&(a=!1),r=0,s=e.length;r<s;r++){for(g[r]=e[r].slice(),g[r].nTr=e[r].nTr,o=m-1;o>=0;o--)t.aoColumns[o].bVisible||a||g[r].splice(o,1);p.push([])}for(r=0,s=g.length;r<s;r++){if(d=g[r].nTr)for(;h=d.firstChild;)d.removeChild(h);for(o=0,c=g[r].length;o<c;o++)if(u=1,f=1,p[r][o]===n){for(d.appendChild(g[r][o].cell),p[r][o]=1;g[r+u]!==n&&g[r][o].cell==g[r+u][o].cell;)p[r+u][o]=1,u++;for(;g[r][o+f]!==n&&g[r][o].cell==g[r][o+f].cell;){for(l=0;l<u;l++)p[r+l][o+f]=1;f++}i(g[r][o].cell).attr("rowspan",u).attr("colspan",f)}}}}function j(t){var e=Ut(t,"aoPreDrawCallback","preDraw",[t]);if(i.inArray(!1,e)!==-1)return void gt(t,!1);var a=[],r=0,s=t.asStripeClasses,o=s.length,c=(t.aoOpenRows.length,t.oLanguage),l=t.iInitDisplayStart,h="ssp"==Yt(t),d=t.aiDisplay;t.bDrawing=!0,l!==n&&l!==-1&&(t._iDisplayStart=h?l:l>=t.fnRecordsDisplay()?0:l,t.iInitDisplayStart=-1);var u=t._iDisplayStart,f=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,gt(t,!1);else if(h){if(!t.bDestroying&&!Y(t))return}else t.iDraw++;if(0!==d.length)for(var g=h?0:u,p=h?t.aoData.length:f,v=g;v<p;v++){var _=d[v],y=t.aoData[_];null===y.nTr&&L(t,_);var b=y.nTr;if(0!==o){var S=s[r%o];y._sRowStripe!=S&&(i(b).removeClass(y._sRowStripe).addClass(S),y._sRowStripe=S)}Ut(t,"aoRowCallback",null,[b,y._aData,r,v]),a.push(b),r++}else{var x=c.sZeroRecords;1==t.iDraw&&"ajax"==Yt(t)?x=c.sLoadingRecords:c.sEmptyTable&&0===t.fnRecordsTotal()&&(x=c.sEmptyTable),a[0]=i("<tr/>",{"class":o?s[0]:""}).append(i("<td />",{valign:"top",colSpan:m(t),"class":t.oClasses.sRowEmpty}).html(x))[0]}Ut(t,"aoHeaderCallback","header",[i(t.nTHead).children("tr")[0],F(t),u,f,d]),Ut(t,"aoFooterCallback","footer",[i(t.nTFoot).children("tr")[0],F(t),u,f,d]);var w=i(t.nTBody);w.children().detach(),w.append(i(a)),Ut(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}function $(t,e){var n=t.oFeatures,i=n.bSort,a=n.bFilter;i&&Dt(t),a?q(t,t.oPreviousSearch):t.aiDisplay=t.aiDisplayMaster.slice(),e!==!0&&(t._iDisplayStart=0),t._drawHold=e,j(t),t._drawHold=!1}function O(t){var e=t.oClasses,n=i(t.nTable),a=i("<div/>").insertBefore(n),r=t.oFeatures,s=i("<div/>",{id:t.sTableId+"_wrapper","class":e.sWrapper+(t.nTFoot?"":" "+e.sNoFooter)});t.nHolding=a[0],t.nTableWrapper=s[0],t.nTableReinsertBefore=t.nTable.nextSibling;for(var o,c,l,h,d,u,f=t.sDom.split(""),g=0;g<f.length;g++){if(o=null,c=f[g],"<"==c){if(l=i("<div/>")[0],h=f[g+1],"'"==h||'"'==h){for(d="",u=2;f[g+u]!=h;)d+=f[g+u],u++;if("H"==d?d=e.sJUIHeader:"F"==d&&(d=e.sJUIFooter),d.indexOf(".")!=-1){var p=d.split(".");l.id=p[0].substr(1,p[0].length-1),l.className=p[1]}else"#"==d.charAt(0)?l.id=d.substr(1,d.length-1):l.className=d;g+=u}s.append(l),s=i(l)}else if(">"==c)s=s.parent();else if("l"==c&&r.bPaginate&&r.bLengthChange)o=ht(t);else if("f"==c&&r.bFilter)o=X(t);else if("r"==c&&r.bProcessing)o=ft(t);else if("t"==c)o=pt(t);else if("i"==c&&r.bInfo)o=at(t);else if("p"==c&&r.bPaginate)o=dt(t);else if(0!==Xt.ext.feature.length)for(var m=Xt.ext.feature,v=0,_=m.length;v<_;v++)if(c==m[v].cFeature){o=m[v].fnInit(t);break}if(o){var y=t.aanFeatures;y[c]||(y[c]=[]),y[c].push(o),s.append(o)}}a.replaceWith(s)}function U(t,e){var n,a,r,s,o,c,l,h,d,u,f,g=i(e).children("tr"),p=function(t,e,n){for(var i=t[e];i[n];)n++;return n};for(t.splice(0,t.length),r=0,c=g.length;r<c;r++)t.push([]);for(r=0,c=g.length;r<c;r++)for(n=g[r],h=0,a=n.firstChild;a;){if("TD"==a.nodeName.toUpperCase()||"TH"==a.nodeName.toUpperCase())for(d=1*a.getAttribute("colspan"),u=1*a.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,u=u&&0!==u&&1!==u?u:1,l=p(t,r,h),f=1===d,o=0;o<d;o++)for(s=0;s<u;s++)t[r+s][l+o]={cell:a,unique:f},t[r+s].nTr=n;a=a.nextSibling}}function H(t,e,n){var i=[];n||(n=t.aoHeader,e&&(n=[],U(n,e)));for(var a=0,r=n.length;a<r;a++)for(var s=0,o=n[a].length;s<o;s++)!n[a][s].unique||i[s]&&t.bSortCellsTop||(i[s]=n[a][s].cell);return i}function E(t,e,n){if(Ut(t,"aoServerParams","serverParams",[e]),e&&i.isArray(e)){var a={},r=/(.*?)\[\]$/;i.each(e,function(t,e){var n=e.name.match(r);if(n){var i=n[0];a[i]||(a[i]=[]),a[i].push(e.value)}else a[e.name]=e.value}),e=a}var s,o=t.ajax,c=t.oInstance;if(i.isPlainObject(o)&&o.data){s=o.data;var l=i.isFunction(s)?s(e):s;e=i.isFunction(s)&&l?l:i.extend(!0,e,l),delete o.data}var h={data:e,success:function(e){var i=e.error||e.sError;i&&t.oApi._fnLog(t,0,i),t.json=e,Ut(t,null,"xhr",[t,e]),n(e)},dataType:"json",cache:!1,type:t.sServerMethod,error:function(e,n,i){var a=t.oApi._fnLog;"parsererror"==n?a(t,0,"Invalid JSON response",1):4===e.readyState&&a(t,0,"Ajax error",7),gt(t,!1)}};t.oAjaxData=e,Ut(t,null,"preXhr",[t,e]),t.fnServerData?t.fnServerData.call(c,t.sAjaxSource,i.map(e,function(t,e){return{name:e,value:t}}),n,t):t.sAjaxSource||"string"==typeof o?t.jqXHR=i.ajax(i.extend(h,{url:o||t.sAjaxSource})):i.isFunction(o)?t.jqXHR=o.call(c,e,n,t):(t.jqXHR=i.ajax(i.extend(h,o)),o.data=s)}function Y(t){return!t.bAjaxDataGet||(t.iDraw++,gt(t,!0),E(t,W(t),function(e){B(t,e)}),!1)}function W(t){var e,n,a,r,s=t.aoColumns,o=s.length,c=t.oFeatures,l=t.oPreviousSearch,h=t.aoPreSearchCols,d=[],u=Kt(t),f=t._iDisplayStart,g=c.bPaginate!==!1?t._iDisplayLength:-1,p=function(t,e){d.push({name:t,value:e})};p("sEcho",t.iDraw),p("iColumns",o),p("sColumns",ue(s,"sName").join(",")),p("iDisplayStart",f),p("iDisplayLength",g);var m={draw:t.iDraw,columns:[],order:[],start:f,length:g,search:{value:l.sSearch,regex:l.bRegex}};for(e=0;e<o;e++)a=s[e],r=h[e],n="function"==typeof a.mData?"function":a.mData,m.columns.push({data:n,name:a.sName,searchable:a.bSearchable,orderable:a.bSortable,search:{value:r.sSearch,regex:r.bRegex}}),p("mDataProp_"+e,n),c.bFilter&&(p("sSearch_"+e,r.sSearch),p("bRegex_"+e,r.bRegex),p("bSearchable_"+e,a.bSearchable)),c.bSort&&p("bSortable_"+e,a.bSortable);c.bFilter&&(p("sSearch",l.sSearch),p("bRegex",l.bRegex)),c.bSort&&(i.each(u,function(t,e){m.order.push({column:e.col,dir:e.dir}),p("iSortCol_"+t,e.col),p("sSortDir_"+t,e.dir)}),p("iSortingCols",u.length));var v=Xt.ext.legacy.ajax;return null===v?t.sAjaxSource?d:m:v?d:m}function B(t,e){var i=function(t,i){return e[t]!==n?e[t]:e[i]},a=i("sEcho","draw"),r=i("iTotalRecords","recordsTotal"),s=i("iTotalDisplayRecords","recordsFiltered");if(a){if(1*a<t.iDraw)return;t.iDraw=1*a}P(t),t._iRecordsTotal=parseInt(r,10),t._iRecordsDisplay=parseInt(s,10);for(var o=z(t,e),c=0,l=o.length;c<l;c++)b(t,o[c]);t.aiDisplay=t.aiDisplayMaster.slice(),t.bAjaxDataGet=!1,j(t),t._bInitComplete||ct(t,e),t.bAjaxDataGet=!0,gt(t,!1)}function z(t,e){var a=i.isPlainObject(t.ajax)&&t.ajax.dataSrc!==n?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===a?e.aaData||e[a]:""!==a?D(a)(e):e}function X(t){var n=t.oClasses,a=t.sTableId,r=t.oLanguage,s=t.oPreviousSearch,o=t.aanFeatures,c='<input type="search" class="'+n.sFilterInput+'" placeholder="Search record"/> <div class="go"></div>',l=r.sSearch;l=l.match(/_INPUT_/)?l.replace("_INPUT_",c):l+c;var h=i("<div/>",{id:o.f?null:a+"_filter","class":n.sFilter}).append(i("<label/>").append(l)),d=function(){var e=(o.f,this.value?this.value:"");e!=s.sSearch&&(q(t,{sSearch:e,bRegex:s.bRegex,bSmart:s.bSmart,bCaseInsensitive:s.bCaseInsensitive}),t._iDisplayStart=0,j(t))},u=i("input",h).val(s.sSearch).attr("placeholder",r.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT","ssp"===Yt(t)?yt(d,400):d).bind("keypress.DT",function(t){if(13==t.keyCode)return!1}).attr("aria-controls",a);return i(t.nTable).on("search.dt.DT",function(n,i){if(t===i)try{u[0]!==e.activeElement&&u.val(s.sSearch)}catch(a){}}),h[0]}function q(t,e,i){var a=t.oPreviousSearch,r=t.aoPreSearchCols,s=function(t){a.sSearch=t.sSearch,a.bRegex=t.bRegex,a.bSmart=t.bSmart,a.bCaseInsensitive=t.bCaseInsensitive},o=function(t){return t.bEscapeRegex!==n?!t.bEscapeRegex:t.bRegex};if(_(t),"ssp"!=Yt(t)){Q(t,e.sSearch,i,o(e),e.bSmart,e.bCaseInsensitive),s(e);for(var c=0;c<r.length;c++)V(t,r[c].sSearch,c,o(r[c]),r[c].bSmart,r[c].bCaseInsensitive);J(t)}else s(e);t.bFiltered=!0,Ut(t,null,"search",[t])}function J(t){for(var e,n,i=Xt.ext.search,a=t.aiDisplay,r=0,s=i.length;r<s;r++){for(var o=[],c=0,l=a.length;c<l;c++)n=a[c],e=t.aoData[n],i[r](t,e._aFilterData,n,e._aData,c)&&o.push(n);a.length=0,a.push.apply(a,o)}}function V(t,e,n,i,a,r){if(""!==e)for(var s,o=t.aiDisplay,c=Z(e,i,a,r),l=o.length-1;l>=0;l--)s=t.aoData[o[l]]._aFilterData[n],c.test(s)||o.splice(l,1)}function Q(t,e,n,i,a,r){var s,o,c,l=Z(e,i,a,r),h=t.oPreviousSearch.sSearch,d=t.aiDisplayMaster;if(0!==Xt.ext.search.length&&(n=!0),o=et(t),e.length<=0)t.aiDisplay=d.slice();else for((o||n||h.length>e.length||0!==e.indexOf(h)||t.bSorted)&&(t.aiDisplay=d.slice()),s=t.aiDisplay,c=s.length-1;c>=0;c--)l.test(t.aoData[s[c]]._sFilterRow)||s.splice(c,1)}function Z(t,e,n,a){if(t=e?t:tt(t),n){var r=i.map(t.match(/"[^"]+"|[^ ]+/g)||"",function(t){return'"'===t.charAt(0)?t.match(/^"(.*)"$/)[1]:t});t="^(?=.*?"+r.join(")(?=.*?")+").*$"}return new RegExp(t,a?"i":"")}function tt(t){return t.replace(ae,"\\$1")}function et(t){var e,n,i,a,r,s,o,c,l=t.aoColumns,h=Xt.ext.type.search,d=!1;for(n=0,a=t.aoData.length;n<a;n++)if(c=t.aoData[n],!c._aFilterData){for(s=[],i=0,r=l.length;i<r;i++)e=l[i],e.bSearchable?(o=C(t,n,i,"filter"),o=h[e.sType]?h[e.sType](o):null!==o?o:""):o="",o&&(o.indexOf&&o.indexOf("&")!==-1&&(be.innerHTML=o,o=Se?be.textContent:be.innerText),o.replace&&(o=o.replace(/[\r\n]/g,"")),s.push(o));c._aFilterData=s,c._sFilterRow=s.join("  "),d=!0}return d}function nt(t){return{search:t.sSearch,smart:t.bSmart,regex:t.bRegex,caseInsensitive:t.bCaseInsensitive}}function it(t){return{sSearch:t.search,bSmart:t.smart,bRegex:t.regex,bCaseInsensitive:t.caseInsensitive}}function at(t){var e=t.sTableId,n=t.aanFeatures.i,a=i("<div/>",{"class":t.oClasses.sInfo,id:n?null:e+"_info"});return n||(t.aoDrawCallback.push({fn:rt,sName:"information"}),a.attr("role","status").attr("aria-live","polite"),
i(t.nTable).attr("aria-describedby",e+"_info")),a[0]}function rt(t){var e=t.aanFeatures.i;if(0!==e.length){var n=t.oLanguage,a=t._iDisplayStart+1,r=t.fnDisplayEnd(),s=t.fnRecordsTotal(),o=t.fnRecordsDisplay(),c=o?n.sInfo:n.sInfoEmpty;o!==s&&(c+=" "+n.sInfoFiltered),c+=n.sInfoPostFix,c=st(t,c);var l=n.fnInfoCallback;null!==l&&(c=l.call(t.oInstance,t,a,r,s,o,c)),i(e).html(c)}}function st(t,e){var n=t.fnFormatNumber,i=t._iDisplayStart+1,a=t._iDisplayLength,r=t.fnRecordsDisplay(),s=a===-1;return e.replace(/_START_/g,n.call(t,i)).replace(/_END_/g,n.call(t,t.fnDisplayEnd())).replace(/_MAX_/g,n.call(t,t.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(t,r)).replace(/_PAGE_/g,n.call(t,s?1:Math.ceil(i/a))).replace(/_PAGES_/g,n.call(t,s?1:Math.ceil(r/a)))}function ot(t){var e,n,i,a=t.iInitDisplayStart,r=t.aoColumns,s=t.oFeatures;if(!t.bInitialised)return void setTimeout(function(){ot(t)},200);for(O(t),N(t),G(t,t.aoHeader),G(t,t.aoFooter),gt(t,!0),s.bAutoWidth&&_t(t),e=0,n=r.length;e<n;e++)i=r[e],i.sWidth&&(i.nTh.style.width=Ct(i.sWidth));$(t);var o=Yt(t);"ssp"!=o&&("ajax"==o?E(t,[],function(n){var i=z(t,n);for(e=0;e<i.length;e++)b(t,i[e]);t.iInitDisplayStart=a,$(t),gt(t,!1),ct(t,n)},t):(gt(t,!1),ct(t)))}function ct(t,e){t._bInitComplete=!0,e&&f(t),Ut(t,"aoInitComplete","init",[t,e])}function lt(t,e){var n=parseInt(e,10);t._iDisplayLength=n,Ht(t),Ut(t,null,"length",[t,n])}function ht(t){for(var e=t.oClasses,n=t.sTableId,a=t.aLengthMenu,r=i.isArray(a[0]),s=r?a[0]:a,o=r?a[1]:a,c=i("<select/>",{name:n+"_length","aria-controls":n,"class":e.sLengthSelect}),l=0,h=s.length;l<h;l++)c[0][l]=new Option(o[l],s[l]);var d=i("<div><label/></div>").addClass(e.sLength);return t.aanFeatures.l||(d[0].id=n+"_length"),d.children().append(t.oLanguage.sLengthMenu.replace("_MENU_",c[0].outerHTML)),i("select",d).val(t._iDisplayLength).bind("change.DT",function(e){lt(t,i(this).val()),j(t)}),i(t.nTable).bind("length.dt.DT",function(e,n,a){t===n&&i("select",d).val(a)}),d[0]}function dt(t){var e=t.sPaginationType,n=Xt.ext.pager[e],a="function"==typeof n,r=function(t){j(t)},s=i("<div/>").addClass(t.oClasses.sPaging+e)[0],o=t.aanFeatures;return a||n.fnInit(t,s,r),o.p||(s.id=t.sTableId+"_paginate",t.aoDrawCallback.push({fn:function(t){if(a){var e,i,s=t._iDisplayStart,c=t._iDisplayLength,l=t.fnRecordsDisplay(),h=c===-1,d=h?0:Math.ceil(s/c),u=h?1:Math.ceil(l/c),f=n(d,u);for(e=0,i=o.p.length;e<i;e++)Et(t,"pageButton")(t,o.p[e],e,f,d,u)}else n.fnUpdate(t,r)},sName:"pagination"})),s}function ut(t,e,n){var i=t._iDisplayStart,a=t._iDisplayLength,r=t.fnRecordsDisplay();0===r||a===-1?i=0:"number"==typeof e?(i=e*a,i>r&&(i=0)):"first"==e?i=0:"previous"==e?(i=a>=0?i-a:0,i<0&&(i=0)):"next"==e?i+a<r&&(i+=a):"last"==e?i=Math.floor((r-1)/a)*a:Nt(t,0,"Unknown paging action: "+e,5);var s=t._iDisplayStart!==i;return t._iDisplayStart=i,s&&(Ut(t,null,"page",[t]),n&&j(t)),s}function ft(t){return i("<div/>",{id:t.aanFeatures.r?null:t.sTableId+"_processing","class":t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function gt(t,e){t.oFeatures.bProcessing&&i(t.aanFeatures.r).css("display",e?"block":"none"),Ut(t,null,"processing",[t,e])}function pt(t){var e=i(t.nTable);e.attr("role","grid");var n=t.oScroll;if(""===n.sX&&""===n.sY)return t.nTable;var a=n.sX,r=n.sY,s=t.oClasses,o=e.children("caption"),c=o.length?o[0]._captionSide:null,l=i(e[0].cloneNode(!1)),h=i(e[0].cloneNode(!1)),d=e.children("tfoot"),u="<div/>",f=function(t){return t?Ct(t):null};n.sX&&"100%"===e.attr("width")&&e.removeAttr("width"),d.length||(d=null);var g=i(u,{"class":s.sScrollWrapper}).append(i(u,{"class":s.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:a?f(a):"100%"}).append(i(u,{"class":s.sScrollHeadInner}).css({"box-sizing":"content-box",width:n.sXInner||"100%"}).append(l.removeAttr("id").css("margin-left",0).append(e.children("thead")))).append("top"===c?o:null)).append(i(u,{"class":s.sScrollBody}).css({overflow:"auto",height:f(r),width:f(a)}).append(e));d&&g.append(i(u,{"class":s.sScrollFoot}).css({overflow:"hidden",border:0,width:a?f(a):"100%"}).append(i(u,{"class":s.sScrollFootInner}).append(h.removeAttr("id").css("margin-left",0).append(e.children("tfoot")))).append("bottom"===c?o:null));var p=g.children(),m=p[0],v=p[1],_=d?p[2]:null;return a&&i(v).scroll(function(t){var e=this.scrollLeft;m.scrollLeft=e,d&&(_.scrollLeft=e)}),t.nScrollHead=m,t.nScrollBody=v,t.nScrollFoot=_,t.aoDrawCallback.push({fn:mt,sName:"scrolling"}),g[0]}function mt(t){var e,n,a,r,s,o,c,l,h,d=t.oScroll,u=d.sX,f=d.sXInner,p=d.sY,m=d.iBarWidth,v=i(t.nScrollHead),_=v[0].style,y=v.children("div"),b=y[0].style,S=y.children("table"),x=t.nScrollBody,w=i(x),C=x.style,T=i(t.nScrollFoot),K=T.children("div"),D=K.children("table"),k=i(t.nTHead),F=i(t.nTable),P=F[0],M=P.style,A=t.nTFoot?i(t.nTFoot):null,I=t.oBrowser,L=I.bScrollOversize,R=[],N=[],G=[],j=function(t){var e=t.style;e.paddingTop="0",e.paddingBottom="0",e.borderTopWidth="0",e.borderBottomWidth="0",e.height=0};if(F.children("thead, tfoot").remove(),s=k.clone().prependTo(F),e=k.find("tr"),a=s.find("tr"),s.find("th, td").removeAttr("tabindex"),A&&(o=A.clone().prependTo(F),n=A.find("tr"),r=o.find("tr")),u||(C.width="100%",v[0].style.width="100%"),i.each(H(t,s),function(e,n){c=g(t,e),n.style.width=t.aoColumns[c].sWidth}),A&&vt(function(t){t.style.width=""},r),d.bCollapse&&""!==p&&(C.height=w[0].offsetHeight+k[0].offsetHeight+"px"),h=F.outerWidth(),""===u?(M.width="100%",L&&(F.find("tbody").height()>x.offsetHeight||"scroll"==w.css("overflow-y"))&&(M.width=Ct(F.outerWidth()-m))):""!==f?M.width=Ct(f):h==w.width()&&w.height()<F.height()?(M.width=Ct(h-m),F.outerWidth()>h-m&&(M.width=Ct(h))):M.width=Ct(h),h=F.outerWidth(),vt(j,a),vt(function(t){G.push(t.innerHTML),R.push(Ct(i(t).css("width")))},a),vt(function(t,e){t.style.width=R[e]},e),i(a).height(0),A&&(vt(j,r),vt(function(t){N.push(Ct(i(t).css("width")))},r),vt(function(t,e){t.style.width=N[e]},n),i(r).height(0)),vt(function(t,e){t.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+G[e]+"</div>",t.style.width=R[e]},a),A&&vt(function(t,e){t.innerHTML="",t.style.width=N[e]},r),F.outerWidth()<h?(l=x.scrollHeight>x.offsetHeight||"scroll"==w.css("overflow-y")?h+m:h,L&&(x.scrollHeight>x.offsetHeight||"scroll"==w.css("overflow-y"))&&(M.width=Ct(l-m)),""!==u&&""===f||Nt(t,1,"Possible column misalignment",6)):l="100%",C.width=Ct(l),_.width=Ct(l),A&&(t.nScrollFoot.style.width=Ct(l)),p||L&&(C.height=Ct(P.offsetHeight+m)),p&&d.bCollapse){C.height=Ct(p);var $=u&&P.offsetWidth>x.offsetWidth?m:0;P.offsetHeight<x.offsetHeight&&(C.height=Ct(P.offsetHeight+$))}var O=F.outerWidth();S[0].style.width=Ct(O),b.width=Ct(O);var U=F.height()>x.clientHeight||"scroll"==w.css("overflow-y"),E="padding"+(I.bScrollbarLeft?"Left":"Right");b[E]=U?m+"px":"0px",A&&(D[0].style.width=Ct(O),K[0].style.width=Ct(O),K[0].style[E]=U?m+"px":"0px"),w.scroll(),!t.bSorted&&!t.bFiltered||t._drawHold||(x.scrollTop=0)}function vt(t,e,n){for(var i,a,r=0,s=0,o=e.length;s<o;){for(i=e[s].firstChild,a=n?n[s].firstChild:null;i;)1===i.nodeType&&(n?t(i,a,r):t(i,r),r++),i=i.nextSibling,a=n?a.nextSibling:null;s++}}function _t(e){var n,a,r,s,o,c=e.nTable,l=e.aoColumns,h=e.oScroll,d=h.sY,u=h.sX,g=h.sXInner,p=l.length,_=v(e,"bVisible"),y=i("th",e.nTHead),b=c.getAttribute("width"),S=c.parentNode,x=!1;for(n=0;n<_.length;n++)a=l[_[n]],null!==a.sWidth&&(a.sWidth=bt(a.sWidthOrig,S),x=!0);if(x||u||d||p!=m(e)||p!=y.length){var w=i(c).clone().empty().css("visibility","hidden").removeAttr("id").append(i(e.nTHead).clone(!1)).append(i(e.nTFoot).clone(!1)).append(i("<tbody><tr/></tbody>"));w.find("tfoot th, tfoot td").css("width","");var C=w.find("tbody tr");for(y=H(e,w.find("thead")[0]),n=0;n<_.length;n++)a=l[_[n]],y[n].style.width=null!==a.sWidthOrig&&""!==a.sWidthOrig?Ct(a.sWidthOrig):"";if(e.aoData.length)for(n=0;n<_.length;n++)r=_[n],a=l[r],i(xt(e,r)).clone(!1).append(a.sContentPadding).appendTo(C);if(w.appendTo(S),u&&g?w.width(g):u?(w.css("width","auto"),w.width()<S.offsetWidth&&w.width(S.offsetWidth)):d?w.width(S.offsetWidth):b&&w.width(b),St(e,w[0]),u){var T=0;for(n=0;n<_.length;n++)a=l[_[n]],o=i(y[n]).outerWidth(),T+=null===a.sWidthOrig?o:parseInt(a.sWidth,10)+o-i(y[n]).width();w.width(Ct(T)),c.style.width=Ct(T)}for(n=0;n<_.length;n++)a=l[_[n]],s=i(y[n]).width(),s&&(a.sWidth=Ct(s));c.style.width=Ct(w.css("width")),w.remove()}else for(n=0;n<p;n++)l[n].sWidth=Ct(y.eq(n).width());b&&(c.style.width=Ct(b)),!b&&!u||e._reszEvt||(i(t).bind("resize.DT-"+e.sInstance,yt(function(){f(e)})),e._reszEvt=!0)}function yt(t,e){var i,a,r=e||200;return function(){var e=this,s=+new Date,o=arguments;i&&s<i+r?(clearTimeout(a),a=setTimeout(function(){i=n,t.apply(e,o)},r)):i?(i=s,t.apply(e,o)):i=s}}function bt(t,n){if(!t)return 0;var a=i("<div/>").css("width",Ct(t)).appendTo(n||e.body),r=a[0].offsetWidth;return a.remove(),r}function St(t,e){var n=t.oScroll;if(n.sX||n.sY){var a=n.sX?0:n.iBarWidth;e.style.width=Ct(i(e).outerWidth()-a)}}function xt(t,e){var n=wt(t,e);if(n<0)return null;var a=t.aoData[n];return a.nTr?a.anCells[e]:i("<td/>").html(C(t,n,e,"display"))[0]}function wt(t,e){for(var n,i=-1,a=-1,r=0,s=t.aoData.length;r<s;r++)n=C(t,r,e,"display")+"",n=n.replace(xe,""),n.length>i&&(i=n.length,a=r);return a}function Ct(t){return null===t?"0px":"number"==typeof t?t<0?"0px":t+"px":t.match(/\d$/)?t+"px":t}function Tt(){if(!Xt.__scrollbarWidth){var t=i("<p/>").css({width:"100%",height:200,padding:0})[0],e=i("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(t).appendTo("body"),n=t.offsetWidth;e.css("overflow","scroll");var a=t.offsetWidth;n===a&&(a=e[0].clientWidth),e.remove(),Xt.__scrollbarWidth=n-a}return Xt.__scrollbarWidth}function Kt(t){var e,n,a,r,s,o,c,l=[],h=t.aoColumns,d=t.aaSortingFixed,u=i.isPlainObject(d),f=[],g=function(t){t.length&&!i.isArray(t[0])?f.push(t):f.push.apply(f,t)};for(i.isArray(d)&&g(d),u&&d.pre&&g(d.pre),g(t.aaSorting),u&&d.post&&g(d.post),e=0;e<f.length;e++)for(c=f[e][0],r=h[c].aDataSort,n=0,a=r.length;n<a;n++)s=r[n],o=h[s].sType||"string",l.push({src:c,col:s,dir:f[e][1],index:f[e][2],type:o,formatter:Xt.ext.type.order[o+"-pre"]});return l}function Dt(t){var e,n,i,a,r,s=[],o=Xt.ext.type.order,c=t.aoData,l=(t.aoColumns,0),h=t.aiDisplayMaster;for(_(t),r=Kt(t),e=0,n=r.length;e<n;e++)a=r[e],a.formatter&&l++,At(t,a.col);if("ssp"!=Yt(t)&&0!==r.length){for(e=0,i=h.length;e<i;e++)s[h[e]]=e;l===r.length?h.sort(function(t,e){var n,i,a,o,l,h=r.length,d=c[t]._aSortData,u=c[e]._aSortData;for(a=0;a<h;a++)if(l=r[a],n=d[l.col],i=u[l.col],o=n<i?-1:n>i?1:0,0!==o)return"asc"===l.dir?o:-o;return n=s[t],i=s[e],n<i?-1:n>i?1:0}):h.sort(function(t,e){var n,i,a,l,h,d,u=r.length,f=c[t]._aSortData,g=c[e]._aSortData;for(a=0;a<u;a++)if(h=r[a],n=f[h.col],i=g[h.col],d=o[h.type+"-"+h.dir]||o["string-"+h.dir],l=d(n,i),0!==l)return l;return n=s[t],i=s[e],n<i?-1:n>i?1:0})}t.bSorted=!0}function kt(t){for(var e,n,i=t.aoColumns,a=Kt(t),r=t.oLanguage.oAria,s=0,o=i.length;s<o;s++){var c=i[s],l=c.asSorting,h=c.sTitle.replace(/<.*?>/g,""),d=c.nTh;d.removeAttribute("aria-sort"),c.bSortable?(a.length>0&&a[0].col==s?(d.setAttribute("aria-sort","asc"==a[0].dir?"ascending":"descending"),n=l[a[0].index+1]||l[0]):n=l[0],e=h+("asc"===n?r.sSortAscending:r.sSortDescending)):e=h,d.setAttribute("aria-label",e)}}function Ft(t,e,a,r){var s,o=t.aoColumns[e],c=t.aaSorting,l=o.asSorting,h=function(t){var e=t._idx;return e===n&&(e=i.inArray(t[1],l)),e+1>=l.length?0:e+1};if("number"==typeof c[0]&&(c=t.aaSorting=[c]),a&&t.oFeatures.bSortMulti){var d=i.inArray(e,ue(c,"0"));d!==-1?(s=h(c[d]),c[d][1]=l[s],c[d]._idx=s):(c.push([e,l[0],0]),c[c.length-1]._idx=0)}else c.length&&c[0][0]==e?(s=h(c[0]),c.length=1,c[0][1]=l[s],c[0]._idx=s):(c.length=0,c.push([e,l[0]]),c[0]._idx=0);$(t),"function"==typeof r&&r(t)}function Pt(t,e,n,i){var a=t.aoColumns[n];$t(e,{},function(e){a.bSortable!==!1&&(t.oFeatures.bProcessing?(gt(t,!0),setTimeout(function(){Ft(t,n,e.shiftKey,i),"ssp"!==Yt(t)&&gt(t,!1)},0)):Ft(t,n,e.shiftKey,i))})}function Mt(t){var e,n,a,r=t.aLastSort,s=t.oClasses.sSortColumn,o=Kt(t),c=t.oFeatures;if(c.bSort&&c.bSortClasses){for(e=0,n=r.length;e<n;e++)a=r[e].src,i(ue(t.aoData,"anCells",a)).removeClass(s+(e<2?e+1:3));for(e=0,n=o.length;e<n;e++)a=o[e].src,i(ue(t.aoData,"anCells",a)).addClass(s+(e<2?e+1:3))}t.aLastSort=o}function At(t,e){var n,i=t.aoColumns[e],a=Xt.ext.order[i.sSortDataType];a&&(n=a.call(t.oInstance,t,e,p(t,e)));for(var r,s,o=Xt.ext.type.order[i.sType+"-pre"],c=0,l=t.aoData.length;c<l;c++)r=t.aoData[c],r._aSortData||(r._aSortData=[]),r._aSortData[e]&&!a||(s=a?n[c]:C(t,c,e,"sort"),r._aSortData[e]=o?o(s):s)}function It(t){if(t.oFeatures.bStateSave&&!t.bDestroying){var e={time:+new Date,start:t._iDisplayStart,length:t._iDisplayLength,order:i.extend(!0,[],t.aaSorting),search:nt(t.oPreviousSearch),columns:i.map(t.aoColumns,function(e,n){return{visible:e.bVisible,search:nt(t.aoPreSearchCols[n])}})};Ut(t,"aoStateSaveParams","stateSaveParams",[t,e]),t.oSavedState=e,t.fnStateSaveCallback.call(t.oInstance,t,e)}}function Lt(t,e){var n,a,r=t.aoColumns;if(t.oFeatures.bStateSave){var s=t.fnStateLoadCallback.call(t.oInstance,t);if(s&&s.time){var o=Ut(t,"aoStateLoadParams","stateLoadParams",[t,s]);if(i.inArray(!1,o)===-1){var c=t.iStateDuration;if(!(c>0&&s.time<+new Date-1e3*c)&&r.length===s.columns.length){for(t.oLoadedState=i.extend(!0,{},s),t._iDisplayStart=s.start,t.iInitDisplayStart=s.start,t._iDisplayLength=s.length,t.aaSorting=[],i.each(s.order,function(e,n){t.aaSorting.push(n[0]>=r.length?[0,n[1]]:n)}),i.extend(t.oPreviousSearch,it(s.search)),n=0,a=s.columns.length;n<a;n++){var l=s.columns[n];r[n].bVisible=l.visible,i.extend(t.aoPreSearchCols[n],it(l.search))}Ut(t,"aoStateLoaded","stateLoaded",[t,s])}}}}}function Rt(t){var e=Xt.settings,n=i.inArray(t,ue(e,"nTable"));return n!==-1?e[n]:null}function Nt(e,n,i,a){if(i="DataTables warning: "+(null!==e?"table id="+e.sTableId+" - ":"")+i,a&&(i+=". For more information about this error, please see http://datatables.net/tn/"+a),n)t.console&&console.log&&console.log(i);else{var r=Xt.ext,s=r.sErrMode||r.errMode;if("alert"!=s)throw new Error(i);alert(i)}}function Gt(t,e,a,r){return i.isArray(a)?void i.each(a,function(n,a){i.isArray(a)?Gt(t,e,a[0],a[1]):Gt(t,e,a)}):(r===n&&(r=a),void(e[a]!==n&&(t[r]=e[a])))}function jt(t,e,n){var a;for(var r in e)e.hasOwnProperty(r)&&(a=e[r],i.isPlainObject(a)?(i.isPlainObject(t[r])||(t[r]={}),i.extend(!0,t[r],a)):n&&"data"!==r&&"aaData"!==r&&i.isArray(a)?t[r]=a.slice():t[r]=a);return t}function $t(t,e,n){i(t).bind("click.DT",e,function(e){t.blur(),n(e)}).bind("keypress.DT",e,function(t){13===t.which&&(t.preventDefault(),n(t))}).bind("selectstart.DT",function(){return!1})}function Ot(t,e,n,i){n&&t[e].push({fn:n,sName:i})}function Ut(t,e,n,a){var r=[];return e&&(r=i.map(t[e].slice().reverse(),function(e,n){return e.fn.apply(t.oInstance,a)})),null!==n&&i(t.nTable).trigger(n+".dt",a),r}function Ht(t){var e=t._iDisplayStart,n=t.fnDisplayEnd(),i=t._iDisplayLength;n===t.fnRecordsDisplay()&&(e=n-i),(i===-1||e<0)&&(e=0),t._iDisplayStart=e}function Et(t,e){var n=t.renderer,a=Xt.ext.renderer[e];return i.isPlainObject(n)&&n[e]?a[n[e]]||a._:"string"==typeof n?a[n]||a._:a._}function Yt(t){return t.oFeatures.bServerSide?"ssp":t.ajax||t.sAjaxSource?"ajax":"dom"}function Wt(t,e){var n=[],i=Ye.numbers_length,a=Math.floor(i/2);return e<=i?n=ge(0,e):t<=a?(n=ge(0,i-2),n.push("ellipsis"),n.push(e-1)):t>=e-1-a?(n=ge(e-(i-2),e),n.splice(0,0,"ellipsis"),n.splice(0,0,0)):(n=ge(t-1,t+2),n.push("ellipsis"),n.push(e-1),n.splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}function Bt(t){i.each({num:function(e){return We(e,t)},"num-fmt":function(e){return We(e,t,re)},"html-num":function(e){return We(e,t,ee)},"html-num-fmt":function(e){return We(e,t,ee,re)}},function(e,n){qt.type.order[e+t+"-pre"]=n})}function zt(t){return function(){var e=[Rt(this[Xt.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return Xt.ext.internal[t].apply(this,e)}}var Xt,qt,Jt,Vt,Qt,Zt={},te=/[\r\n]/g,ee=/<.*?>/g,ne=/^[\w\+\-]/,ie=/[\w\+\-]$/,ae=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),re=/[',$%\u2009\u202F]/g,se=function(t){return!t||t===!0||"-"===t},oe=function(t){var e=parseInt(t,10);return!isNaN(e)&&isFinite(t)?e:null},ce=function(t,e){return Zt[e]||(Zt[e]=new RegExp(tt(e),"g")),"string"==typeof t?t.replace(/\./g,"").replace(Zt[e],"."):t},le=function(t,e,n){var i="string"==typeof t;return e&&i&&(t=ce(t,e)),n&&i&&(t=t.replace(re,"")),se(t)||!isNaN(parseFloat(t))&&isFinite(t)},he=function(t){return se(t)||"string"==typeof t},de=function(t,e,n){if(se(t))return!0;var i=he(t);return i?!!le(pe(t),e,n)||null:null},ue=function(t,e,i){var a=[],r=0,s=t.length;if(i!==n)for(;r<s;r++)t[r]&&t[r][e]&&a.push(t[r][e][i]);else for(;r<s;r++)t[r]&&a.push(t[r][e]);return a},fe=function(t,e,i,a){var r=[],s=0,o=e.length;if(a!==n)for(;s<o;s++)r.push(t[e[s]][i][a]);else for(;s<o;s++)r.push(t[e[s]][i]);return r},ge=function(t,e){var i,a=[];e===n?(e=0,i=t):(i=e,e=t);for(var r=e;r<i;r++)a.push(r);return a},pe=function(t){return t.replace(ee,"")},me=function(t){var e,n,i,a=[],r=t.length,s=0;t:for(n=0;n<r;n++){for(e=t[n],i=0;i<s;i++)if(a[i]===e)continue t;a.push(e),s++}return a},ve=function(t,e,i){t[e]!==n&&(t[i]=t[e])},_e=/\[.*?\]$/,ye=/\(\)$/,be=i("<div>")[0],Se=be.textContent!==n,xe=/<.*?>/g;Xt=function(t){this.$=function(t,e){return this.api(!0).$(t,e)},this._=function(t,e){return this.api(!0).rows(t,e).data()},this.api=function(t){return new Jt(t?Rt(this[qt.iApiIndex]):this)},this.fnAddData=function(t,e){var a=this.api(!0),r=i.isArray(t)&&(i.isArray(t[0])||i.isPlainObject(t[0]))?a.rows.add(t):a.row.add(t);return(e===n||e)&&a.draw(),r.flatten().toArray()},this.fnAdjustColumnSizing=function(t){var e=this.api(!0).columns.adjust(),i=e.settings()[0],a=i.oScroll;t===n||t?e.draw(!1):""===a.sX&&""===a.sY||mt(i)},this.fnClearTable=function(t){var e=this.api(!0).clear();(t===n||t)&&e.draw()},this.fnClose=function(t){this.api(!0).row(t).child.hide()},this.fnDeleteRow=function(t,e,i){var a=this.api(!0),r=a.rows(t),s=r.settings()[0],o=s.aoData[r[0][0]];return r.remove(),e&&e.call(this,s,o),(i===n||i)&&a.draw(),o},this.fnDestroy=function(t){this.api(!0).destroy(t)},this.fnDraw=function(t){this.api(!0).draw(!t)},this.fnFilter=function(t,e,i,a,r,s){var o=this.api(!0);null===e||e===n?o.search(t,i,a,s):o.column(e).search(t,i,a,s),o.draw()},this.fnGetData=function(t,e){var i=this.api(!0);if(t!==n){var a=t.nodeName?t.nodeName.toLowerCase():"";return e!==n||"td"==a||"th"==a?i.cell(t,e).data():i.row(t).data()||null}return i.data().toArray()},this.fnGetNodes=function(t){var e=this.api(!0);return t!==n?e.row(t).node():e.rows().nodes().flatten().toArray()},this.fnGetPosition=function(t){var e=this.api(!0),n=t.nodeName.toUpperCase();if("TR"==n)return e.row(t).index();if("TD"==n||"TH"==n){var i=e.cell(t).index();return[i.row,i.columnVisible,i.column]}return null},this.fnIsOpen=function(t){return this.api(!0).row(t).child.isShown()},this.fnOpen=function(t,e,n){return this.api(!0).row(t).child(e,n).show().child()[0]},this.fnPageChange=function(t,e){var i=this.api(!0).page(t);(e===n||e)&&i.draw(!1)},this.fnSetColumnVis=function(t,e,i){var a=this.api(!0).column(t).visible(e);(i===n||i)&&a.columns.adjust().draw()},this.fnSettings=function(){return Rt(this[qt.iApiIndex])},this.fnSort=function(t){this.api(!0).order(t).draw()},this.fnSortListener=function(t,e,n){this.api(!0).order.listener(t,e,n)},this.fnUpdate=function(t,e,i,a,r){var s=this.api(!0);return i===n||null===i?s.row(e).data(t):s.cell(e,i).data(t),(r===n||r)&&s.columns.adjust(),(a===n||a)&&s.draw(),0},this.fnVersionCheck=qt.fnVersionCheck;var e=this,a=t===n,h=this.length;a&&(t={}),this.oApi=this.internal=qt.internal;for(var f in Xt.ext.internal)f&&(this[f]=zt(f));return this.each(function(){var f,g={},p=h>1?jt(g,t,!0):t,m=0,v=this.getAttribute("id"),_=!1,x=Xt.defaults;if("table"!=this.nodeName.toLowerCase())return void Nt(null,0,"Non-table node initialisation ("+this.nodeName+")",2);o(x),c(x.column),r(x,x,!0),r(x.column,x.column,!0),r(x,p);var w=Xt.settings;for(m=0,f=w.length;m<f;m++){if(w[m].nTable==this){var C=p.bRetrieve!==n?p.bRetrieve:x.bRetrieve,T=p.bDestroy!==n?p.bDestroy:x.bDestroy;if(a||C)return w[m].oInstance;if(T){w[m].oInstance.fnDestroy();break}return void Nt(w[m],0,"Cannot reinitialise DataTable",3)}if(w[m].sTableId==this.id){w.splice(m,1);break}}null!==v&&""!==v||(v="DataTables_Table_"+Xt.ext._unique++,this.id=v);var K=i.extend(!0,{},Xt.models.oSettings,{nTable:this,oApi:e.internal,oInit:p,sDestroyWidth:i(this)[0].style.width,sInstance:v,sTableId:v});w.push(K),K.oInstance=1===e.length?e:i(this).dataTable(),o(p),p.oLanguage&&s(p.oLanguage),p.aLengthMenu&&!p.iDisplayLength&&(p.iDisplayLength=i.isArray(p.aLengthMenu[0])?p.aLengthMenu[0][0]:p.aLengthMenu[0]),p=jt(i.extend(!0,{},x),p),Gt(K.oFeatures,p,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),Gt(K,p,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),Gt(K.oScroll,p,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Gt(K.oLanguage,p,"fnInfoCallback"),Ot(K,"aoDrawCallback",p.fnDrawCallback,"user"),Ot(K,"aoServerParams",p.fnServerParams,"user"),Ot(K,"aoStateSaveParams",p.fnStateSaveParams,"user"),Ot(K,"aoStateLoadParams",p.fnStateLoadParams,"user"),Ot(K,"aoStateLoaded",p.fnStateLoaded,"user"),Ot(K,"aoRowCallback",p.fnRowCallback,"user"),Ot(K,"aoRowCreatedCallback",p.fnCreatedRow,"user"),Ot(K,"aoHeaderCallback",p.fnHeaderCallback,"user"),Ot(K,"aoFooterCallback",p.fnFooterCallback,"user"),Ot(K,"aoInitComplete",p.fnInitComplete,"user"),Ot(K,"aoPreDrawCallback",p.fnPreDrawCallback,"user");var D=K.oClasses;if(p.bJQueryUI?(i.extend(D,Xt.ext.oJUIClasses,p.oClasses),p.sDom===x.sDom&&"lfrtip"===x.sDom&&(K.sDom='<"H"lfr>t<"F"ip>'),K.renderer?i.isPlainObject(K.renderer)&&!K.renderer.header&&(K.renderer.header="jqueryui"):K.renderer="jqueryui"):i.extend(D,Xt.ext.classes,p.oClasses),i(this).addClass(D.sTable),""===K.oScroll.sX&&""===K.oScroll.sY||(K.oScroll.iBarWidth=Tt()),K.oScroll.sX===!0&&(K.oScroll.sX="100%"),K.iInitDisplayStart===n&&(K.iInitDisplayStart=p.iDisplayStart,K._iDisplayStart=p.iDisplayStart),null!==p.iDeferLoading){K.bDeferLoading=!0;var k=i.isArray(p.iDeferLoading);K._iRecordsDisplay=k?p.iDeferLoading[0]:p.iDeferLoading,K._iRecordsTotal=k?p.iDeferLoading[1]:p.iDeferLoading}""!==p.oLanguage.sUrl?(K.oLanguage.sUrl=p.oLanguage.sUrl,i.getJSON(K.oLanguage.sUrl,null,function(t){s(t),r(x.oLanguage,t),i.extend(!0,K.oLanguage,p.oLanguage,t),ot(K)}),_=!0):i.extend(!0,K.oLanguage,p.oLanguage),null===p.asStripeClasses&&(K.asStripeClasses=[D.sStripeOdd,D.sStripeEven]);var F=K.asStripeClasses,P=i("tbody tr:eq(0)",this);i.inArray(!0,i.map(F,function(t,e){return P.hasClass(t)}))!==-1&&(i("tbody tr",this).removeClass(F.join(" ")),K.asDestroyStripes=F.slice());var M,A=[],L=this.getElementsByTagName("thead");if(0!==L.length&&(U(K.aoHeader,L[0]),A=H(K)),null===p.aoColumns)for(M=[],m=0,f=A.length;m<f;m++)M.push(null);else M=p.aoColumns;for(m=0,f=M.length;m<f;m++)d(K,A?A[m]:null);if(y(K,p.aoColumnDefs,M,function(t,e){u(K,t,e)}),P.length){var R=function(t,e){return t.getAttribute("data-"+e)?e:null};i.each(I(K,P[0]).cells,function(t,e){var i=K.aoColumns[t];if(i.mData===t){var a=R(e,"sort")||R(e,"order"),r=R(e,"filter")||R(e,"search");null===a&&null===r||(i.mData={_:t+".display",sort:null!==a?t+".@data-"+a:n,type:null!==a?t+".@data-"+a:n,filter:null!==r?t+".@data-"+r:n},u(K,t))}})}var N=K.oFeatures;if(p.bStateSave&&(N.bStateSave=!0,Lt(K,p),Ot(K,"aoDrawCallback",It,"state_save")),p.aaSorting===n){var G=K.aaSorting;for(m=0,f=G.length;m<f;m++)G[m][1]=K.aoColumns[m].asSorting[0]}Mt(K),N.bSort&&Ot(K,"aoDrawCallback",function(){if(K.bSorted){var t=Kt(K),e={};i.each(t,function(t,n){e[n.src]=n.dir}),Ut(K,null,"order",[K,t,e]),kt(K)}}),Ot(K,"aoDrawCallback",function(){(K.bSorted||"ssp"===Yt(K)||N.bDeferRender)&&Mt(K)},"sc"),l(K);var j=i(this).children("caption").each(function(){this._captionSide=i(this).css("caption-side")}),$=i(this).children("thead");0===$.length&&($=i("<thead/>").appendTo(this)),K.nTHead=$[0];var O=i(this).children("tbody");0===O.length&&(O=i("<tbody/>").appendTo(this)),K.nTBody=O[0];var E=i(this).children("tfoot");if(0===E.length&&j.length>0&&(""!==K.oScroll.sX||""!==K.oScroll.sY)&&(E=i("<tfoot/>").appendTo(this)),0===E.length||0===E.children().length?i(this).addClass(D.sNoFooter):E.length>0&&(K.nTFoot=E[0],U(K.aoFooter,K.nTFoot)),p.aaData)for(m=0;m<p.aaData.length;m++)b(K,p.aaData[m]);else(K.bDeferLoading||"dom"==Yt(K))&&S(K,i(K.nTBody).children("tr"));K.aiDisplay=K.aiDisplayMaster.slice(),K.bInitialised=!0,_===!1&&ot(K)}),e=null,this};var we=[],Ce=Array.prototype,Te=function(t){var e,n,a=Xt.settings,r=i.map(a,function(t,e){return t.nTable});return t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?(e=i.inArray(t,r),e!==-1?[a[e]]:null):t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?n=i(t):t instanceof i&&(n=t),n?n.map(function(t){return e=i.inArray(this,r),e!==-1?a[e]:null}).toArray():void 0):[]};Jt=function(t,e){if(!this instanceof Jt)throw"DT API must be constructed as a new object";var n=[],a=function(t){var e=Te(t);e&&n.push.apply(n,e)};if(i.isArray(t))for(var r=0,s=t.length;r<s;r++)a(t[r]);else a(t);this.context=me(n),e&&this.push.apply(this,e.toArray?e.toArray():e),this.selector={rows:null,cols:null,opts:null},Jt.extend(this,this,we)},Xt.Api=Jt,Jt.prototype={concat:Ce.concat,context:[],each:function(t){for(var e=0,n=this.length;e<n;e++)t.call(this,this[e],e,this);return this},eq:function(t){var e=this.context;return e.length>t?new Jt(e[t],this[t]):null},filter:function(t){var e=[];if(Ce.filter)e=Ce.filter.call(this,t,this);else for(var n=0,i=this.length;n<i;n++)t.call(this,this[n],n,this)&&e.push(this[n]);return new Jt(this.context,e)},flatten:function(){var t=[];return new Jt(this.context,t.concat.apply(t,this.toArray()))},join:Ce.join,indexOf:Ce.indexOf||function(t,e){for(var n=e||0,i=this.length;n<i;n++)if(this[n]===t)return n;return-1},iterator:function(t,e,i){var a,r,s,o,c,l,h,d,u=[],f=this.context,g=this.selector;for("string"==typeof t&&(i=e,e=t,t=!1),r=0,s=f.length;r<s;r++)if("table"===e)a=i(f[r],r),a!==n&&u.push(a);else if("columns"===e||"rows"===e)a=i(f[r],this[r],r),a!==n&&u.push(a);else if("column"===e||"column-rows"===e||"row"===e||"cell"===e)for(h=this[r],"column-rows"===e&&(l=Me(f[r],g.opts)),o=0,c=h.length;o<c;o++)d=h[o],a="cell"===e?i(f[r],d.row,d.column,r,o):i(f[r],d,r,o,l),a!==n&&u.push(a);if(u.length){var p=new Jt(f,t?u.concat.apply([],u):u),m=p.selector;return m.rows=g.rows,m.cols=g.cols,m.opts=g.opts,p}return this},lastIndexOf:Ce.lastIndexOf||function(t,e){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(t){var e=[];if(Ce.map)e=Ce.map.call(this,t,this);else for(var n=0,i=this.length;n<i;n++)e.push(t.call(this,this[n],n));return new Jt(this.context,e)},pluck:function(t){return this.map(function(e){return e[t]})},pop:Ce.pop,push:Ce.push,reduce:Ce.reduce||function(t,e){return h(this,t,e,0,this.length,1)},reduceRight:Ce.reduceRight||function(t,e){return h(this,t,e,this.length-1,-1,-1)},reverse:Ce.reverse,selector:null,shift:Ce.shift,sort:Ce.sort,splice:Ce.splice,toArray:function(){return Ce.slice.call(this)},to$:function(){return i(this)},toJQuery:function(){return i(this)},unique:function(){return new Jt(this.context,me(this))},unshift:Ce.unshift},Jt.extend=function(t,e,n){if(e&&(e instanceof Jt||e.__dt_wrapper)){var a,r,s,o=function(t,e,n){return function(){var i=e.apply(t,arguments);return Jt.extend(i,i,n.methodExt),i}};for(a=0,r=n.length;a<r;a++)s=n[a],e[s.name]="function"==typeof s.val?o(t,s.val,s):i.isPlainObject(s.val)?{}:s.val,e[s.name].__dt_wrapper=!0,Jt.extend(t,e[s.name],s.propExt)}},Jt.register=Vt=function(t,e){if(i.isArray(t))for(var n=0,a=t.length;n<a;n++)Jt.register(t[n],e);else{var r,s,o,c,l=t.split("."),h=we,d=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n].name===e)return t[n];return null};for(r=0,s=l.length;r<s;r++){c=l[r].indexOf("()")!==-1,o=c?l[r].replace("()",""):l[r];var u=d(h,o);u||(u={name:o,val:{},methodExt:[],propExt:[]},h.push(u)),r===s-1?u.val=e:h=c?u.methodExt:u.propExt}}},Jt.registerPlural=Qt=function(t,e,a){Jt.register(t,a),Jt.register(e,function(){var t=a.apply(this,arguments);return t===this?this:t instanceof Jt?t.length?i.isArray(t[0])?new Jt(t.context,t[0]):t[0]:n:t})};var Ke=function(t,e){if("number"==typeof t)return[e[t]];var n=i.map(e,function(t,e){return t.nTable});return i(n).filter(t).map(function(t){var a=i.inArray(this,n);return e[a]}).toArray()};Vt("tables()",function(t){return t?new Jt(Ke(t,this.context)):this}),Vt("table()",function(t){var e=this.tables(t),n=e.context;return n.length?new Jt(n[0]):e}),Qt("tables().nodes()","table().node()",function(){return this.iterator("table",function(t){return t.nTable})}),Qt("tables().body()","table().body()",function(){return this.iterator("table",function(t){return t.nTBody})}),Qt("tables().header()","table().header()",function(){return this.iterator("table",function(t){return t.nTHead})}),Qt("tables().footer()","table().footer()",function(){return this.iterator("table",function(t){return t.nTFoot})}),Qt("tables().containers()","table().container()",function(){return this.iterator("table",function(t){return t.nTableWrapper})}),Vt("draw()",function(t){return this.iterator("table",function(e){$(e,t===!1)})}),Vt("page()",function(t){return t===n?this.page.info().page:this.iterator("table",function(e){ut(e,t)})}),Vt("page.info()",function(t){if(0===this.context.length)return n;var e=this.context[0],i=e._iDisplayStart,a=e._iDisplayLength,r=e.fnRecordsDisplay(),s=a===-1;return{page:s?0:Math.floor(i/a),pages:s?1:Math.ceil(r/a),start:i,end:e.fnDisplayEnd(),length:a,recordsTotal:e.fnRecordsTotal(),recordsDisplay:r}}),Vt("page.len()",function(t){return t===n?0!==this.context.length?this.context[0]._iDisplayLength:n:this.iterator("table",function(e){lt(e,t)})});var De=function(t,e,n){if("ssp"==Yt(t)?$(t,e):(gt(t,!0),E(t,[],function(n){P(t);for(var i=z(t,n),a=0,r=i.length;a<r;a++)b(t,i[a]);$(t,e),gt(t,!1)})),n){var i=new Jt(t);i.one("draw",function(){n(i.ajax.json())})}};Vt("ajax.json()",function(){var t=this.context;if(t.length>0)return t[0].json}),Vt("ajax.params()",function(){var t=this.context;if(t.length>0)return t[0].oAjaxData}),Vt("ajax.reload()",function(t,e){return this.iterator("table",function(n){De(n,e===!1,t)})}),Vt("ajax.url()",function(t){var e=this.context;return t===n?0===e.length?n:(e=e[0],e.ajax?i.isPlainObject(e.ajax)?e.ajax.url:e.ajax:e.sAjaxSource):this.iterator("table",function(e){i.isPlainObject(e.ajax)?e.ajax.url=t:e.ajax=t})}),Vt("ajax.url().load()",function(t,e){return this.iterator("table",function(n){De(n,e===!1,t)})});var ke=function(t,e){var a,r,s,o,c,l,h=[];for(t&&"string"!=typeof t&&t.length!==n||(t=[t]),s=0,o=t.length;s<o;s++)for(r=t[s]&&t[s].split?t[s].split(","):[t[s]],c=0,l=r.length;c<l;c++)a=e("string"==typeof r[c]?i.trim(r[c]):r[c]),a&&a.length&&h.push.apply(h,a);return h},Fe=function(t){return t||(t={}),t.filter&&!t.search&&(t.search=t.filter),{search:t.search||"none",order:t.order||"current",page:t.page||"all"}},Pe=function(t){for(var e=0,n=t.length;e<n;e++)if(t[e].length>0)return t[0]=t[e],t.length=1,t.context=[t.context[e]],t;return t.length=0,t},Me=function(t,e){var n,a,r,s=[],o=t.aiDisplay,c=t.aiDisplayMaster,l=e.search,h=e.order,d=e.page;if("ssp"==Yt(t))return"removed"===l?[]:ge(0,c.length);
if("current"==d)for(n=t._iDisplayStart,a=t.fnDisplayEnd();n<a;n++)s.push(o[n]);else if("current"==h||"applied"==h)s="none"==l?c.slice():"applied"==l?o.slice():i.map(c,function(t,e){return i.inArray(t,o)===-1?t:null});else if("index"==h||"original"==h)for(n=0,a=t.aoData.length;n<a;n++)"none"==l?s.push(n):(r=i.inArray(n,o),(r===-1&&"removed"==l||r>=0&&"applied"==l)&&s.push(n));return s},Ae=function(t,e,n){return ke(e,function(e){var a=oe(e);if(null!==a&&!n)return[a];var r=Me(t,n);if(null!==a&&i.inArray(a,r)!==-1)return[a];if(!e)return r;for(var s=[],o=0,c=r.length;o<c;o++)s.push(t.aoData[r[o]].nTr);return e.nodeName&&i.inArray(e,s)!==-1?[e._DT_RowIndex]:i(s).filter(e).map(function(){return this._DT_RowIndex}).toArray()})};Vt("rows()",function(t,e){t===n?t="":i.isPlainObject(t)&&(e=t,t=""),e=Fe(e);var a=this.iterator("table",function(n){return Ae(n,t,e)});return a.selector.rows=t,a.selector.opts=e,a}),Vt("rows().nodes()",function(){return this.iterator("row",function(t,e){return t.aoData[e].nTr||n})}),Vt("rows().data()",function(){return this.iterator(!0,"rows",function(t,e){return fe(t.aoData,e,"_aData")})}),Qt("rows().cache()","row().cache()",function(t){return this.iterator("row",function(e,n){var i=e.aoData[n];return"search"===t?i._aFilterData:i._aSortData})}),Qt("rows().invalidate()","row().invalidate()",function(t){return this.iterator("row",function(e,n){A(e,n,t)})}),Qt("rows().indexes()","row().index()",function(){return this.iterator("row",function(t,e){return e})}),Qt("rows().remove()","row().remove()",function(){var t=this;return this.iterator("row",function(e,n,a){var r=e.aoData;r.splice(n,1);for(var s=0,o=r.length;s<o;s++)null!==r[s].nTr&&(r[s].nTr._DT_RowIndex=s);i.inArray(n,e.aiDisplay);M(e.aiDisplayMaster,n),M(e.aiDisplay,n),M(t[a],n,!1),Ht(e)})}),Vt("rows.add()",function(t){var e=this.iterator("table",function(e){var n,i,a,r=[];for(i=0,a=t.length;i<a;i++)n=t[i],n.nodeName&&"TR"===n.nodeName.toUpperCase()?r.push(S(e,n)[0]):r.push(b(e,n));return r}),n=this.rows(-1);return n.pop(),n.push.apply(n,e.toArray()),n}),Vt("row()",function(t,e){return Pe(this.rows(t,e))}),Vt("row().data()",function(t){var e=this.context;return t===n?e.length&&this.length?e[0].aoData[this[0]]._aData:n:(e[0].aoData[this[0]]._aData=t,A(e[0],this[0],"data"),this)}),Vt("row().node()",function(){var t=this.context;return t.length&&this.length?t[0].aoData[this[0]].nTr||null:null}),Vt("row.add()",function(t){t instanceof i&&t.length&&(t=t[0]);var e=this.iterator("table",function(e){return t.nodeName&&"TR"===t.nodeName.toUpperCase()?S(e,t)[0]:b(e,t)});return this.row(e[0])});var Ie=function(t,e,n,a){var r=[],s=function(e,n){if(e.nodeName&&"tr"===e.nodeName.toLowerCase())r.push(e);else{var a=i("<tr><td/></tr>").addClass(n);i("td",a).addClass(n).html(e)[0].colSpan=m(t),r.push(a[0])}};if(i.isArray(n)||n instanceof i)for(var o=0,c=n.length;o<c;o++)s(n[o],a);else s(n,a);e._details&&e._details.remove(),e._details=i(r),e._detailsShow&&e._details.insertAfter(e.nTr)},Le=function(t){var e=t.context;if(e.length&&t.length){var i=e[0].aoData[t[0]];i._details&&(i._details.remove(),i._detailsShow=n,i._details=n)}},Re=function(t,e){var n=t.context;if(n.length&&t.length){var i=n[0].aoData[t[0]];i._details&&(i._detailsShow=e,e?i._details.insertAfter(i.nTr):i._details.detach(),Ne(n[0]))}},Ne=function(t){var e=new Jt(t),n=".dt.DT_details",i="draw"+n,a="column-visibility"+n,r="destroy"+n,s=t.aoData;e.off(i+" "+a+" "+r),ue(s,"_details").length>0&&(e.on(i,function(n,i){t===i&&e.rows({page:"current"}).eq(0).each(function(t){var e=s[t];e._detailsShow&&e._details.insertAfter(e.nTr)})}),e.on(a,function(e,n,i,a){if(t===n)for(var r,o=m(n),c=0,l=s.length;c<l;c++)r=s[c],r._details&&r._details.children("td[colspan]").attr("colspan",o)}),e.on(r,function(e,n){if(t===n)for(var i=0,a=s.length;i<a;i++)s[i]._details&&Le(s[i])}))},Ge="",je=Ge+"row().child",$e=je+"()";Vt($e,function(t,e){var i=this.context;return t===n?i.length&&this.length?i[0].aoData[this[0]]._details:n:(t===!0?this.child.show():t===!1?Le(this):i.length&&this.length&&Ie(i[0],i[0].aoData[this[0]],t,e),this)}),Vt([je+".show()",$e+".show()"],function(t){return Re(this,!0),this}),Vt([je+".hide()",$e+".hide()"],function(){return Re(this,!1),this}),Vt([je+".remove()",$e+".remove()"],function(){return Le(this),this}),Vt(je+".isShown()",function(){var t=this.context;return!(!t.length||!this.length)&&(t[0].aoData[this[0]]._detailsShow||!1)});var Oe=/^(.*):(name|visIdx|visible)$/,Ue=function(t,e,n){var a=t.aoColumns,r=ue(a,"sName"),s=ue(a,"nTh");return ke(e,function(e){var n=oe(e);if(""===e)return ge(a.length);if(null!==n)return[n>=0?n:a.length+n];var o="string"==typeof e?e.match(Oe):"";if(!o)return i(s).filter(e).map(function(){return i.inArray(this,s)}).toArray();switch(o[2]){case"visIdx":case"visible":var c=parseInt(o[1],10);if(c<0){var l=i.map(a,function(t,e){return t.bVisible?e:null});return[l[l.length+c]]}return[g(t,c)];case"name":return i.map(r,function(t,e){return t===o[1]?e:null})}})},He=function(t,e,a){var r,s,o,c,l=t.aoColumns,h=l[e],d=t.aoData;if(a===n)return h.bVisible;if(h.bVisible!==a){if(a){var u=i.inArray(!0,ue(l,"bVisible"),e+1);for(s=0,o=d.length;s<o;s++)c=d[s].nTr,r=d[s].anCells,c&&c.insertBefore(r[e],r[u]||null)}else i(ue(t.aoData,"anCells",e)).detach();h.bVisible=a,G(t,t.aoHeader),G(t,t.aoFooter),f(t),(t.oScroll.sX||t.oScroll.sY)&&mt(t),Ut(t,null,"column-visibility",[t,e,a]),It(t)}};Vt("columns()",function(t,e){t===n?t="":i.isPlainObject(t)&&(e=t,t=""),e=Fe(e);var a=this.iterator("table",function(n){return Ue(n,t,e)});return a.selector.cols=t,a.selector.opts=e,a}),Qt("columns().header()","column().header()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTh})}),Qt("columns().footer()","column().footer()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTf})}),Qt("columns().data()","column().data()",function(){return this.iterator("column-rows",function(t,e,n,i,a){for(var r=[],s=0,o=a.length;s<o;s++)r.push(C(t,a[s],e,""));return r})}),Qt("columns().cache()","column().cache()",function(t){return this.iterator("column-rows",function(e,n,i,a,r){return fe(e.aoData,r,"search"===t?"_aFilterData":"_aSortData",n)})}),Qt("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(t,e,n,i,a){return fe(t.aoData,a,"anCells",e)})}),Qt("columns().visible()","column().visible()",function(t){return this.iterator("column",function(e,i){return t===n?e.aoColumns[i].bVisible:He(e,i,t)})}),Qt("columns().indexes()","column().index()",function(t){return this.iterator("column",function(e,n){return"visible"===t?p(e,n):n})}),Vt("columns.adjust()",function(){return this.iterator("table",function(t){f(t)})}),Vt("column.index()",function(t,e){if(0!==this.context.length){var n=this.context[0];if("fromVisible"===t||"toData"===t)return g(n,e);if("fromData"===t||"toVisible"===t)return p(n,e)}}),Vt("column()",function(t,e){return Pe(this.columns(t,e))});var Ee=function(t,e,a){var r,s,o,c,l,h=t.aoData,d=Me(t,a),u=fe(h,d,"anCells"),f=i([].concat.apply([],u)),g=t.aoColumns.length;return ke(e,function(t){if(null===t||t===n){for(s=[],o=0,c=d.length;o<c;o++)for(r=d[o],l=0;l<g;l++)s.push({row:r,column:l});return s}return i.isPlainObject(t)?[t]:f.filter(t).map(function(t,e){return r=e.parentNode._DT_RowIndex,{row:r,column:i.inArray(e,h[r].anCells)}}).toArray()})};Vt("cells()",function(t,e,a){if(i.isPlainObject(t)&&(typeof t.row!==n?(a=e,e=null):(a=t,t=null)),i.isPlainObject(e)&&(a=e,e=null),null===e||e===n)return this.iterator("table",function(e){return Ee(e,t,Fe(a))});var r,s,o,c,l,h=this.columns(e,a),d=this.rows(t,a),u=this.iterator("table",function(t,e){for(r=[],s=0,o=d[e].length;s<o;s++)for(c=0,l=h[e].length;c<l;c++)r.push({row:d[e][s],column:h[e][c]});return r});return i.extend(u.selector,{cols:e,rows:t,opts:a}),u}),Qt("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(t,e,n){return t.aoData[e].anCells[n]})}),Vt("cells().data()",function(){return this.iterator("cell",function(t,e,n){return C(t,e,n)})}),Qt("cells().cache()","cell().cache()",function(t){return t="search"===t?"_aFilterData":"_aSortData",this.iterator("cell",function(e,n,i){return e.aoData[n][t][i]})}),Qt("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(t,e,n){return{row:e,column:n,columnVisible:p(t,n)}})}),Vt(["cells().invalidate()","cell().invalidate()"],function(t){var e=this.selector;return this.rows(e.rows,e.opts).invalidate(t),this}),Vt("cell()",function(t,e,n){return Pe(this.cells(t,e,n))}),Vt("cell().data()",function(t){var e=this.context,i=this[0];return t===n?e.length&&i.length?C(e[0],i[0].row,i[0].column):n:(T(e[0],i[0].row,i[0].column,t),A(e[0],i[0].row,"data",i[0].column),this)}),Vt("order()",function(t,e){var a=this.context;return t===n?0!==a.length?a[0].aaSorting:n:("number"==typeof t?t=[[t,e]]:i.isArray(t[0])||(t=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=t.slice()}))}),Vt("order.listener()",function(t,e,n){return this.iterator("table",function(i){Pt(i,t,e,n)})}),Vt(["columns().order()","column().order()"],function(t){var e=this;return this.iterator("table",function(n,a){var r=[];i.each(e[a],function(e,n){r.push([n,t])}),n.aaSorting=r})}),Vt("search()",function(t,e,a,r){var s=this.context;return t===n?0!==s.length?s[0].oPreviousSearch.sSearch:n:this.iterator("table",function(n){n.oFeatures.bFilter&&q(n,i.extend({},n.oPreviousSearch,{sSearch:t+"",bRegex:null!==e&&e,bSmart:null===a||a,bCaseInsensitive:null===r||r}),1)})}),Vt(["columns().search()","column().search()"],function(t,e,a,r){return this.iterator("column",function(s,o){var c=s.aoPreSearchCols;return t===n?c[o].sSearch:void(s.oFeatures.bFilter&&(i.extend(c[o],{sSearch:t+"",bRegex:null!==e&&e,bSmart:null===a||a,bCaseInsensitive:null===r||r}),q(s,s.oPreviousSearch,1)))})}),Vt("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Vt("state.clear()",function(){return this.iterator("table",function(t){t.fnStateSaveCallback.call(t.oInstance,t,{})})}),Vt("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Vt("state.save()",function(){return this.iterator("table",function(t){It(t)})}),Xt.versionCheck=Xt.fnVersionCheck=function(t){for(var e,n,i=Xt.version.split("."),a=t.split("."),r=0,s=a.length;r<s;r++)if(e=parseInt(i[r],10)||0,n=parseInt(a[r],10)||0,e!==n)return e>n;return!0},Xt.isDataTable=Xt.fnIsDataTable=function(t){var e=i(t).get(0),n=!1;return i.each(Xt.settings,function(t,i){i.nTable!==e&&i.nScrollHead!==e&&i.nScrollFoot!==e||(n=!0)}),n},Xt.tables=Xt.fnTables=function(t){return jQuery.map(Xt.settings,function(e){if(!t||t&&i(e.nTable).is(":visible"))return e.nTable})},Xt.camelToHungarian=r,Vt("$()",function(t,e){var n=this.rows(e).nodes(),a=i(n);return i([].concat(a.filter(t).toArray(),a.find(t).toArray()))}),i.each(["on","one","off"],function(t,e){Vt(e+"()",function(){var t=Array.prototype.slice.call(arguments);t[0].match(/\.dt\b/)||(t[0]+=".dt");var n=i(this.tables().nodes());return n[e].apply(n,t),this})}),Vt("clear()",function(){return this.iterator("table",function(t){P(t)})}),Vt("settings()",function(){return new Jt(this.context,this.context)}),Vt("data()",function(){return this.iterator("table",function(t){return ue(t.aoData,"_aData")}).flatten()}),Vt("destroy()",function(e){return e=e||!1,this.iterator("table",function(n){var a,r=n.nTableWrapper.parentNode,s=n.oClasses,o=n.nTable,c=n.nTBody,l=n.nTHead,h=n.nTFoot,d=i(o),u=i(c),f=i(n.nTableWrapper),g=i.map(n.aoData,function(t){return t.nTr});n.bDestroying=!0,Ut(n,"aoDestroyCallback","destroy",[n]),e||new Jt(n).columns().visible(!0),f.unbind(".DT").find(":not(tbody *)").unbind(".DT"),i(t).unbind(".DT-"+n.sInstance),o!=l.parentNode&&(d.children("thead").detach(),d.append(l)),h&&o!=h.parentNode&&(d.children("tfoot").detach(),d.append(h)),d.detach(),f.detach(),n.aaSorting=[],n.aaSortingFixed=[],Mt(n),i(g).removeClass(n.asStripeClasses.join(" ")),i("th, td",l).removeClass(s.sSortable+" "+s.sSortableAsc+" "+s.sSortableDesc+" "+s.sSortableNone),n.bJUI&&(i("th span."+s.sSortIcon+", td span."+s.sSortIcon,l).detach(),i("th, td",l).each(function(){var t=i("div."+s.sSortJUIWrapper,this);i(this).append(t.contents()),t.detach()})),!e&&r&&r.insertBefore(o,n.nTableReinsertBefore),u.children().detach(),u.append(g),d.css("width",n.sDestroyWidth).removeClass(s.sTable),a=n.asDestroyStripes.length,a&&u.children().each(function(t){i(this).addClass(n.asDestroyStripes[t%a])});var p=i.inArray(n,Xt.settings);p!==-1&&Xt.settings.splice(p,1)})}),Xt.version="1.10.1",Xt.settings=[],Xt.models={},Xt.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},Xt.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null},Xt.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},Xt.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(t){try{return JSON.parse((t.iStateDuration===-1?sessionStorage:localStorage).getItem("DataTables_"+t.sInstance+"_"+location.pathname))}catch(e){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(t,e){try{(t.iStateDuration===-1?sessionStorage:localStorage).setItem("DataTables_"+t.sInstance+"_"+location.pathname,JSON.stringify(e))}catch(n){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:i.extend({},Xt.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null},a(Xt.defaults),Xt.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},a(Xt.defaults.column),Xt.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:n,oAjaxData:n,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==Yt(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==Yt(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var t=this._iDisplayLength,e=this._iDisplayStart,n=e+t,i=this.aiDisplay.length,a=this.oFeatures,r=a.bPaginate;return a.bServerSide?r===!1||t===-1?e+i:Math.min(e+t,this._iRecordsDisplay):!r||n>i||t===-1?i:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}},Xt.ext=qt={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:Xt.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:Xt.version},i.extend(qt,{afnFiltering:qt.search,aTypes:qt.type.detect,ofnSearch:qt.type.search,oSort:qt.type.order,afnSortData:qt.order,aoFeatures:qt.feature,oApi:qt.internal,oStdClasses:qt.classes,oPagination:qt.pager}),i.extend(Xt.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),function(){var t="";t="";var e=t+"ui-state-default",n=t+"css_right ui-icon ui-icon-",a=t+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";i.extend(Xt.ext.oJUIClasses,Xt.ext.classes,{sPageButton:"fg-button ui-button "+e,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:e+" sorting_asc",sSortDesc:e+" sorting_desc",sSortable:e+" sorting",sSortableAsc:e+" sorting_asc_disabled",sSortableDesc:e+" sorting_desc_disabled",sSortableNone:e+" sorting_disabled",sSortJUIAsc:n+"triangle-1-n",sSortJUIDesc:n+"triangle-1-s",sSortJUI:n+"carat-2-n-s",sSortJUIAscAllowed:n+"carat-1-n",sSortJUIDescAllowed:n+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+e,sScrollFoot:"dataTables_scrollFoot "+e,sHeaderTH:e,sFooterTH:e,sJUIHeader:a+" ui-corner-tl ui-corner-tr",sJUIFooter:a+" ui-corner-bl ui-corner-br"})}();var Ye=Xt.ext.pager;i.extend(Ye,{simple:function(t,e){return["previous","next"]},full:function(t,e){return["first","previous","next","last"]},simple_numbers:function(t,e){return["previous",Wt(t,e),"next"]},full_numbers:function(t,e){return["first","previous",Wt(t,e),"next","last"]},_numbers:Wt,numbers_length:7}),i.extend(!0,Xt.ext.renderer,{pageButton:{_:function(t,n,a,r,s,o){var c,l,h=t.oClasses,d=t.oLanguage.oPaginate,u=0,f=function(e,n){var r,g,p,m,v=function(e){ut(t,e.data.action,!0)};for(r=0,g=n.length;r<g;r++)if(m=n[r],i.isArray(m)){var _=i("<"+(m.DT_el||"div")+"/>").appendTo(e);f(_,m)}else{switch(c="",l="",m){case"ellipsis":e.append("<span>&hellip;</span>");break;case"first":c=d.sFirst,l=m+(s>0?"":" "+h.sPageButtonDisabled);break;case"previous":c=d.sPrevious,l=m+(s>0?"":" "+h.sPageButtonDisabled);break;case"next":c=d.sNext,l=m+(s<o-1?"":" "+h.sPageButtonDisabled);break;case"last":c=d.sLast,l=m+(s<o-1?"":" "+h.sPageButtonDisabled);break;default:c=m+1,l=s===m?h.sPageButtonActive:""}c&&(p=i("<a>",{"class":h.sPageButton+" "+l,"aria-controls":t.sTableId,"data-dt-idx":u,tabindex:t.iTabIndex,id:0===a&&"string"==typeof m?t.sTableId+"_"+m:null}).html(c).appendTo(e),$t(p,{action:m},v),u++)}};try{var g=i(e.activeElement).data("dt-idx");f(i(n).empty(),r),null!==g&&i(n).find("[data-dt-idx="+g+"]").focus()}catch(p){}}}});var We=function(t,e,n,i){return t&&"-"!==t?(e&&(t=ce(t,e)),t.replace&&(n&&(t=t.replace(n,"")),i&&(t=t.replace(i,""))),1*t):-(1/0)};return i.extend(qt.type.order,{"date-pre":function(t){return Date.parse(t)||0},"html-pre":function(t){return se(t)?"":t.replace?t.replace(/<.*?>/g,"").toLowerCase():t+""},"string-pre":function(t){return se(t)?"":"string"==typeof t?t.toLowerCase():t.toString?t.toString():""},"string-asc":function(t,e){return t<e?-1:t>e?1:0},"string-desc":function(t,e){return t<e?1:t>e?-1:0}}),Bt(""),i.extend(Xt.ext.type.detect,[function(t,e){var n=e.oLanguage.sDecimal;return le(t,n)?"num"+n:null},function(t,e){if(t&&(!ne.test(t)||!ie.test(t)))return null;var n=Date.parse(t);return null!==n&&!isNaN(n)||se(t)?"date":null},function(t,e){var n=e.oLanguage.sDecimal;return le(t,n,!0)?"num-fmt"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return de(t,n)?"html-num"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return de(t,n,!0)?"html-num-fmt"+n:null},function(t,e){return se(t)||"string"==typeof t&&t.indexOf("<")!==-1?"html":null}]),i.extend(Xt.ext.type.search,{html:function(t){return se(t)?t:"string"==typeof t?t.replace(te," ").replace(ee,""):""},string:function(t){return se(t)?t:"string"==typeof t?t.replace(te," "):t}}),i.extend(!0,Xt.ext.renderer,{header:{_:function(t,e,n,a){i(t.nTable).on("order.dt.DT",function(i,r,s,o){if(t===r){var c=n.idx;e.removeClass(n.sSortingClass+" "+a.sSortAsc+" "+a.sSortDesc).addClass("asc"==o[c]?a.sSortAsc:"desc"==o[c]?a.sSortDesc:n.sSortingClass)}})},jqueryui:function(t,e,n,a){var r=n.idx;i("<div/>").addClass(a.sSortJUIWrapper).append(e.contents()).append(i("<span/>").addClass(a.sSortIcon+" "+n.sSortingClassJUI)).appendTo(e),i(t.nTable).on("order.dt.DT",function(i,s,o,c){t===s&&(e.removeClass(a.sSortAsc+" "+a.sSortDesc).addClass("asc"==c[r]?a.sSortAsc:"desc"==c[r]?a.sSortDesc:n.sSortingClass),e.find("span."+a.sSortIcon).removeClass(a.sSortJUIAsc+" "+a.sSortJUIDesc+" "+a.sSortJUI+" "+a.sSortJUIAscAllowed+" "+a.sSortJUIDescAllowed).addClass("asc"==c[r]?a.sSortJUIAsc:"desc"==c[r]?a.sSortJUIDesc:n.sSortingClassJUI))})}}}),Xt.render={number:function(t,e,n,i){return{display:function(a){var r=a<0?"-":"";a=Math.abs(parseFloat(a));var s=parseInt(a,10),o=n?e+(a-s).toFixed(n).substring(2):"";return r+(i||"")+s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,t)+o}}}},i.extend(Xt.ext.internal,{_fnExternApiFunc:zt,_fnBuildAjax:E,_fnAjaxUpdate:Y,_fnAjaxParameters:W,_fnAjaxUpdateDraw:B,_fnAjaxDataSrc:z,_fnAddColumn:d,_fnColumnOptions:u,_fnAdjustColumnSizing:f,_fnVisibleToColumnIndex:g,_fnColumnIndexToVisible:p,_fnVisbleColumns:m,_fnGetColumns:v,_fnColumnTypes:_,_fnApplyColumnDefs:y,_fnHungarianMap:a,_fnCamelToHungarian:r,_fnLanguageCompat:s,_fnBrowserDetect:l,_fnAddData:b,_fnAddTr:S,_fnNodeToDataIndex:x,_fnNodeToColumnIndex:w,_fnGetCellData:C,_fnSetCellData:T,_fnSplitObjNotation:K,_fnGetObjectDataFn:D,_fnSetObjectDataFn:k,_fnGetDataMaster:F,_fnClearTable:P,_fnDeleteIndex:M,_fnInvalidateRow:A,_fnGetRowElements:I,_fnCreateTr:L,_fnBuildHead:N,_fnDrawHead:G,_fnDraw:j,_fnReDraw:$,_fnAddOptionsHtml:O,_fnDetectHeader:U,_fnGetUniqueThs:H,_fnFeatureHtmlFilter:X,_fnFilterComplete:q,_fnFilterCustom:J,_fnFilterColumn:V,_fnFilter:Q,_fnFilterCreateSearch:Z,_fnEscapeRegex:tt,_fnFilterData:et,_fnFeatureHtmlInfo:at,_fnUpdateInfo:rt,_fnInfoMacros:st,_fnInitialise:ot,_fnInitComplete:ct,_fnLengthChange:lt,_fnFeatureHtmlLength:ht,_fnFeatureHtmlPaginate:dt,_fnPageChange:ut,_fnFeatureHtmlProcessing:ft,_fnProcessingDisplay:gt,_fnFeatureHtmlTable:pt,_fnScrollDraw:mt,_fnApplyToChildren:vt,_fnCalculateColumnWidths:_t,_fnThrottle:yt,_fnConvertToWidth:bt,_fnScrollingWidthAdjust:St,_fnGetWidestNode:xt,_fnGetMaxLenString:wt,_fnStringToCss:Ct,_fnScrollBarWidth:Tt,_fnSortFlatten:Kt,_fnSort:Dt,_fnSortAria:kt,_fnSortListener:Ft,_fnSortAttachListener:Pt,_fnSortingClasses:Mt,_fnSortData:At,_fnSaveState:It,_fnLoadState:Lt,_fnSettingsFromNode:Rt,_fnLog:Nt,_fnMap:Gt,_fnBindAction:$t,_fnCallbackReg:Ot,_fnCallbackFire:Ut,_fnLengthOverflow:Ht,_fnRenderer:Et,_fnDataSource:Yt,_fnRowAttributes:R,_fnCalculateEnd:function(){}}),i.fn.dataTable=Xt,i.fn.dataTableSettings=Xt.settings,i.fn.dataTableExt=Xt.ext,i.fn.DataTable=function(t){return i(this).dataTable(t).api()},i.each(Xt,function(t,e){i.fn.DataTable[t]=e}),i.fn.dataTable})}(window,document),function(t,e,n){var i=function(t,e){"use strict";t.extend(e.ext.classes,{sWrapper:"dataTables_wrapper dt-foundation"}),t.extend(!0,e.defaults,{dom:"<'row'<'small-6 columns'l><'small-6 columns'f>r>t<'row'<'small-6 columns'i><'small-6 columns'p>>",renderer:"foundation"}),e.ext.renderer.pageButton.foundation=function(n,i,a,r,s,o){var c,l,h=new e.Api(n),d=n.oClasses,u=n.oLanguage.oPaginate,f=function(e,i){var r,g,p,m,v=function(t){t.preventDefault(),"ellipsis"!==t.data.action&&h.page(t.data.action).draw(!1)};for(r=0,g=i.length;r<g;r++)if(m=i[r],t.isArray(m))f(e,m);else{switch(c="",l="",m){case"ellipsis":c="&hellip;",l="unavailable";break;case"first":c=u.sFirst,l=m+(s>0?"":" unavailable");break;case"previous":c=u.sPrevious,l=m+(s>0?"":" unavailable");break;case"next":c=u.sNext,l=m+(s<o-1?"":" unavailable");break;case"last":c=u.sLast,l=m+(s<o-1?"":" unavailable");break;default:c=m+1,l=s===m?"current":""}c&&(p=t("<li>",{"class":d.sPageButton+" "+l,"aria-controls":n.sTableId,tabindex:n.iTabIndex,id:0===a&&"string"==typeof m?n.sTableId+"_"+m:null}).append(t("<a>",{href:"#"}).html(c)).appendTo(e),n.oApi._fnBindAction(p,{action:m},v))}};f(t(i).empty().html('<ul class="pagination"/>').children("ul"),r)},e.TableTools&&(t.extend(!0,e.TableTools.classes,{container:"DTTT button-group",buttons:{normal:"button",disabled:"disabled"},collection:{container:"DTTT_dropdown dropdown-menu",buttons:{normal:"",disabled:"disabled"}},select:{row:"active"}}),t.extend(!0,e.TableTools.DEFAULTS.oTags,{collection:{container:"ul",button:"li",liner:"a"}}))};"function"==typeof define&&define.amd?define(["jquery","datatables"],i):"object"==typeof exports?i(require("jquery"),require("datatables")):jQuery&&i(jQuery,jQuery.fn.dataTable)}(window,document),function(t){"use strict";t.fn.idle=function(e){var n,i,a={idle:6e4,events:"mousemove keypress mousedown touchstart",onIdle:function(){},onActive:function(){},onHide:function(){},onShow:function(){},keepTracking:!1},r=!1,s=!0,o=t.extend({},a,e);return n=function(t,e){return r&&(e.onActive.call(),r=!1),(e.keepTracking?clearInterval:clearTimeout)(t),i(e)},i=function(t){var e,n=t.keepTracking?setInterval:setTimeout;return e=n(function(){r=!0,t.onIdle.call()},t.idle)},this.each(function(){var a=i(o);t(this).on(o.events,function(t){a=n(a,o)}),(e.onShow||e.onHide)&&t(document).on("visibilitychange webkitvisibilitychange mozvisibilitychange msvisibilitychange",function(){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?s&&(s=!1,o.onHide.call()):s||(s=!0,o.onShow.call())})})}}(jQuery);var EnjoyHint=function(t){var e=this,n={onStart:function(){},onEnd:function(){},onSkip:function(){}},i=$.extend(n,t),a=[],r=0;l=$("body");var s=function(){$(".enjoyhint")&&$(".enjoyhint").remove(),$("body").css({overflow:"hidden"}),$(document).on("touchmove",o),l.enjoyhint({onNextClick:function(){d()},onSkipClick:function(){u()}})},o=function(t){t.preventDefault()},c=function(){l=$("body"),$(".enjoyhint").remove(),$("body").css({overflow:"auto"}),$(document).off("touchmove",o)};e.clear=function(){$(".enjoyhint_next_btn").removeClass(e.nextUserClass),$(".enjoyhint_next_btn").text("Next"),$(".enjoyhint_skip_btn").removeClass(e.skipUserClass),$(".enjoyhint_skip_btn").text("Skip")};var l=$("body"),h=function(){if(a&&a[r]){$(".enjoyhint").removeClass("enjoyhint-step-"+r),$(".enjoyhint").addClass("enjoyhint-step-"+(r+1));var t=a[r];t.onBeforeStart&&"function"==typeof t.onBeforeStart&&t.onBeforeStart();var n=t.timeout||0;setTimeout(function(){if(!t.selector)for(var n in t)if(t.hasOwnProperty(n)&&n.split(" ")[1]){var i=n.indexOf(" ");t.event=n.slice(0,i),t.selector=n.slice(i+1),("next"==t.event||"auto"==t.event||"custom"==t.event)&&(t.event_type=t.event),t.description=t[n]}setTimeout(function(){e.clear()},250),$(document.body).scrollTo(t.selector,t.scrollAnimationSpeed||250,{offset:-100}),setTimeout(function(){var n=$(t.selector),i=f(t.event);l.enjoyhint("show"),l.enjoyhint("hide_next");var a=n;if(t.event_selector&&(a=$(t.event_selector)),t.event_type||"key"!=t.event||n.keydown(function(e){e.which==t.keyCode&&(r++,h())}),1==t.showNext&&l.enjoyhint("show_next"),0==t.showSkip?l.enjoyhint("hide_skip"):l.enjoyhint("show_skip"),1==t.showSkip,t.nextButton&&($(".enjoyhint_next_btn").addClass(t.nextButton.className||""),$(".enjoyhint_next_btn").text(t.nextButton.text||"Next"),e.nextUserClass=t.nextButton.className),t.skipButton&&($(".enjoyhint_skip_btn").addClass(t.skipButton.className||""),$(".enjoyhint_skip_btn").text(t.skipButton.text||"Skip"),e.skipUserClass=t.skipButton.className),t.event_type)switch(t.event_type){case"auto":switch(n[t.event](),t.event){case"click":}return r++,void h();case"custom":g(t.event,function(){r++,p(t.event),h()});break;case"next":l.enjoyhint("show_next")}else a.on(i,function(e){t.keyCode&&e.keyCode!=t.keyCode||(r++,$(this).off(i),h())});var s=Math.max(n.outerWidth(),n.outerHeight()),o=t.radius||Math.round(s/2)+5,c=n.offset(),d=n.outerWidth(),u=n.outerHeight(),m=void 0!==t.margin?t.margin:10,v={x:c.left+Math.round(d/2),y:c.top+Math.round(u/2)-$(document).scrollTop()},_={center_x:v.x,center_y:v.y,text:t.description,top:t.top,bottom:t.bottom,left:t.left,right:t.right,margin:t.margin,scroll:t.scroll};t.shape&&"circle"==t.shape?(_.shape="circle",_.radius=o):(_.radius=0,_.width=d+m,_.height=u+m),l.enjoyhint("render_label_with_shape",_)},t.scrollAnimationSpeed+20||270)},n)}else l.enjoyhint("hide"),i.onEnd(),c()},d=function(){r++,h()},u=function(){var t=a[r],e=$(t.selector);p(t.event),e.off(f(t.event)),i.onSkip(),c()},f=function(t,e){return t+(e?"custom":"")+".enjoy_hint"},g=function(t,e){l.on(f(t,!0),e)},p=function(t){l.off(f(t,!0))};e.runScript=function(){r=0,i.onStart(),h()},e.resumeScript=function(){h()},e.getCurrentStep=function(){return r},e.trigger=function(t){switch(t){case"next":d();break;case"skip":u()}},e.setScript=function(t){t&&(a=t)},e.set=function(t){e.setScript(t)},e.setSteps=function(t){e.setScript(t)},e.run=function(){e.runScript()},e.resume=function(){e.resumeScript()},s()};CanvasRenderingContext2D.prototype.roundRect=function(t,e,n,i,a){return 2*a>n&&(a=n/2),2*a>i&&(a=i/2),this.beginPath(),this.moveTo(t+a,e),this.arcTo(t+n,e,t+n,e+i,a),this.arcTo(t+n,e+i,t,e+i,a),this.arcTo(t,e+i,t,e,a),this.arcTo(t,e,t+n,e,a),
this.closePath(),this},function(t){var e={init:function(e){return this.each(function(){function n(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg",t);for(var i in e)n.setAttribute(i,e[i]);return n}var i={onNextClick:function(){},onSkipClick:function(){},animation_time:800};this.enjoyhint_obj={};var a=this.enjoyhint_obj,r=t(this);t("body"),a.options=jQuery.extend(i,e),a.gcl={chooser:"enjoyhint"},a.cl={enjoy_hint:"enjoyhint",hide:"enjoyhint_hide",disable_events_element:"enjoyhint_disable_events",btn:"enjoyhint_btn",skip_btn:"enjoyhint_skip_btn",close_btn:"enjoyhint_close_btn",next_btn:"enjoyhint_next_btn",main_canvas:"enjoyhint_canvas",main_svg:"enjoyhint_svg",svg_wrapper:"enjoyhint_svg_wrapper",svg_transparent:"enjoyhint_svg_transparent",kinetic_container:"kinetic_container"},a.canvas_size={w:1.4*t(window).width(),h:1.4*t(window).height()};var s="enj_canvas";a.enjoyhint=t("<div>",{"class":a.cl.enjoy_hint+" "+a.cl.svg_transparent}).appendTo(r),a.enjoyhint_svg_wrapper=t("<div>",{"class":a.cl.svg_wrapper+" "+a.cl.svg_transparent}).appendTo(a.enjoyhint),a.$stage_container=t('<div id="'+a.cl.kinetic_container+'">').appendTo(a.enjoyhint),a.$canvas=t('<canvas id="'+s+'" width="'+a.canvas_size.w+'" height="'+a.canvas_size.h+'" class="'+a.cl.main_canvas+'">').appendTo(a.enjoyhint),a.$svg=t('<svg width="'+a.canvas_size.w+'" height="'+a.canvas_size.h+'" class="'+a.cl.main_canvas+" "+a.cl.main_svg+'">').appendTo(a.enjoyhint_svg_wrapper);var o=t(n("defs")),c=t(n("marker",{id:"arrowMarker",viewBox:"0 0 36 21",refX:"21",refY:"10",markerUnits:"strokeWidth",orient:"auto",markerWidth:"16",markerHeight:"12"})),l=t(n("path",{style:"fill:none; stroke:rgb(255,255,255); stroke-width:2",d:"M0,0 c30,11 30,9 0,20"}));o.append(c.append(l)).appendTo(a.$svg),a.kinetic_stage=new Kinetic.Stage({container:a.cl.kinetic_container,width:a.canvas_size.w,height:a.canvas_size.h}),a.layer=new Kinetic.Layer,a.rect=new Kinetic.Rect({fill:"rgba(0,0,0,0.6)",width:a.canvas_size.w,height:a.canvas_size.h});var h=t("<div>",{"class":a.cl.disable_events_element}).appendTo(a.enjoyhint),d=h.clone().appendTo(a.enjoyhint),u=h.clone().appendTo(a.enjoyhint),f=h.clone().appendTo(a.enjoyhint);a.$skip_btn=t("<div>",{"class":a.cl.skip_btn}).appendTo(a.enjoyhint).html("Skip").click(function(t){a.hide(),a.options.onSkipClick()}),a.$next_btn=t("<div>",{"class":a.cl.next_btn}).appendTo(a.enjoyhint).html("Next").click(function(t){a.options.onNextClick()}),a.$close_btn=t("<div>",{"class":a.cl.close_btn}).appendTo(a.enjoyhint).html("").click(function(t){a.hide(),a.options.onSkipClick()}),a.$canvas.mousedown(function(e){t("canvas").css({left:"4000px"});var n=document.elementFromPoint(e.clientX,e.clientY);return t("canvas").css({left:"0px"}),t(n).click(),!1});var g=0,p=130;return a.shape=new Kinetic.Shape({radius:g,center_x:-p,center_y:-p,width:0,height:0,sceneFunc:function(t){var e=this.getContext("2d")._context,n=(this.pos,e.globalCompositeOperation);e.globalCompositeOperation="destination-out",e.beginPath();var i=this.attrs.center_x-Math.round(this.attrs.width/2),a=this.attrs.center_y-Math.round(this.attrs.height/2);e.roundRect(i,a,this.attrs.width,this.attrs.height,this.attrs.radius),e.fillStyle="red",e.fill(),e.globalCompositeOperation=n}}),a.shape.radius=g,a.layer.add(a.rect),a.layer.add(a.shape),a.kinetic_stage.add(a.layer),[a.enjoyhint,h,d,u,f],a.show=function(){a.enjoyhint.removeClass(a.cl.hide)},a.hide=function(){a.enjoyhint.addClass(a.cl.hide);var t=new Kinetic.Tween({node:a.shape,duration:.002,center_x:-p,center_y:-p});t.play()},a.hide(),a.hideNextBtn=function(){a.$next_btn.addClass(a.cl.hide),a.nextBtn="hide"},a.showNextBtn=function(){a.$next_btn.removeClass(a.cl.hide),a.nextBtn="show"},a.hideSkipBtn=function(){a.$skip_btn.addClass(a.cl.hide)},a.showSkipBtn=function(){a.$skip_btn.removeClass(a.cl.hide)},a.renderCircle=function(t){var e=t.r||0,n=t.x||0,i=t.y||0,r=new Kinetic.Tween({node:a.shape,duration:.2,center_x:n,center_y:i,width:2*e,height:2*e,radius:e});r.play();var s=n-e,o=n+e,c=i-e,l=i+e,h=20;return{x:n,y:i,left:s,right:o,top:c,bottom:l,conn:{left:{x:s-h,y:i},right:{x:o+h,y:i},top:{x:n,y:c-h},bottom:{x:n,y:l+h}}}},a.renderRect=function(t){var e=t.r||0,n=t.x||0,i=t.y||0,r=t.w||0,s=t.h||0,o=20,c=new Kinetic.Tween({node:a.shape,duration:.2,center_x:n,center_y:i,width:r,height:s,radius:e});c.play();var l=Math.round(r/2),h=Math.round(s/2),d=n-l,u=n+l,f=i-h,g=i+h;return{x:n,y:i,left:d,right:u,top:f,bottom:g,conn:{left:{x:d-o,y:i},right:{x:u+o,y:i},top:{x:n,y:f-o},bottom:{x:n,y:g+o}}}},a.renderLabel=function(e){var n=e.x||0,i=e.y||0,r=(e.text||0,a.getLabelElement({x:n,y:i,text:e.text})),s=r.width(),o=r.height(),c=r.offset().left,l=r.offset().left+s,h=r.offset().top-t(document).scrollTop(),d=r.offset().top+o,u=10,f={x:c-u,y:h+Math.round(o/2)},g={x:l+u,y:h+Math.round(o/2)},p={x:c+Math.round(s/2),y:h-u},m={x:c+Math.round(s/2),y:d+u};return r.detach(),setTimeout(function(){t("#enjoyhint_label").remove(),r.appendTo(a.enjoyhint)},a.options.animation_time/2),{label:r,left:c,right:l,top:h,bottom:d,conn:{left:f,right:g,top:p,bottom:m}}},a.renderArrow=function(e){var i=e.x_from||0,r=e.y_from||0,s=e.x_to||0,o=e.y_to||0,c=e.by_top_side,l=0,h=0;c?r>=o?(h=o,l=i):(h=r,l=s):r>=o?(h=r,l=s):(h=o,l=i),e.text||"",a.enjoyhint.addClass(a.cl.svg_transparent),setTimeout(function(){t("#enjoyhint_arrpw_line").remove();var e="M"+i+","+r+" Q"+l+","+h+" "+s+","+o;a.$svg.append(n("path",{style:"fill:none; stroke:rgb(255,255,255); stroke-width:3","marker-end":"url(#arrowMarker)",d:e,id:"enjoyhint_arrpw_line"})),a.enjoyhint.removeClass(a.cl.svg_transparent)},a.options.animation_time/2)},a.getLabelElement=function(e){return t("<div>",{"class":"enjoy_hint_label",id:"enjoyhint_label"}).css({top:e.y+"px",left:e.x+"px"}).html(e.text).appendTo(a.enjoyhint)},a.disableEventsNearRect=function(t){h.css({top:"0",left:"0"}).height(t.top),d.css({top:t.bottom+"px",left:"0"}),u.css({top:"0",left:"0px"}).width(t.left),f.css({top:"0",left:t.right+"px"})},a.renderLabelWithShape=function(t){function e(t,e,n){R=t,N=e,L=n}function n(t,n,i,a,r){var s=[];s=$?t:H?n:U?i:E?a:r,s&&e(s[0],s[1],s[2])}var i=t.shape||"rect",r={},s=0,o=0,c={top:t.top||0,bottom:t.bottom||0,left:t.left||0,right:t.right||0};switch(i){case"circle":s=o=t.radius;var l={top:t.center_y-o+c.top,bottom:t.center_y+o-c.bottom,left:t.center_x-s+c.left,right:t.center_x+s-c.right},h=l.right-l.left,d=l.bottom-l.top;t.radius=Math.round(Math.min(h,d)/2),s=o=Math.round(t.radius/2);var u=Math.round(h/2),f=Math.round(d/2);t.center_x=l.left+u,t.center_y=l.top+f,r=a.renderCircle({x:t.center_x,y:t.center_y,r:t.radius});break;case"rect":s=Math.round(t.width/2),o=Math.round(t.height/2);var l={top:t.center_y-o+c.top,bottom:t.center_y+o-c.bottom,left:t.center_x-s+c.left,right:t.center_x+s-c.right};t.width=l.right-l.left,t.height=l.bottom-l.top,s=Math.round(t.width/2),o=Math.round(t.height/2),t.center_x=l.left+s,t.center_y=l.top+o,r=a.renderRect({x:t.center_x,y:t.center_y,w:t.width,h:t.height,r:t.radius})}var g={w:a.enjoyhint.width(),h:a.enjoyhint.height()},p=a.getLabelElement({x:0,y:0,text:t.text}),m=p.outerWidth(),v=p.outerHeight();p.remove();var _=t.center_y-o,y=g.h-(t.center_y+o),b=t.center_x-s,S=g.w-(t.center_x+s),x=g.w-t.center_x<t.center_x?"left":"right",w=g.h-t.center_y<t.center_y?"top":"bottom",C=150,T=40,K=C+m+T,D=C+v+T,k=s+C,F=o+C,P="left"==x?t.center_x-k-m:t.center_x+k,M="top"==w?t.center_y-F-v:t.center_y+F;D>_&&D>y&&(M=t.center_y+T),K>b&&K>S&&(P=t.center_x);var A=a.renderLabel({x:P,y:M,text:t.text});a.$next_btn.css({left:P,top:M+v+20});var I=P+a.$next_btn.width()+10;"hide"==a.nextBtn&&(I=P),a.$skip_btn.css({left:I,top:M+v+20}),a.$close_btn.css({right:10,top:10}),a.disableEventsNearRect({top:r.top,bottom:r.bottom,left:r.left,right:r.right});var L=!1,R="left",N="left",G=A.left<=r.x&&A.right>=r.x,j=A.right<r.x,$=(A.left>r.x,A.right<r.left,A.left>r.right,A.bottom<r.top),O=A.top>r.bottom,U=A.bottom>=r.y&&A.top<=r.y,H=A.bottom<=r.y&&!$,E=A.top>=r.y&&!O;if(G)if($)e("bottom","top","top");else{if(!O)return;e("top","bottom","bottom")}else j?n(["right","top","top"],["bottom","left","bottom"],["right","left","top"],["top","left","top"],["right","bottom","bottom"]):n(["left","top","top"],["bottom","right","bottom"],["left","right","top"],["top","right","top"],["left","bottom","bottom"]);var Y=A.conn[R],W=r.conn[N],B="top"==L;a.renderArrow({x_from:Y.x,y_from:Y.y,x_to:W.x,y_to:W.y,by_top_side:B})},a.clear=function(){a.ctx.clearRect(0,0,3e3,2e3)},this})},set:function(t){return this.each(function(){this.enjoyhint_obj.setValue(t)}),this},show:function(){return this.each(function(){this.enjoyhint_obj.show()}),this},hide:function(){return this.each(function(){this.enjoyhint_obj.hide()}),this},hide_next:function(){return this.each(function(){this.enjoyhint_obj.hideNextBtn()}),this},show_next:function(){return this.each(function(){this.enjoyhint_obj.showNextBtn()}),this},hide_skip:function(){return this.each(function(){this.enjoyhint_obj.hideSkipBtn()}),this},show_skip:function(){return this.each(function(){this.enjoyhint_obj.showSkipBtn()}),this},render_circle:function(t,e,n){return this.each(function(){this.enjoyhint_obj.renderCircle(t,e,n)}),this},render_label:function(t,e,n){return this.each(function(){this.enjoyhint_obj.renderLabel(t,e,n)}),this},render_label_with_shape:function(t){return this.each(function(){this.enjoyhint_obj.renderLabelWithShape(t)}),this},clear:function(){return this.each(function(){this.enjoyhint_obj.clear()}),this},close:function(t){return this.each(function(){this.enjoyhint_obj.closePopdown()}),this}};t.fn.enjoyhint=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?(t.error("Method "+n+" does not exist on $.numinput"),this):e.init.apply(this,arguments)}}(window.jQuery);var Kinetic={};!function(t){var e=Math.PI/180;Kinetic={version:"5.1.0",stages:[],idCounter:0,ids:{},names:{},shapes:{},listenClickTap:!1,inDblClickWindow:!1,enableTrace:!1,traceArrMax:100,dblClickWindow:400,pixelRatio:void 0,dragDistance:0,angleDeg:!0,UA:function(){var e=t.navigator&&t.navigator.userAgent||"",n=e.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[],a=!!e.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i);return{browser:i[1]||"",version:i[2]||"0",mobile:a}}(),Filters:{},Node:function(t){this._init(t)},Shape:function(t){this.__init(t)},Container:function(t){this.__init(t)},Stage:function(t){this.___init(t)},BaseLayer:function(t){this.___init(t)},Layer:function(t){this.____init(t)},FastLayer:function(t){this.____init(t)},Group:function(t){this.___init(t)},isDragging:function(){var t=Kinetic.DD;return!!t&&t.isDragging},isDragReady:function(){var t=Kinetic.DD;return!!t&&!!t.node},_addId:function(t,e){void 0!==e&&(this.ids[e]=t)},_removeId:function(t){void 0!==t&&delete this.ids[t]},_addName:function(t,e){void 0!==e&&(void 0===this.names[e]&&(this.names[e]=[]),this.names[e].push(t))},_removeName:function(t,e){if(void 0!==t){var n=this.names[t];if(void 0!==n){for(var i=0;i<n.length;i++){var a=n[i];a._id===e&&n.splice(i,1)}0===n.length&&delete this.names[t]}}},getAngle:function(t){return this.angleDeg?t*e:t}}}(this),function(t,e){if("object"==typeof exports){var n=require("canvas"),i=require("jsdom").jsdom,a=i("<!DOCTYPE html><html><head></head><body></body></html>"),r=e();return Kinetic.document=a,Kinetic.window=Kinetic.document.createWindow(),Kinetic.window.Image=n.Image,Kinetic.root=t,Kinetic._nodeCanvas=n,void(module.exports=r)}"function"==typeof define&&define.amd&&define(e),Kinetic.document=document,Kinetic.window=window,Kinetic.root=t}((0,eval)("this"),function(){return Kinetic}),function(){Kinetic.Collection=function(){var t=[].slice.call(arguments),e=t.length,n=0;for(this.length=e;e>n;n++)this[n]=t[n];return this},Kinetic.Collection.prototype=[],Kinetic.Collection.prototype.each=function(t){for(var e=0;e<this.length;e++)t(this[e],e)},Kinetic.Collection.prototype.toArray=function(){var t,e=[],n=this.length;for(t=0;n>t;t++)e.push(this[t]);return e},Kinetic.Collection.toCollection=function(t){var e,n=new Kinetic.Collection,i=t.length;for(e=0;i>e;e++)n.push(t[e]);return n},Kinetic.Collection._mapMethod=function(t){Kinetic.Collection.prototype[t]=function(){var e,n=this.length,i=[].slice.call(arguments);for(e=0;n>e;e++)this[e][t].apply(this[e],i);return this}},Kinetic.Collection.mapMethods=function(t){var e=t.prototype;for(var n in e)Kinetic.Collection._mapMethod(n)},Kinetic.Transform=function(t){this.m=t&&t.slice()||[1,0,0,1,0,0]},Kinetic.Transform.prototype={copy:function(){return new Kinetic.Transform(this.m)},point:function(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}},translate:function(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this},scale:function(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.m[0]*e+this.m[2]*n,a=this.m[1]*e+this.m[3]*n,r=this.m[0]*-n+this.m[2]*e,s=this.m[1]*-n+this.m[3]*e;return this.m[0]=i,this.m[1]=a,this.m[2]=r,this.m[3]=s,this},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},skew:function(t,e){var n=this.m[0]+this.m[2]*e,i=this.m[1]+this.m[3]*e,a=this.m[2]+this.m[0]*t,r=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=i,this.m[2]=a,this.m[3]=r,this},multiply:function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],i=this.m[0]*t.m[2]+this.m[2]*t.m[3],a=this.m[1]*t.m[2]+this.m[3]*t.m[3],r=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],s=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=a,this.m[4]=r,this.m[5]=s,this},invert:function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,i=-this.m[2]*t,a=this.m[0]*t,r=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),s=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=i,this.m[3]=a,this.m[4]=r,this.m[5]=s,this},getMatrix:function(){return this.m},setAbsolutePosition:function(t,e){var n=this.m[0],i=this.m[1],a=this.m[2],r=this.m[3],s=this.m[4],o=this.m[5],c=(n*(e-o)-i*(t-s))/(n*r-i*a),l=(t-s-a*c)/n;return this.translate(l,c)}};var t="2d",e="[object Array]",n="[object Number]",i="[object String]",a=Math.PI/180,r=180/Math.PI,s="#",o="",c="0",l="Kinetic warning: ",h="Kinetic error: ",d="rgb(",u={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},f=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;Kinetic.Util={_isElement:function(t){return!(!t||1!=t.nodeType)},_isFunction:function(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isObject:function(t){return!!t&&t.constructor==Object},_isArray:function(t){return Object.prototype.toString.call(t)==e},_isNumber:function(t){return Object.prototype.toString.call(t)==n},_isString:function(t){return Object.prototype.toString.call(t)==i},_throttle:function(t,e,n){var i,a,r,s=null,o=0;n||(n={});var c=function(){o=n.leading===!1?0:(new Date).getTime(),s=null,r=t.apply(i,a),i=a=null};return function(){var l=(new Date).getTime();o||n.leading!==!1||(o=l);var h=e-(l-o);return i=this,a=arguments,0>=h?(clearTimeout(s),s=null,o=l,r=t.apply(i,a),i=a=null):s||n.trailing===!1||(s=setTimeout(c,h)),r}},_hasMethods:function(t){var e,n=[];for(e in t)this._isFunction(t[e])&&n.push(e);return n.length>0},createCanvasElement:function(){var t=Kinetic.document.createElement("canvas");return t.style=t.style||{},t},isBrowser:function(){return"object"!=typeof exports},_isInDocument:function(t){for(;t=t.parentNode;)if(t==Kinetic.document)return!0;return!1},_simplifyArray:function(t){var e,n,i=[],a=t.length,r=Kinetic.Util;for(e=0;a>e;e++)n=t[e],r._isNumber(n)?n=Math.round(1e3*n)/1e3:r._isString(n)||(n=n.toString()),i.push(n);return i},_getImage:function(e,n){var i,a;if(e)if(this._isElement(e))n(e);else if(this._isString(e))i=new Kinetic.window.Image,i.onload=function(){n(i)},i.src=e;else if(e.data){a=Kinetic.Util.createCanvasElement(),a.width=e.width,a.height=e.height;var r=a.getContext(t);r.putImageData(e,0,0),this._getImage(a.toDataURL(),n)}else n(null);else n(null)},_getRGBAString:function(t){var e=t.red||0,n=t.green||0,i=t.blue||0,a=t.alpha||1;return["rgba(",e,",",n,",",i,",",a,")"].join(o)},_rgbToHex:function(t,e,n){return((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)},_hexToRgb:function(t){t=t.replace(s,o);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor:function(){for(var t=(16777215*Math.random()<<0).toString(16);t.length<6;)t=c+t;return s+t},get:function(t,e){return void 0===t?e:t},getRGB:function(t){var e;return t in u?(e=u[t],{r:e[0],g:e[1],b:e[2]}):t[0]===s?this._hexToRgb(t.substring(1)):t.substr(0,4)===d?(e=f.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},_merge:function(t,e){var n=this._clone(e);for(var i in t)n[i]=this._isObject(t[i])?this._merge(t[i],n[i]):t[i];return n},cloneObject:function(t){var e={};for(var n in t)e[n]=this._isObject(t[n])?this.cloneObject(t[n]):this._isArray(t[n])?this.cloneArray(t[n]):t[n];return e},cloneArray:function(t){return t.slice(0)},_degToRad:function(t){return t*a},_radToDeg:function(t){return t*r},_capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},error:function(t){throw new Error(h+t)},warn:function(t){Kinetic.root.console&&console.warn&&console.warn(l+t)},extend:function(t,e){for(var n in e.prototype)n in t.prototype||(t.prototype[n]=e.prototype[n])},addMethods:function(t,e){var n;for(n in e)t.prototype[n]=e[n]},_getControlPoints:function(t,e,n,i,a,r,s){var o=Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2)),c=Math.sqrt(Math.pow(a-n,2)+Math.pow(r-i,2)),l=s*o/(o+c),h=s*c/(o+c),d=n-l*(a-t),u=i-l*(r-e),f=n+h*(a-t),g=i+h*(r-e);return[d,u,f,g]},_expandPoints:function(t,e){var n,i,a=t.length,r=[];for(n=2;a-2>n;n+=2)i=Kinetic.Util._getControlPoints(t[n-2],t[n-1],t[n],t[n+1],t[n+2],t[n+3],e),r.push(i[0]),r.push(i[1]),r.push(t[n]),r.push(t[n+1]),r.push(i[2]),r.push(i[3]);return r},_removeLastLetter:function(t){return t.substring(0,t.length-1)}}}(),function(){var t=Kinetic.Util.createCanvasElement(),e=t.getContext("2d"),n=Kinetic.UA.mobile?function(){var t=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/n}():1;Kinetic.Canvas=function(t){this.init(t)},Kinetic.Canvas.prototype={init:function(t){t=t||{};var e=t.pixelRatio||Kinetic.pixelRatio||n;this.pixelRatio=e,this._canvas=Kinetic.Util.createCanvasElement(),this._canvas.style.padding=0,this._canvas.style.margin=0,this._canvas.style.border=0,this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top=0,this._canvas.style.left=0},getContext:function(){return this.context},getPixelRatio:function(){return this.pixelRatio},setPixelRatio:function(t){this.pixelRatio=t,this.setSize(this.getWidth(),this.getHeight())},setWidth:function(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px"},setHeight:function(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px"},getWidth:function(){return this.width},getHeight:function(){return this.height},setSize:function(t,e){this.setWidth(t),this.setHeight(e)},toDataURL:function(t,e){try{return this._canvas.toDataURL(t,e)}catch(n){try{return this._canvas.toDataURL()}catch(i){return Kinetic.Util.warn("Unable to get data URL. "+i.message),""}}}},Kinetic.SceneCanvas=function(t){t=t||{};var e=t.width||0,n=t.height||0;Kinetic.Canvas.call(this,t),this.context=new Kinetic.SceneContext(this),this.setSize(e,n)},Kinetic.SceneCanvas.prototype={setWidth:function(t){var e=this.pixelRatio,n=this.getContext()._context;Kinetic.Canvas.prototype.setWidth.call(this,t),n.scale(e,e)},setHeight:function(t){var e=this.pixelRatio,n=this.getContext()._context;Kinetic.Canvas.prototype.setHeight.call(this,t),n.scale(e,e)}},Kinetic.Util.extend(Kinetic.SceneCanvas,Kinetic.Canvas),Kinetic.HitCanvas=function(t){t=t||{};var e=t.width||0,n=t.height||0;Kinetic.Canvas.call(this,t),this.context=new Kinetic.HitContext(this),this.setSize(e,n)},Kinetic.Util.extend(Kinetic.HitCanvas,Kinetic.Canvas)}(),function(){var t=",",e="(",n=")",i="([",a="])",r=";",s="()",o="=",c=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];Kinetic.Context=function(t){this.init(t)},Kinetic.Context.prototype={init:function(t){this.canvas=t,this._context=t._canvas.getContext("2d"),Kinetic.enableTrace&&(this.traceArr=[],this._enableTrace())},fillShape:function(t){t.getFillEnabled()&&this._fill(t)},strokeShape:function(t){t.getStrokeEnabled()&&this._stroke(t)},fillStrokeShape:function(t){var e=t.getFillEnabled();e&&this._fill(t),t.getStrokeEnabled()&&this._stroke(t)},getTrace:function(c){var l,h,d,u,f=this.traceArr,g=f.length,p="";for(l=0;g>l;l++)h=f[l],d=h.method,d?(u=h.args,p+=d,p+=c?s:Kinetic.Util._isArray(u[0])?i+u.join(t)+a:e+u.join(t)+n):(p+=h.property,c||(p+=o+h.val)),p+=r;return p},clearTrace:function(){this.traceArr=[]},_trace:function(t){var e,n=this.traceArr;n.push(t),e=n.length,e>=Kinetic.traceArrMax&&n.shift()},reset:function(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)},getCanvas:function(){return this.canvas},clear:function(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth(),e.getHeight())},_applyLineCap:function(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)},_applyOpacity:function(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)},_applyLineJoin:function(t){var e=t.getLineJoin();e&&this.setAttr("lineJoin",e)},setAttr:function(t,e){this._context[t]=e},arc:function(){var t=arguments;this._context.arc(t[0],t[1],t[2],t[3],t[4],t[5])},beginPath:function(){this._context.beginPath()},bezierCurveTo:function(){var t=arguments;this._context.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},clearRect:function(){var t=arguments;this._context.clearRect(t[0],t[1],t[2],t[3])},clip:function(){this._context.clip()},closePath:function(){this._context.closePath()},createImageData:function(){var t=arguments;return 2===t.length?this._context.createImageData(t[0],t[1]):1===t.length?this._context.createImageData(t[0]):void 0},createLinearGradient:function(){var t=arguments;return this._context.createLinearGradient(t[0],t[1],t[2],t[3])},createPattern:function(){var t=arguments;return this._context.createPattern(t[0],t[1])},createRadialGradient:function(){var t=arguments;return this._context.createRadialGradient(t[0],t[1],t[2],t[3],t[4],t[5])},drawImage:function(){var t=arguments,e=this._context;3===t.length?e.drawImage(t[0],t[1],t[2]):5===t.length?e.drawImage(t[0],t[1],t[2],t[3],t[4]):9===t.length&&e.drawImage(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},fill:function(){this._context.fill()},fillText:function(){var t=arguments;this._context.fillText(t[0],t[1],t[2])},getImageData:function(){var t=arguments;return this._context.getImageData(t[0],t[1],t[2],t[3])},lineTo:function(){var t=arguments;this._context.lineTo(t[0],t[1])},moveTo:function(){var t=arguments;this._context.moveTo(t[0],t[1])},rect:function(){var t=arguments;this._context.rect(t[0],t[1],t[2],t[3])},putImageData:function(){var t=arguments;this._context.putImageData(t[0],t[1],t[2])},quadraticCurveTo:function(){var t=arguments;this._context.quadraticCurveTo(t[0],t[1],t[2],t[3])},restore:function(){this._context.restore()},rotate:function(){var t=arguments;this._context.rotate(t[0])},save:function(){this._context.save()},scale:function(){var t=arguments;this._context.scale(t[0],t[1])},setLineDash:function(){var t=arguments,e=this._context;this._context.setLineDash?e.setLineDash(t[0]):"mozDash"in e?e.mozDash=t[0]:"webkitLineDash"in e&&(e.webkitLineDash=t[0])},setTransform:function(){var t=arguments;this._context.setTransform(t[0],t[1],t[2],t[3],t[4],t[5])},stroke:function(){this._context.stroke()},strokeText:function(){var t=arguments;this._context.strokeText(t[0],t[1],t[2])},transform:function(){var t=arguments;this._context.transform(t[0],t[1],t[2],t[3],t[4],t[5])},translate:function(){var t=arguments;this._context.translate(t[0],t[1])},_enableTrace:function(){var t,e,n=this,i=c.length,a=Kinetic.Util._simplifyArray,r=this.setAttr,s=function(t){var i,r=n[t];n[t]=function(){return e=a(Array.prototype.slice.call(arguments,0)),i=r.apply(n,arguments),n._trace({method:t,args:e}),i}};for(t=0;i>t;t++)s(c[t]);n.setAttr=function(){r.apply(n,arguments),n._trace({property:arguments[0],val:arguments[1]})}}},Kinetic.SceneContext=function(t){Kinetic.Context.call(this,t)},Kinetic.SceneContext.prototype={_fillColor:function(t){var e=t.fill()||Kinetic.Util._getRGBAString({red:t.fillRed(),green:t.fillGreen(),blue:t.fillBlue(),alpha:t.fillAlpha()});this.setAttr("fillStyle",e),t._fillFunc(this)},_fillPattern:function(t){var e=t.getFillPatternImage(),n=t.getFillPatternX(),i=t.getFillPatternY(),a=t.getFillPatternScale(),r=Kinetic.getAngle(t.getFillPatternRotation()),s=t.getFillPatternOffset(),o=t.getFillPatternRepeat();(n||i)&&this.translate(n||0,i||0),r&&this.rotate(r),a&&this.scale(a.x,a.y),s&&this.translate(-1*s.x,-1*s.y),this.setAttr("fillStyle",this.createPattern(e,o||"repeat")),this.fill()},_fillLinearGradient:function(t){var e=t.getFillLinearGradientStartPoint(),n=t.getFillLinearGradientEndPoint(),i=t.getFillLinearGradientColorStops(),a=this.createLinearGradient(e.x,e.y,n.x,n.y);if(i){for(var r=0;r<i.length;r+=2)a.addColorStop(i[r],i[r+1]);this.setAttr("fillStyle",a),this.fill()}},_fillRadialGradient:function(t){for(var e=t.getFillRadialGradientStartPoint(),n=t.getFillRadialGradientEndPoint(),i=t.getFillRadialGradientStartRadius(),a=t.getFillRadialGradientEndRadius(),r=t.getFillRadialGradientColorStops(),s=this.createRadialGradient(e.x,e.y,i,n.x,n.y,a),o=0;o<r.length;o+=2)s.addColorStop(r[o],r[o+1]);this.setAttr("fillStyle",s),this.fill()},_fill:function(t){var e=t.fill()||t.fillRed()||t.fillGreen()||t.fillBlue(),n=t.getFillPatternImage(),i=t.getFillLinearGradientColorStops(),a=t.getFillRadialGradientColorStops(),r=t.getFillPriority();e&&"color"===r?this._fillColor(t):n&&"pattern"===r?this._fillPattern(t):i&&"linear-gradient"===r?this._fillLinearGradient(t):a&&"radial-gradient"===r?this._fillRadialGradient(t):e?this._fillColor(t):n?this._fillPattern(t):i?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)},_stroke:function(t){var e=t.dash(),n=t.getStrokeScaleEnabled();t.hasStroke()&&(n||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(t),e&&t.dashEnabled()&&this.setLineDash(e),this.setAttr("lineWidth",t.strokeWidth()),this.setAttr("strokeStyle",t.stroke()||Kinetic.Util._getRGBAString({red:t.strokeRed(),green:t.strokeGreen(),blue:t.strokeBlue(),alpha:t.strokeAlpha()})),t._strokeFunc(this),n||this.restore())},_applyShadow:function(t){var e=Kinetic.Util,n=t.getAbsoluteOpacity(),i=e.get(t.getShadowColor(),"black"),a=e.get(t.getShadowBlur(),5),r=e.get(t.getShadowOpacity(),1),s=e.get(t.getShadowOffset(),{x:0,y:0});r&&this.setAttr("globalAlpha",r*n),this.setAttr("shadowColor",i),this.setAttr("shadowBlur",a),this.setAttr("shadowOffsetX",s.x),this.setAttr("shadowOffsetY",s.y)}},Kinetic.Util.extend(Kinetic.SceneContext,Kinetic.Context),Kinetic.HitContext=function(t){Kinetic.Context.call(this,t)},Kinetic.HitContext.prototype={_fill:function(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()},_stroke:function(t){t.hasStroke()&&(this._applyLineCap(t),this.setAttr("lineWidth",t.strokeWidth()),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this))}},Kinetic.Util.extend(Kinetic.HitContext,Kinetic.Context)}(),function(){var t="get",e="set";Kinetic.Factory={addGetterSetter:function(t,e,n,i,a){this.addGetter(t,e,n),this.addSetter(t,e,i,a),this.addOverloadedGetterSetter(t,e)},addGetter:function(e,n,i){var a=t+Kinetic.Util._capitalize(n);e.prototype[a]=function(){var t=this.attrs[n];return void 0===t?i:t}},addSetter:function(t,n,i,a){var r=e+Kinetic.Util._capitalize(n);t.prototype[r]=function(t){return i&&(t=i.call(this,t)),this._setAttr(n,t),a&&a.call(this),this}},addComponentsGetterSetter:function(n,i,a,r,s){var o,c,l=a.length,h=Kinetic.Util._capitalize,d=t+h(i),u=e+h(i);n.prototype[d]=function(){var t={};for(o=0;l>o;o++)c=a[o],t[c]=this.getAttr(i+h(c));return t},n.prototype[u]=function(t){var e,n=this.attrs[i];r&&(t=r.call(this,t));for(e in t)this._setAttr(i+h(e),t[e]);return this._fireChangeEvent(i,n,t),s&&s.call(this),this},this.addOverloadedGetterSetter(n,i)},addOverloadedGetterSetter:function(n,i){var a=Kinetic.Util._capitalize(i),r=e+a,s=t+a;n.prototype[i]=function(){return arguments.length?(this[r](arguments[0]),this):this[s]()}},backCompat:function(t,e){var n;for(n in e)t.prototype[n]=t.prototype[e[n]]},afterSetFilter:function(){this._filterUpToDate=!1}},Kinetic.Validators={RGBComponent:function(t){return t>255?255:0>t?0:Math.round(t)},alphaComponent:function(t){return t>1?1:1e-4>t?1e-4:t}}}(),function(){var t="absoluteOpacity",e="absoluteTransform",n="Change",i="children",a=".",r="",s="get",o="id",c="kinetic",l="listening",h="mouseenter",d="mouseleave",u="name",f="set",g="Shape",p=" ",m="stage",v="transform",_="Stage",y="visible",b=["id"],S=["xChange.kinetic","yChange.kinetic","scaleXChange.kinetic","scaleYChange.kinetic","skewXChange.kinetic","skewYChange.kinetic","rotationChange.kinetic","offsetXChange.kinetic","offsetYChange.kinetic","transformsEnabledChange.kinetic"].join(p);Kinetic.Util.addMethods(Kinetic.Node,{_init:function(n){var i=this;this._id=Kinetic.idCounter++,this.eventListeners={},this.attrs={},this._cache={},this._filterUpToDate=!1,this.setAttrs(n),this.on(S,function(){this._clearCache(v),i._clearSelfAndDescendantCache(e)}),this.on("visibleChange.kinetic",function(){i._clearSelfAndDescendantCache(y)}),this.on("listeningChange.kinetic",function(){i._clearSelfAndDescendantCache(l)}),this.on("opacityChange.kinetic",function(){i._clearSelfAndDescendantCache(t)})},_clearCache:function(t){t?delete this._cache[t]:this._cache={}},_getCache:function(t,e){var n=this._cache[t];return void 0===n&&(this._cache[t]=e.call(this)),this._cache[t]},_clearSelfAndDescendantCache:function(t){this._clearCache(t),this.children&&this.getChildren().each(function(e){e._clearSelfAndDescendantCache(t)})},clearCache:function(){return delete this._cache.canvas,this._filterUpToDate=!1,this},cache:function(t){var e=t||{},n=e.x||0,i=e.y||0,a=e.width||this.width(),r=e.height||this.height(),s=e.drawBorder||!1;if(this.getLayer(),0===a||0===r)return void Kinetic.Util.warn("Width or height of caching configuration equals 0. Cache is ignored.");var o=new Kinetic.SceneCanvas({pixelRatio:1,width:a,height:r}),c=new Kinetic.SceneCanvas({pixelRatio:1,width:a,height:r}),l=new Kinetic.HitCanvas({width:a,height:r}),h=(this.transformsEnabled(),this.x(),this.y(),o.getContext()),d=l.getContext();return this.clearCache(),h.save(),d.save(),s&&(h.save(),h.beginPath(),h.rect(0,0,a,r),h.closePath(),h.setAttr("strokeStyle","red"),h.setAttr("lineWidth",5),h.stroke(),h.restore()),h.translate(-1*n,-1*i),d.translate(-1*n,-1*i),"Shape"===this.nodeType&&(h.translate(-1*this.x(),-1*this.y()),d.translate(-1*this.x(),-1*this.y())),this.drawScene(o,this),this.drawHit(l,this),h.restore(),
d.restore(),this._cache.canvas={scene:o,filter:c,hit:l},this},_drawCachedSceneCanvas:function(t){t.save(),this.getLayer()._applyTransform(this,t),t.drawImage(this._getCachedSceneCanvas()._canvas,0,0),t.restore()},_getCachedSceneCanvas:function(){var t,e,n,i,a=this.filters(),r=this._cache.canvas,s=r.scene,o=r.filter,c=o.getContext();if(a){if(!this._filterUpToDate){try{for(t=a.length,c.clear(),c.drawImage(s._canvas,0,0),e=c.getImageData(0,0,o.getWidth(),o.getHeight()),n=0;t>n;n++)i=a[n],i.call(this,e),c.putImageData(e,0,0)}catch(l){Kinetic.Util.warn("Unable to apply filter. "+l.message)}this._filterUpToDate=!0}return o}return s},_drawCachedHitCanvas:function(t){var e=this._cache.canvas,n=e.hit;t.save(),this.getLayer()._applyTransform(this,t),t.drawImage(n._canvas,0,0),t.restore()},on:function(t,e){var n,i,s,o,c,l=t.split(p),h=l.length;for(n=0;h>n;n++)i=l[n],s=i.split(a),o=s[0],c=s[1]||r,this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:c,handler:e});return this},off:function(t){var e,n,i,r,s,o,c=t.split(p),l=c.length;for(e=0;l>e;e++)if(i=c[e],r=i.split(a),s=r[0],o=r[1],s)this.eventListeners[s]&&this._off(s,o);else for(n in this.eventListeners)this._off(n,o);return this},dispatchEvent:function(t){var e={target:this,type:t.type,evt:t};this.fire(t.type,e)},addEventListener:function(t,e){this.on(t,function(t){e.call(this,t.evt)})},remove:function(){var n=this.getParent();return n&&n.children&&(n.children.splice(this.index,1),n._setChildrenIndices(),delete this.parent),this._clearSelfAndDescendantCache(m),this._clearSelfAndDescendantCache(e),this._clearSelfAndDescendantCache(y),this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(t),this},destroy:function(){Kinetic._removeId(this.getId()),Kinetic._removeName(this.getName(),this._id),this.remove()},getAttr:function(t){var e=s+Kinetic.Util._capitalize(t);return Kinetic.Util._isFunction(this[e])?this[e]():this.attrs[t]},getAncestors:function(){for(var t=this.getParent(),e=new Kinetic.Collection;t;)e.push(t),t=t.getParent();return e},getAttrs:function(){return this.attrs||{}},setAttrs:function(t){var e,n;if(t)for(e in t)e===i||(n=f+Kinetic.Util._capitalize(e),Kinetic.Util._isFunction(this[n])?this[n](t[e]):this._setAttr(e,t[e]));return this},isListening:function(){return this._getCache(l,this._isListening)},_isListening:function(){var t=this.getListening(),e=this.getParent();return"inherit"===t?!e||e.isListening():t},isVisible:function(){return this._getCache(y,this._isVisible)},_isVisible:function(){var t=this.getVisible(),e=this.getParent();return"inherit"===t?!e||e.isVisible():t},shouldDrawHit:function(){var t=this.getLayer();return t&&t.hitGraphEnabled()&&this.isListening()&&this.isVisible()&&!Kinetic.isDragging()},show:function(){return this.setVisible(!0),this},hide:function(){return this.setVisible(!1),this},getZIndex:function(){return this.index||0},getAbsoluteZIndex:function(){function t(c){for(e=[],n=c.length,i=0;n>i;i++)a=c[i],o++,a.nodeType!==g&&(e=e.concat(a.getChildren().toArray())),a._id===s._id&&(i=n);e.length>0&&e[0].getDepth()<=r&&t(e)}var e,n,i,a,r=this.getDepth(),s=this,o=0;return s.nodeType!==_&&t(s.getStage().getChildren()),o},getDepth:function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t},setPosition:function(t){return this.setX(t.x),this.setY(t.y),this},getPosition:function(){return{x:this.getX(),y:this.getY()}},getAbsolutePosition:function(){var t=this.getAbsoluteTransform().getMatrix(),e=new Kinetic.Transform,n=this.offset();return e.m=t.slice(),e.translate(n.x,n.y),e.getTranslation()},setAbsolutePosition:function(t){var e,n=this._clearTransform();return this.attrs.x=n.x,this.attrs.y=n.y,delete n.x,delete n.y,e=this.getAbsoluteTransform(),e.invert(),e.translate(t.x,t.y),t={x:this.attrs.x+e.getTranslation().x,y:this.attrs.y+e.getTranslation().y},this.setPosition({x:t.x,y:t.y}),this._setTransform(n),this},_setTransform:function(t){var n;for(n in t)this.attrs[n]=t[n];this._clearCache(v),this._clearSelfAndDescendantCache(e)},_clearTransform:function(){var t={x:this.getX(),y:this.getY(),rotation:this.getRotation(),scaleX:this.getScaleX(),scaleY:this.getScaleY(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),skewX:this.getSkewX(),skewY:this.getSkewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,this._clearCache(v),this._clearSelfAndDescendantCache(e),t},move:function(t){var e=t.x,n=t.y,i=this.getX(),a=this.getY();return void 0!==e&&(i+=e),void 0!==n&&(a+=n),this.setPosition({x:i,y:a}),this},_eachAncestorReverse:function(t,e){var n,i,a=[],r=this.getParent();if(e&&e._id===this._id)return t(this),!0;for(a.unshift(this);r&&(!e||r._id!==e._id);)a.unshift(r),r=r.parent;for(n=a.length,i=0;n>i;i++)t(a[i])},rotate:function(t){return this.setRotation(this.getRotation()+t),this},moveToTop:function(){if(!this.parent)return void Kinetic.Util.warn("Node has no parent. moveToTop function is ignored.");var t=this.index;return this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},moveUp:function(){if(!this.parent)return void Kinetic.Util.warn("Node has no parent. moveUp function is ignored.");var t=this.index,e=this.parent.getChildren().length;return e-1>t&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)},moveDown:function(){if(!this.parent)return void Kinetic.Util.warn("Node has no parent. moveDown function is ignored.");var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)},moveToBottom:function(){if(!this.parent)return void Kinetic.Util.warn("Node has no parent. moveToBottom function is ignored.");var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)},setZIndex:function(t){if(!this.parent)return void Kinetic.Util.warn("Node has no parent. zIndex parameter is ignored.");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this},getAbsoluteOpacity:function(){return this._getCache(t,this._getAbsoluteOpacity)},_getAbsoluteOpacity:function(){var t=this.getOpacity();return this.getParent()&&(t*=this.getParent().getAbsoluteOpacity()),t},moveTo:function(t){return Kinetic.Node.prototype.remove.call(this),t.add(this),this},toObject:function(){var t,e,n,i,a=Kinetic.Util,r={},s=this.getAttrs();r.attrs={};for(t in s)e=s[t],a._isFunction(e)||a._isElement(e)||a._isObject(e)&&a._hasMethods(e)||(n=this[t],delete s[t],i=n?n.call(this):null,s[t]=e,i!==e&&(r.attrs[t]=e));return r.className=this.getClassName(),r},toJSON:function(){return JSON.stringify(this.toObject())},getParent:function(){return this.parent},getLayer:function(){var t=this.getParent();return t?t.getLayer():null},getStage:function(){return this._getCache(m,this._getStage)},_getStage:function(){var t=this.getParent();return t?t.getStage():void 0},fire:function(t,e,n){return n?this._fireAndBubble(t,e||{}):this._fire(t,e||{}),this},getAbsoluteTransform:function(t){return t?this._getAbsoluteTransform(t):this._getCache(e,this._getAbsoluteTransform)},_getAbsoluteTransform:function(t){var e,n,i=new Kinetic.Transform;return this._eachAncestorReverse(function(t){e=t.transformsEnabled(),n=t.getTransform(),"all"===e?i.multiply(n):"position"===e&&i.translate(t.x(),t.y())},t),i},getTransform:function(){return this._getCache(v,this._getTransform)},_getTransform:function(){var t=new Kinetic.Transform,e=this.getX(),n=this.getY(),i=Kinetic.getAngle(this.getRotation()),a=this.getScaleX(),r=this.getScaleY(),s=this.getSkewX(),o=this.getSkewY(),c=this.getOffsetX(),l=this.getOffsetY();return(0!==e||0!==n)&&t.translate(e,n),0!==i&&t.rotate(i),(0!==s||0!==o)&&t.skew(s,o),(1!==a||1!==r)&&t.scale(a,r),(0!==c||0!==l)&&t.translate(-1*c,-1*l),t},clone:function(t){var e,n,i,a,r,s=this.getClassName(),o=Kinetic.Util.cloneObject(this.attrs);for(var l in b){var h=b[l];delete o[h]}for(e in t)o[e]=t[e];var d=new Kinetic[s](o);for(e in this.eventListeners)for(n=this.eventListeners[e],i=n.length,a=0;i>a;a++)r=n[a],r.name.indexOf(c)<0&&(d.eventListeners[e]||(d.eventListeners[e]=[]),d.eventListeners[e].push(r));return d},toDataURL:function(t){t=t||{};var e=t.mimeType||null,n=t.quality||null,i=this.getStage(),a=t.x||0,r=t.y||0,s=new Kinetic.SceneCanvas({width:t.width||this.getWidth()||(i?i.getWidth():0),height:t.height||this.getHeight()||(i?i.getHeight():0),pixelRatio:1}),o=s.getContext();return o.save(),(a||r)&&o.translate(-1*a,-1*r),this.drawScene(s),o.restore(),s.toDataURL(e,n)},toImage:function(t){Kinetic.Util._getImage(this.toDataURL(t),function(e){t.callback(e)})},setSize:function(t){return this.setWidth(t.width),this.setHeight(t.height),this},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getWidth:function(){return this.attrs.width||0},getHeight:function(){return this.attrs.height||0},getClassName:function(){return this.className||this.nodeType},getType:function(){return this.nodeType},getDragDistance:function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Kinetic.dragDistance},_get:function(t){return this.nodeType===t?[this]:[]},_off:function(t,e){var n,i,a=this.eventListeners[t];for(n=0;n<a.length;n++)if(i=a[n].name,!("kinetic"===i&&"kinetic"!==e||e&&i!==e)){if(a.splice(n,1),0===a.length){delete this.eventListeners[t];break}n--}},_fireChangeEvent:function(t,e,i){this._fire(t+n,{oldVal:e,newVal:i})},setId:function(t){var e=this.getId();return Kinetic._removeId(e),Kinetic._addId(this,t),this._setAttr(o,t),this},setName:function(t){var e=this.getName();return Kinetic._removeName(e,this._id),Kinetic._addName(this,t),this._setAttr(u,t),this},setAttr:function(){var t=Array.prototype.slice.call(arguments),e=t[0],n=t[1],i=f+Kinetic.Util._capitalize(e),a=this[i];return Kinetic.Util._isFunction(a)?a.call(this,n):this._setAttr(e,n),this},_setAttr:function(t,e){var n;void 0!==e&&(n=this.attrs[t],this.attrs[t]=e,this._fireChangeEvent(t,n,e))},_setComponentAttr:function(t,e,n){var i;void 0!==n&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,i,n))},_fireAndBubble:function(t,e,n){var i=!0;e&&this.nodeType===g&&(e.target=this),t===h&&n&&this._id===n._id?i=!1:t===d&&n&&this._id===n._id&&(i=!1),i&&(this._fire(t,e),e&&!e.cancelBubble&&this.parent&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n.parent):this._fireAndBubble.call(this.parent,t,e)))},_fire:function(t,e){var n,i=this.eventListeners[t];if(e.type=t,i)for(n=0;n<i.length;n++)i[n].handler.call(this,e)},draw:function(){return this.drawScene(),this.drawHit(),this}}),Kinetic.Node.create=function(t,e){return this._createNode(JSON.parse(t),e)},Kinetic.Node._createNode=function(t,e){var n,i,a,r=Kinetic.Node.prototype.getClassName.call(t),s=t.children;if(e&&(t.attrs.container=e),n=new Kinetic[r](t.attrs),s)for(i=s.length,a=0;i>a;a++)n.add(this._createNode(s[a]));return n},Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"position"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"x",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"y",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"opacity",1),Kinetic.Factory.addGetter(Kinetic.Node,"name"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"name"),Kinetic.Factory.addGetter(Kinetic.Node,"id"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"id"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"rotation",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Node,"scale",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Node,"scaleX",1),Kinetic.Factory.addGetterSetter(Kinetic.Node,"scaleY",1),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Node,"skew",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Node,"skewX",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"skewY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Node,"offset",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Node,"offsetX",0),Kinetic.Factory.addGetterSetter(Kinetic.Node,"offsetY",0),Kinetic.Factory.addSetter(Kinetic.Node,"dragDistance"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"dragDistance"),Kinetic.Factory.addSetter(Kinetic.Node,"width",0),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"width"),Kinetic.Factory.addSetter(Kinetic.Node,"height",0),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"height"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"listening","inherit"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"filters",void 0,function(t){return this._filterUpToDate=!1,t}),Kinetic.Factory.addGetterSetter(Kinetic.Node,"visible","inherit"),Kinetic.Factory.addGetterSetter(Kinetic.Node,"transformsEnabled","all"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"size"),Kinetic.Factory.backCompat(Kinetic.Node,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Kinetic.Collection.mapMethods(Kinetic.Node)}(),function(){Kinetic.Filters.Grayscale=function(t){var e,n,i=t.data,a=i.length;for(e=0;a>e;e+=4)n=.34*i[e]+.5*i[e+1]+.16*i[e+2],i[e]=n,i[e+1]=n,i[e+2]=n}}(),function(){Kinetic.Filters.Brighten=function(t){var e,n=255*this.brightness(),i=t.data,a=i.length;for(e=0;a>e;e+=4)i[e]+=n,i[e+1]+=n,i[e+2]+=n},Kinetic.Factory.addGetterSetter(Kinetic.Node,"brightness",0,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Invert=function(t){var e,n=t.data,i=n.length;for(e=0;i>e;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2]}}(),function(){function t(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function e(e,a){var r,s,o,c,l,h,d,u,f,g,p,m,v,_,y,b,S,x,w,C,T,K,D,k,F=e.data,P=e.width,M=e.height,A=a+a+1,I=P-1,L=M-1,R=a+1,N=R*(R+1)/2,G=new t,j=null,$=G,O=null,U=null,H=n[a],E=i[a];for(o=1;A>o;o++)$=$.next=new t,o==R&&(j=$);for($.next=G,d=h=0,s=0;M>s;s++){for(b=S=x=w=u=f=g=p=0,m=R*(C=F[h]),v=R*(T=F[h+1]),_=R*(K=F[h+2]),y=R*(D=F[h+3]),u+=N*C,f+=N*T,g+=N*K,p+=N*D,$=G,o=0;R>o;o++)$.r=C,$.g=T,$.b=K,$.a=D,$=$.next;for(o=1;R>o;o++)c=h+((o>I?I:o)<<2),u+=($.r=C=F[c])*(k=R-o),f+=($.g=T=F[c+1])*k,g+=($.b=K=F[c+2])*k,p+=($.a=D=F[c+3])*k,b+=C,S+=T,x+=K,w+=D,$=$.next;for(O=G,U=j,r=0;P>r;r++)F[h+3]=D=p*H>>E,0!==D?(D=255/D,F[h]=(u*H>>E)*D,F[h+1]=(f*H>>E)*D,F[h+2]=(g*H>>E)*D):F[h]=F[h+1]=F[h+2]=0,u-=m,f-=v,g-=_,p-=y,m-=O.r,v-=O.g,_-=O.b,y-=O.a,c=d+((c=r+a+1)<I?c:I)<<2,b+=O.r=F[c],S+=O.g=F[c+1],x+=O.b=F[c+2],w+=O.a=F[c+3],u+=b,f+=S,g+=x,p+=w,O=O.next,m+=C=U.r,v+=T=U.g,_+=K=U.b,y+=D=U.a,b-=C,S-=T,x-=K,w-=D,U=U.next,h+=4;d+=P}for(r=0;P>r;r++){for(S=x=w=b=f=g=p=u=0,h=r<<2,m=R*(C=F[h]),v=R*(T=F[h+1]),_=R*(K=F[h+2]),y=R*(D=F[h+3]),u+=N*C,f+=N*T,g+=N*K,p+=N*D,$=G,o=0;R>o;o++)$.r=C,$.g=T,$.b=K,$.a=D,$=$.next;for(l=P,o=1;a>=o;o++)h=l+r<<2,u+=($.r=C=F[h])*(k=R-o),f+=($.g=T=F[h+1])*k,g+=($.b=K=F[h+2])*k,p+=($.a=D=F[h+3])*k,b+=C,S+=T,x+=K,w+=D,$=$.next,L>o&&(l+=P);for(h=r,O=G,U=j,s=0;M>s;s++)c=h<<2,F[c+3]=D=p*H>>E,D>0?(D=255/D,F[c]=(u*H>>E)*D,F[c+1]=(f*H>>E)*D,F[c+2]=(g*H>>E)*D):F[c]=F[c+1]=F[c+2]=0,u-=m,f-=v,g-=_,p-=y,m-=O.r,v-=O.g,_-=O.b,y-=O.a,c=r+((c=s+R)<L?c:L)*P<<2,u+=b+=O.r=F[c],f+=S+=O.g=F[c+1],g+=x+=O.b=F[c+2],p+=w+=O.a=F[c+3],O=O.next,m+=C=U.r,v+=T=U.g,_+=K=U.b,y+=D=U.a,b-=C,S-=T,x-=K,w-=D,U=U.next,h+=P}}var n=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],i=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];Kinetic.Filters.Blur=function(t){var n=Math.round(this.blurRadius());n>0&&e(t,n)},Kinetic.Factory.addGetterSetter(Kinetic.Node,"blurRadius",0,null,Kinetic.Factory.afterSetFilter)}(),function(){function t(t,e,n){var i=4*(n*t.width+e),a=[];return a.push(t.data[i++],t.data[i++],t.data[i++],t.data[i++]),a}function e(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function n(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function i(i,a){var r=t(i,0,0),s=t(i,i.width-1,0),o=t(i,0,i.height-1),c=t(i,i.width-1,i.height-1),l=a||10;if(e(r,s)<l&&e(s,c)<l&&e(c,o)<l&&e(o,r)<l){for(var h=n([s,r,c,o]),d=[],u=0;u<i.width*i.height;u++){var f=e(h,[i.data[4*u],i.data[4*u+1],i.data[4*u+2]]);d[u]=l>f?0:255}return d}}function a(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function r(t,e,n){for(var i=[1,1,1,1,0,1,1,1,1],a=Math.round(Math.sqrt(i.length)),r=Math.floor(a/2),s=[],o=0;n>o;o++)for(var c=0;e>c;c++){for(var l=o*e+c,h=0,d=0;a>d;d++)for(var u=0;a>u;u++){var f=o+d-r,g=c+u-r;if(f>=0&&n>f&&g>=0&&e>g){var p=f*e+g,m=i[d*a+u];h+=t[p]*m}}s[l]=2040===h?255:0}return s}function s(t,e,n){for(var i=[1,1,1,1,1,1,1,1,1],a=Math.round(Math.sqrt(i.length)),r=Math.floor(a/2),s=[],o=0;n>o;o++)for(var c=0;e>c;c++){for(var l=o*e+c,h=0,d=0;a>d;d++)for(var u=0;a>u;u++){var f=o+d-r,g=c+u-r;if(f>=0&&n>f&&g>=0&&e>g){var p=f*e+g,m=i[d*a+u];h+=t[p]*m}}s[l]=h>=1020?255:0}return s}function o(t,e,n){for(var i=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],a=Math.round(Math.sqrt(i.length)),r=Math.floor(a/2),s=[],o=0;n>o;o++)for(var c=0;e>c;c++){for(var l=o*e+c,h=0,d=0;a>d;d++)for(var u=0;a>u;u++){var f=o+d-r,g=c+u-r;if(f>=0&&n>f&&g>=0&&e>g){var p=f*e+g,m=i[d*a+u];h+=t[p]*m}}s[l]=h}return s}Kinetic.Filters.Mask=function(t){var e=this.threshold(),n=i(t,e);return n&&(n=r(n,t.width,t.height),n=s(n,t.width,t.height),n=o(n,t.width,t.height),a(t,n)),t},Kinetic.Factory.addGetterSetter(Kinetic.Node,"threshold",0,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.RGB=function(t){var e,n,i=t.data,a=i.length,r=this.red(),s=this.green(),o=this.blue();for(e=0;a>e;e+=4)n=(.34*i[e]+.5*i[e+1]+.16*i[e+2])/255,i[e]=n*r,i[e+1]=n*s,i[e+2]=n*o,i[e+3]=i[e+3]},Kinetic.Factory.addGetterSetter(Kinetic.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:0>t?0:Math.round(t)}),Kinetic.Factory.addGetterSetter(Kinetic.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:0>t?0:Math.round(t)}),Kinetic.Factory.addGetterSetter(Kinetic.Node,"blue",0,Kinetic.Validators.RGBComponent,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.HSV=function(t){var e,n,i,a,r,s=t.data,o=s.length,c=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,d=c*l*Math.cos(h*Math.PI/180),u=c*l*Math.sin(h*Math.PI/180),f=.299*c+.701*d+.167*u,g=.587*c-.587*d+.33*u,p=.114*c-.114*d-.497*u,m=.299*c-.299*d-.328*u,v=.587*c+.413*d+.035*u,_=.114*c-.114*d+.293*u,y=.299*c-.3*d+1.25*u,b=.587*c-.586*d-1.05*u,S=.114*c+.886*d-.2*u;for(e=0;o>e;e+=4)n=s[e+0],i=s[e+1],a=s[e+2],r=s[e+3],s[e+0]=f*n+g*i+p*a,s[e+1]=m*n+v*i+_*a,s[e+2]=y*n+b*i+S*a,s[e+3]=r},Kinetic.Factory.addGetterSetter(Kinetic.Node,"hue",0,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"saturation",0,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"value",0,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Factory.addGetterSetter(Kinetic.Node,"hue",0,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"saturation",0,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"luminance",0,null,Kinetic.Factory.afterSetFilter),Kinetic.Filters.HSL=function(t){var e,n,i,a,r,s=t.data,o=s.length,c=1,l=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,d=127*this.luminance(),u=c*l*Math.cos(h*Math.PI/180),f=c*l*Math.sin(h*Math.PI/180),g=.299*c+.701*u+.167*f,p=.587*c-.587*u+.33*f,m=.114*c-.114*u-.497*f,v=.299*c-.299*u-.328*f,_=.587*c+.413*u+.035*f,y=.114*c-.114*u+.293*f,b=.299*c-.3*u+1.25*f,S=.587*c-.586*u-1.05*f,x=.114*c+.886*u-.2*f;for(e=0;o>e;e+=4)n=s[e+0],i=s[e+1],a=s[e+2],r=s[e+3],s[e+0]=g*n+p*i+m*a+d,s[e+1]=v*n+_*i+y*a+d,s[e+2]=b*n+S*i+x*a+d,s[e+3]=r}}(),function(){Kinetic.Filters.Emboss=function(t){var e=10*this.embossStrength(),n=255*this.embossWhiteLevel(),i=this.embossDirection(),a=this.embossBlend(),r=0,s=0,o=t.data,c=t.width,l=t.height,h=4*c,d=l;switch(i){case"top-left":r=-1,s=-1;break;case"top":r=-1,s=0;break;case"top-right":r=-1,s=1;break;case"right":r=0,s=1;break;case"bottom-right":r=1,s=1;break;case"bottom":r=1,s=0;break;case"bottom-left":r=1,s=-1;break;case"left":r=0,s=-1}do{var u=(d-1)*h,f=r;1>d+f&&(f=0),d+f>l&&(f=0);var g=(d-1+f)*c*4,p=c;do{var m=u+4*(p-1),v=s;1>p+v&&(v=0),p+v>c&&(v=0);var _=g+4*(p-1+v),y=o[m]-o[_],b=o[m+1]-o[_+1],S=o[m+2]-o[_+2],x=y,w=x>0?x:-x,C=b>0?b:-b,T=S>0?S:-S;if(C>w&&(x=b),T>w&&(x=S),x*=e,a){var K=o[m]+x,D=o[m+1]+x,k=o[m+2]+x;o[m]=K>255?255:0>K?0:K,o[m+1]=D>255?255:0>D?0:D,o[m+2]=k>255?255:0>k?0:k}else{var F=n-x;0>F?F=0:F>255&&(F=255),o[m]=o[m+1]=o[m+2]=F}}while(--p)}while(--d)},Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossStrength",.5,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossWhiteLevel",.5,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossDirection","top-left",null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"embossBlend",!1,null,Kinetic.Factory.afterSetFilter)}(),function(){function t(t,e,n,i,a){var r,s=n-e,o=a-i;return 0===s?i+o/2:0===o?i:(r=(t-e)/s,r=o*r+i)}Kinetic.Filters.Enhance=function(e){var n,i,a,r,s=e.data,o=s.length,c=s[0],l=c,h=s[1],d=h,u=s[2],f=u,g=s[3],p=g,m=this.enhance();if(0!==m){for(r=0;o>r;r+=4)n=s[r+0],c>n?c=n:n>l&&(l=n),i=s[r+1],h>i?h=i:i>d&&(d=i),a=s[r+2],u>a?u=a:a>f&&(f=a);l===c&&(l=255,c=0),d===h&&(d=255,h=0),f===u&&(f=255,u=0),p===g&&(p=255,g=0);var v,_,y,b,S,x,w,C,T,K,D,k;for(m>0?(_=l+m*(255-l),y=c-m*(c-0),S=d+m*(255-d),x=h-m*(h-0),C=f+m*(255-f),k=u-m*(u-0),D=p+m*(255-p),T=g-m*(g-0)):(v=.5*(l+c),_=l+m*(l-v),y=c+m*(c-v),b=.5*(d+h),S=d+m*(d-b),x=h+m*(h-b),w=.5*(f+u),C=f+m*(f-w),k=u+m*(u-w),K=.5*(p+g),D=p+m*(p-K),T=g+m*(g-K)),r=0;o>r;r+=4)s[r+0]=t(s[r+0],c,l,y,_),s[r+1]=t(s[r+1],h,d,x,S),s[r+2]=t(s[r+2],u,f,k,C)}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"enhance",0,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Posterize=function(t){var e,n=Math.round(254*this.levels())+1,i=t.data,a=i.length,r=255/n;for(e=0;a>e;e+=1)i[e]=Math.floor(i[e]/r)*r},Kinetic.Factory.addGetterSetter(Kinetic.Node,"levels",.5,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Noise=function(t){var e,n=255*this.noise(),i=t.data,a=i.length,r=n/2;for(e=0;a>e;e+=4)i[e+0]+=r-2*r*Math.random(),i[e+1]+=r-2*r*Math.random(),i[e+2]+=r-2*r*Math.random()},Kinetic.Factory.addGetterSetter(Kinetic.Node,"noise",.2,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Pixelate=function(t){var e,n,i,a,r,s,o,c,l,h,d,u,f,g,p=Math.ceil(this.pixelSize()),m=t.width,v=t.height,_=Math.ceil(m/p),y=Math.ceil(v/p);for(t=t.data,u=0;_>u;u+=1)for(f=0;y>f;f+=1){for(a=0,r=0,s=0,o=0,c=u*p,l=c+p,h=f*p,d=h+p,g=0,e=c;l>e;e+=1)if(!(e>=m))for(n=h;d>n;n+=1)n>=v||(i=4*(m*n+e),a+=t[i+0],r+=t[i+1],s+=t[i+2],o+=t[i+3],g+=1);for(a/=g,r/=g,s/=g,e=c;l>e;e+=1)if(!(e>=m))for(n=h;d>n;n+=1)n>=v||(i=4*(m*n+e),t[i+0]=a,t[i+1]=r,t[i+2]=s,t[i+3]=o)}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"pixelSize",8,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Threshold=function(t){var e,n=255*this.threshold(),i=t.data,a=i.length;for(e=0;a>e;e+=1)i[e]=i[e]<n?0:255},Kinetic.Factory.addGetterSetter(Kinetic.Node,"threshold",.5,null,Kinetic.Factory.afterSetFilter)}(),function(){Kinetic.Filters.Sepia=function(t){var e,n,i,a,r,s,o,c,l,h=t.data,d=t.width,u=t.height,f=4*d;do{e=(u-1)*f,n=d;do i=e+4*(n-1),a=h[i],r=h[i+1],s=h[i+2],o=.393*a+.769*r+.189*s,c=.349*a+.686*r+.168*s,l=.272*a+.534*r+.131*s,h[i]=o>255?255:o,h[i+1]=c>255?255:c,h[i+2]=l>255?255:l,h[i+3]=h[i+3];while(--n)}while(--u)}}(),function(){Kinetic.Filters.Solarize=function(t){var e=t.data,n=t.width,i=t.height,a=4*n,r=i;do{var s=(r-1)*a,o=n;do{var c=s+4*(o-1),l=e[c],h=e[c+1],d=e[c+2];l>127&&(l=255-l),h>127&&(h=255-h),d>127&&(d=255-d),e[c]=l,e[c+1]=h,e[c+2]=d}while(--o)}while(--r)}}(),function(){var t=function(t,e,n){var i,a,r,s,o=t.data,c=e.data,l=t.width,h=t.height,d=n.polarCenterX||l/2,u=n.polarCenterY||h/2,f=0,g=0,p=0,m=0,v=Math.sqrt(d*d+u*u);a=l-d,r=h-u,s=Math.sqrt(a*a+r*r),v=s>v?s:v;var _,y,b,S,x=h,w=l,C=360/w*Math.PI/180;for(y=0;w>y;y+=1)for(b=Math.sin(y*C),S=Math.cos(y*C),_=0;x>_;_+=1)a=Math.floor(d+v*_/x*S),r=Math.floor(u+v*_/x*b),i=4*(r*l+a),f=o[i+0],g=o[i+1],p=o[i+2],m=o[i+3],i=4*(y+_*l),c[i+0]=f,c[i+1]=g,c[i+2]=p,c[i+3]=m},e=function(t,e,n){var i,a,r,s,o,c,l=t.data,h=e.data,d=t.width,u=t.height,f=n.polarCenterX||d/2,g=n.polarCenterY||u/2,p=0,m=0,v=0,_=0,y=Math.sqrt(f*f+g*g);a=d-f,r=u-g,c=Math.sqrt(a*a+r*r),y=c>y?c:y;var b,S,x,w,C=u,T=d,K=n.polarRotation||0;for(a=0;d>a;a+=1)for(r=0;u>r;r+=1)s=a-f,o=r-g,b=Math.sqrt(s*s+o*o)*C/y,S=(180*Math.atan2(o,s)/Math.PI+360+K)%360,S=S*T/360,x=Math.floor(S),w=Math.floor(b),i=4*(w*d+x),p=l[i+0],m=l[i+1],v=l[i+2],_=l[i+3],i=4*(r*d+a),h[i+0]=p,h[i+1]=m,h[i+2]=v,h[i+3]=_},n=Kinetic.Util.createCanvasElement();Kinetic.Filters.Kaleidoscope=function(i){var a,r,s,o,c,l,h,d,u,f,g=i.width,p=i.height,m=Math.round(this.kaleidoscopePower()),v=Math.round(this.kaleidoscopeAngle()),_=Math.floor(g*(v%360)/360);if(!(1>m)){n.width=g,n.height=p;var y=n.getContext("2d").getImageData(0,0,g,p);t(i,y,{polarCenterX:g/2,polarCenterY:p/2});for(var b=g/Math.pow(2,m);8>=b;)b=2*b,m-=1;b=Math.ceil(b);var S=b,x=0,w=S,C=1;for(_+b>g&&(x=S,w=0,C=-1),r=0;p>r;r+=1)for(a=x;a!==w;a+=C)s=Math.round(a+_)%g,u=4*(g*r+s),c=y.data[u+0],l=y.data[u+1],h=y.data[u+2],d=y.data[u+3],f=4*(g*r+a),y.data[f+0]=c,y.data[f+1]=l,y.data[f+2]=h,y.data[f+3]=d;for(r=0;p>r;r+=1)for(S=Math.floor(b),o=0;m>o;o+=1){for(a=0;S+1>a;a+=1)u=4*(g*r+a),c=y.data[u+0],l=y.data[u+1],h=y.data[u+2],d=y.data[u+3],f=4*(g*r+2*S-a-1),y.data[f+0]=c,y.data[f+1]=l,y.data[f+2]=h,y.data[f+3]=d;S*=2}e(y,i,{polarRotation:0})}},Kinetic.Factory.addGetterSetter(Kinetic.Node,"kaleidoscopePower",2,null,Kinetic.Factory.afterSetFilter),Kinetic.Factory.addGetterSetter(Kinetic.Node,"kaleidoscopeAngle",0,null,Kinetic.Factory.afterSetFilter)}(),function(){function t(t){Kinetic.root.setTimeout(t,1e3/60)}function e(){return a.apply(Kinetic.root,arguments)}var n=500,i=function(){return Kinetic.root.performance&&Kinetic.root.performance.now?function(){return Kinetic.root.performance.now()}:function(){return(new Date).getTime()}}(),a=function(){return Kinetic.root.requestAnimationFrame||Kinetic.root.webkitRequestAnimationFrame||Kinetic.root.mozRequestAnimationFrame||Kinetic.root.oRequestAnimationFrame||Kinetic.root.msRequestAnimationFrame||t}();Kinetic.Animation=function(t,e){var n=Kinetic.Animation;this.func=t,this.setLayers(e),this.id=n.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:i()}},Kinetic.Animation.prototype={setLayers:function(t){var e=[];e=t?t.length>0?t:[t]:[],this.layers=e},getLayers:function(){return this.layers},addLayer:function(t){var e,n,i=this.layers;if(i){for(e=i.length,n=0;e>n;n++)if(i[n]._id===t._id)return!1}else this.layers=[];return this.layers.push(t),!0},isRunning:function(){var t,e=Kinetic.Animation,n=e.animations,i=n.length;for(t=0;i>t;t++)if(n[t].id===this.id)return!0;return!1},start:function(){var t=Kinetic.Animation;this.stop(),this.frame.timeDiff=0,this.frame.lastTime=i(),t._addAnimation(this)},stop:function(){Kinetic.Animation._removeAnimation(this)},_updateFrameObject:function(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}},Kinetic.Animation.animations=[],Kinetic.Animation.animIdCounter=0,Kinetic.Animation.animRunning=!1,Kinetic.Animation._addAnimation=function(t){this.animations.push(t),this._handleAnimation()},Kinetic.Animation._removeAnimation=function(t){var e,n=t.id,i=this.animations,a=i.length;for(e=0;a>e;e++)if(i[e].id===n){this.animations.splice(e,1);break}},Kinetic.Animation._runFrames=function(){var t,e,n,a,r,s,o,c,l={},h=this.animations;for(a=0;a<h.length;a++){for(t=h[a],e=t.layers,n=t.func,t._updateFrameObject(i()),s=e.length,r=0;s>r;r++)o=e[r],void 0!==o._id&&(l[o._id]=o);n&&n.call(t,t.frame)}for(c in l)l[c].draw()},Kinetic.Animation._animationLoop=function(){var t=Kinetic.Animation;t.animations.length?(e(t._animationLoop),t._runFrames()):t.animRunning=!1},Kinetic.Animation._handleAnimation=function(){var t=this;this.animRunning||(this.animRunning=!0,t._animationLoop())};var r=Kinetic.Node.prototype.moveTo;Kinetic.Node.prototype.moveTo=function(t){r.call(this,t)},Kinetic.Layer.prototype.batchDraw=function(){var t=this,e=Kinetic.Animation;this.batchAnim||(this.batchAnim=new e(function(){t.lastBatchDrawTime&&i()-t.lastBatchDrawTime>n&&t.batchAnim.stop()},this)),this.lastBatchDrawTime=i(),this.batchAnim.isRunning()||(this.draw(),this.batchAnim.start())},Kinetic.Stage.prototype.batchDraw=function(){this.getChildren().each(function(t){t.batchDraw()})}}((0,eval)("this")),function(){var t={node:1,duration:1,easing:1,onFinish:1,yoyo:1},e=1,n=2,i=3,a=0;Kinetic.Tween=function(e){var n,i=this,s=e.node,o=s._id,c=e.duration||1,l=e.easing||Kinetic.Easings.Linear,h=!!e.yoyo;this.node=s,this._id=a++,this.anim=new Kinetic.Animation(function(){i.tween.onEnterFrame()},s.getLayer()),this.tween=new r(n,function(t){i._tweenFunc(t)},l,0,1,1e3*c,h),this._addListeners(),Kinetic.Tween.attrs[o]||(Kinetic.Tween.attrs[o]={}),Kinetic.Tween.attrs[o][this._id]||(Kinetic.Tween.attrs[o][this._id]={}),Kinetic.Tween.tweens[o]||(Kinetic.Tween.tweens[o]={});for(n in e)void 0===t[n]&&this._addAttr(n,e[n]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset},Kinetic.Tween.attrs={},Kinetic.Tween.tweens={},Kinetic.Tween.prototype={_addAttr:function(t,e){var n,i,a,r,s,o=this.node,c=o._id;if(a=Kinetic.Tween.tweens[c][t],a&&delete Kinetic.Tween.attrs[c][a][t],n=o.getAttr(t),Kinetic.Util._isArray(e))for(i=[],s=e.length,r=0;s>r;r++)i.push(e[r]-n[r]);else i=e-n;Kinetic.Tween.attrs[c][this._id][t]={start:n,diff:i},Kinetic.Tween.tweens[c][t]=this._id},_tweenFunc:function(t){var e,n,i,a,r,s,o,c=this.node,l=Kinetic.Tween.attrs[c._id][this._id];for(e in l){if(n=l[e],i=n.start,a=n.diff,Kinetic.Util._isArray(i))for(r=[],o=i.length,s=0;o>s;s++)r.push(i[s]+a[s]*t);else r=i+a*t;c.setAttr(e,r)}},_addListeners:function(){var t=this;this.tween.onPlay=function(){t.anim.start()},this.tween.onReverse=function(){t.anim.start()},this.tween.onPause=function(){t.anim.stop()},this.tween.onFinish=function(){
t.onFinish&&t.onFinish()},this.tween.onReset=function(){t.onReset&&t.onReset()}},play:function(){return this.tween.play(),this},reverse:function(){return this.tween.reverse(),this},reset:function(){return this.node,this.tween.reset(),this},seek:function(t){return this.node,this.tween.seek(1e3*t),this},pause:function(){return this.tween.pause(),this},finish:function(){return this.node,this.tween.finish(),this},destroy:function(){var t,e=this.node._id,n=this._id,i=Kinetic.Tween.tweens[e];this.pause();for(t in i)delete Kinetic.Tween.tweens[e][t];delete Kinetic.Tween.attrs[e][n]}};var r=function(t,e,n,i,a,r,s){this.prop=t,this.propFunc=e,this.begin=i,this._pos=i,this.duration=r,this._change=0,this.prevPos=0,this.yoyo=s,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=a-this.begin,this.pause()};r.prototype={fire:function(t){var e=this[t];e&&e()},setTime:function(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():0>t?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())},getTime:function(){return this._time},setPosition:function(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t},getPosition:function(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)},play:function(){this.state=n,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},reverse:function(){this.state=i,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},seek:function(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")},reset:function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},finish:function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},update:function(){this.setPosition(this.getPosition(this._time))},onEnterFrame:function(){var t=this.getTimer()-this._startTime;this.state===n?this.setTime(t):this.state===i&&this.setTime(this.duration-t)},pause:function(){this.state=e,this.fire("onPause")},getTimer:function(){return(new Date).getTime()}},Kinetic.Easings={BackEaseIn:function(t,e,n,i){var a=1.70158;return n*(t/=i)*t*((a+1)*t-a)+e},BackEaseOut:function(t,e,n,i){var a=1.70158;return n*((t=t/i-1)*t*((a+1)*t+a)+1)+e},BackEaseInOut:function(t,e,n,i){var a=1.70158;return(t/=i/2)<1?n/2*t*t*(((a*=1.525)+1)*t-a)+e:n/2*((t-=2)*t*(((a*=1.525)+1)*t+a)+2)+e},ElasticEaseIn:function(t,e,n,i,a,r){var s=0;return 0===t?e:1==(t/=i)?e+n:(r||(r=.3*i),!a||a<Math.abs(n)?(a=n,s=r/4):s=r/(2*Math.PI)*Math.asin(n/a),-(a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-s)*Math.PI/r))+e)},ElasticEaseOut:function(t,e,n,i,a,r){var s=0;return 0===t?e:1==(t/=i)?e+n:(r||(r=.3*i),!a||a<Math.abs(n)?(a=n,s=r/4):s=r/(2*Math.PI)*Math.asin(n/a),a*Math.pow(2,-10*t)*Math.sin(2*(t*i-s)*Math.PI/r)+n+e)},ElasticEaseInOut:function(t,e,n,i,a,r){var s=0;return 0===t?e:2==(t/=i/2)?e+n:(r||(r=.3*i*1.5),!a||a<Math.abs(n)?(a=n,s=r/4):s=r/(2*Math.PI)*Math.asin(n/a),1>t?-.5*a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-s)*Math.PI/r)+e:a*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*i-s)*Math.PI/r)*.5+n+e)},BounceEaseOut:function(t,e,n,i){return(t/=i)<1/2.75?7.5625*n*t*t+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn:function(t,e,n,i){return n-Kinetic.Easings.BounceEaseOut(i-t,0,n,i)+e},BounceEaseInOut:function(t,e,n,i){return i/2>t?.5*Kinetic.Easings.BounceEaseIn(2*t,0,n,i)+e:.5*Kinetic.Easings.BounceEaseOut(2*t-i,0,n,i)+.5*n+e},EaseIn:function(t,e,n,i){return n*(t/=i)*t+e},EaseOut:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},EaseInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},StrongEaseIn:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},StrongEaseOut:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},StrongEaseInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},Linear:function(t,e,n,i){return n*t/i+e}}}(),function(){Kinetic.DD={anim:new Kinetic.Animation,isDragging:!1,offset:{x:0,y:0},node:null,_drag:function(t){var e=Kinetic.DD,n=e.node;if(n){if(!e.isDragging){var i=n.getStage().getPointerPosition(),a=n.dragDistance(),r=Math.max(Math.abs(i.x-e.startPointerPos.x),Math.abs(i.y-e.startPointerPos.y));if(a>r)return}n._setDragPosition(t),e.isDragging||(e.isDragging=!0,n.fire("dragstart",{type:"dragstart",target:n,evt:t},!0)),n.fire("dragmove",{type:"dragmove",target:n,evt:t},!0)}},_endDragBefore:function(t){var e,n,i=Kinetic.DD,a=i.node;a&&(e=a.nodeType,n=a.getLayer(),i.anim.stop(),i.isDragging&&(i.isDragging=!1,Kinetic.listenClickTap=!1,t&&(t.dragEndNode=a)),delete i.node,(n||a).draw())},_endDragAfter:function(t){t=t||{};var e=t.dragEndNode;t&&e&&e.fire("dragend",{type:"dragend",target:e,evt:t},!0)}},Kinetic.Node.prototype.startDrag=function(){var t=Kinetic.DD,e=this.getStage(),n=this.getLayer(),i=e.getPointerPosition(),a=this.getAbsolutePosition();i&&(t.node&&t.node.stopDrag(),t.node=this,t.startPointerPos=i,t.offset.x=i.x-a.x,t.offset.y=i.y-a.y,t.anim.setLayers(n||this.getLayers()),t.anim.start(),this._setDragPosition())},Kinetic.Node.prototype._setDragPosition=function(t){var e=Kinetic.DD,n=this.getStage().getPointerPosition(),i=this.getDragBoundFunc();if(n){var a={x:n.x-e.offset.x,y:n.y-e.offset.y};void 0!==i&&(a=i.call(this,a,t)),this.setAbsolutePosition(a)}},Kinetic.Node.prototype.stopDrag=function(){var t=Kinetic.DD,e={};t._endDragBefore(e),t._endDragAfter(e)},Kinetic.Node.prototype.setDraggable=function(t){this._setAttr("draggable",t),this._dragChange()};var t=Kinetic.Node.prototype.destroy;Kinetic.Node.prototype.destroy=function(){var e=Kinetic.DD;e.node&&e.node._id===this._id&&this.stopDrag(),t.call(this)},Kinetic.Node.prototype.isDragging=function(){var t=Kinetic.DD;return t.node&&t.node._id===this._id&&t.isDragging},Kinetic.Node.prototype._listenDrag=function(){var t=this;this._dragCleanup(),"Stage"===this.getClassName()?this.on("contentMousedown.kinetic contentTouchstart.kinetic",function(e){Kinetic.DD.node||t.startDrag(e)}):this.on("mousedown.kinetic touchstart.kinetic",function(e){Kinetic.DD.node||t.startDrag(e)})},Kinetic.Node.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage(),e=Kinetic.DD;t&&e.node&&e.node._id===this._id&&e.node.stopDrag()}},Kinetic.Node.prototype._dragCleanup=function(){"Stage"===this.getClassName()?(this.off("contentMousedown.kinetic"),this.off("contentTouchstart.kinetic")):(this.off("mousedown.kinetic"),this.off("touchstart.kinetic"))},Kinetic.Factory.addGetterSetter(Kinetic.Node,"dragBoundFunc"),Kinetic.Factory.addGetter(Kinetic.Node,"draggable",!1),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Node,"draggable");var e=Kinetic.document.documentElement;e.addEventListener("mouseup",Kinetic.DD._endDragBefore,!0),e.addEventListener("touchend",Kinetic.DD._endDragBefore,!0),e.addEventListener("mouseup",Kinetic.DD._endDragAfter,!1),e.addEventListener("touchend",Kinetic.DD._endDragAfter,!1)}(),function(){Kinetic.Util.addMethods(Kinetic.Container,{__init:function(t){this.children=new Kinetic.Collection,Kinetic.Node.call(this,t)},getChildren:function(t){if(t){var e=new Kinetic.Collection;return this.children.each(function(n){t(n)&&e.push(n)}),e}return this.children},hasChildren:function(){return this.getChildren().length>0},removeChildren:function(){for(var t,e=Kinetic.Collection.toCollection(this.children),n=0;n<e.length;n++)t=e[n],delete t.parent,t.index=0,t.hasChildren()&&t.removeChildren(),t.remove();return e=null,this.children=new Kinetic.Collection,this},destroyChildren:function(){for(var t,e=Kinetic.Collection.toCollection(this.children),n=0;n<e.length;n++)t=e[n],delete t.parent,t.index=0,t.destroy();return e=null,this.children=new Kinetic.Collection,this},add:function(t){if(!(arguments.length>1)){if(t.getParent())return void t.moveTo(this);var e=this.children;return this._validateAdd(t),t.index=e.length,t.parent=this,e.push(t),this._fire("add",{child:t}),this}for(var n=0;n<arguments.length;n++)this.add(arguments[n])},destroy:function(){this.hasChildren()&&this.destroyChildren(),Kinetic.Node.prototype.destroy.call(this)},find:function(t){var e,n,i,a,r,s,o,c=[],l=t.replace(/ /g,"").split(","),h=l.length;for(e=0;h>e;e++)if(i=l[e],"#"===i.charAt(0))r=this._getNodeById(i.slice(1)),r&&c.push(r);else if("."===i.charAt(0))a=this._getNodesByName(i.slice(1)),c=c.concat(a);else for(s=this.getChildren(),o=s.length,n=0;o>n;n++)c=c.concat(s[n]._get(i));return Kinetic.Collection.toCollection(c)},_getNodeById:function(t){var e=Kinetic.ids[t];return void 0!==e&&this.isAncestorOf(e)?e:null},_getNodesByName:function(t){var e=Kinetic.names[t]||[];return this._getDescendants(e)},_get:function(t){for(var e=Kinetic.Node.prototype._get.call(this,t),n=this.getChildren(),i=n.length,a=0;i>a;a++)e=e.concat(n[a]._get(t));return e},toObject:function(){var t=Kinetic.Node.prototype.toObject.call(this);t.children=[];for(var e=this.getChildren(),n=e.length,i=0;n>i;i++){var a=e[i];t.children.push(a.toObject())}return t},_getDescendants:function(t){for(var e=[],n=t.length,i=0;n>i;i++){var a=t[i];this.isAncestorOf(a)&&e.push(a)}return e},isAncestorOf:function(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1},clone:function(t){var e=Kinetic.Node.prototype.clone.call(this,t);return this.getChildren().each(function(t){e.add(t.clone())}),e},getAllIntersections:function(t){var e=[];return this.find("Shape").each(function(n){n.isVisible()&&n.intersects(t)&&e.push(n)}),e},_setChildrenIndices:function(){this.children.each(function(t,e){t.index=e})},drawScene:function(t,e){var n=this.getLayer(),i=t||n&&n.getCanvas(),a=i&&i.getContext(),r=this._cache.canvas,s=r&&r.scene;return this.isVisible()&&(s?this._drawCachedSceneCanvas(a):this._drawChildren(i,"drawScene",e)),this},drawHit:function(t,e){var n=this.getLayer(),i=t||n&&n.hitCanvas,a=i&&i.getContext(),r=this._cache.canvas,s=r&&r.hit;return this.shouldDrawHit()&&(s?this._drawCachedHitCanvas(a):this._drawChildren(i,"drawHit",e)),this},_drawChildren:function(t,e,n){var i,a,r=this.getLayer(),s=t&&t.getContext(),o=this.getClipWidth(),c=this.getClipHeight(),l=o&&c;l&&r&&(i=this.getClipX(),a=this.getClipY(),s.save(),r._applyTransform(this,s),s.beginPath(),s.rect(i,a,o,c),s.clip(),s.reset()),this.children.each(function(i){i[e](t,n)}),l&&s.restore()}}),Kinetic.Util.extend(Kinetic.Container,Kinetic.Node),Kinetic.Container.prototype.get=Kinetic.Container.prototype.find,Kinetic.Factory.addComponentsGetterSetter(Kinetic.Container,"clip",["x","y","width","height"]),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipX"),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipY"),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipWidth"),Kinetic.Factory.addGetterSetter(Kinetic.Container,"clipHeight"),Kinetic.Collection.mapMethods(Kinetic.Container)}(),function(){function t(t){t.fill()}function e(t){t.stroke()}function n(t){t.fill()}function i(t){t.stroke()}function a(){this._clearCache(r)}var r="hasShadow";Kinetic.Util.addMethods(Kinetic.Shape,{__init:function(r){this.nodeType="Shape",this._fillFunc=t,this._strokeFunc=e,this._fillFuncHit=n,this._strokeFuncHit=i;for(var s,o=Kinetic.shapes;s=Kinetic.Util.getRandomColor(),!s||s in o;);this.colorKey=s,o[s]=this,Kinetic.Node.call(this,r),this.on("shadowColorChange.kinetic shadowBlurChange.kinetic shadowOffsetChange.kinetic shadowOpacityChange.kinetic shadowEnabledChange.kinetic",a)},hasChildren:function(){return!1},getChildren:function(){return[]},getContext:function(){return this.getLayer().getContext()},getCanvas:function(){return this.getLayer().getCanvas()},hasShadow:function(){return this._getCache(r,this._hasShadow)},_hasShadow:function(){return this.getShadowEnabled()&&0!==this.getShadowOpacity()&&!!(this.getShadowColor()||this.getShadowBlur()||this.getShadowOffsetX()||this.getShadowOffsetY())},hasFill:function(){return!!(this.getFill()||this.getFillPatternImage()||this.getFillLinearGradientColorStops()||this.getFillRadialGradientColorStops())},hasStroke:function(){return!!(this.stroke()||this.strokeRed()||this.strokeGreen()||this.strokeBlue())},_get:function(t){return this.className===t||this.nodeType===t?[this]:[]},intersects:function(t){var e,n=this.getStage(),i=n.bufferHitCanvas;return i.getContext().clear(),this.drawScene(i),e=i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data,e[3]>0},destroy:function(){Kinetic.Node.prototype.destroy.call(this),delete Kinetic.shapes[this.colorKey]},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasFill()&&this.hasStroke()&&this.getStage()},drawScene:function(t,e){var n,i,a,r=this.getLayer(),s=t||r.getCanvas(),o=s.getContext(),c=this._cache.canvas,l=this.sceneFunc(),h=this.hasShadow();return this.isVisible()&&(c?this._drawCachedSceneCanvas(o):l&&(o.save(),this._useBufferCanvas()?(n=this.getStage(),i=n.bufferCanvas,a=i.getContext(),a.clear(),a.save(),a._applyLineJoin(this),r._applyTransform(this,a,e),l.call(this,a),a.restore(),h&&(o.save(),o._applyShadow(this),o.drawImage(i._canvas,0,0),o.restore()),o._applyOpacity(this),o.drawImage(i._canvas,0,0)):(o._applyLineJoin(this),r._applyTransform(this,o,e),h&&(o.save(),o._applyShadow(this),l.call(this,o),o.restore()),o._applyOpacity(this),l.call(this,o)),o.restore())),this},drawHit:function(t,e){var n=this.getLayer(),i=t||n.hitCanvas,a=i.getContext(),r=this.hitFunc()||this.sceneFunc(),s=this._cache.canvas,o=s&&s.hit;return this.shouldDrawHit()&&(o?this._drawCachedHitCanvas(a):r&&(a.save(),a._applyLineJoin(this),n._applyTransform(this,a,e),r.call(this,a),a.restore())),this},drawHitFromCache:function(t){var e,n,i,a,r,s,o,c,l=t||0,h=this._cache.canvas,d=this._getCachedSceneCanvas(),u=d.getContext(),f=h.hit,g=f.getContext(),p=d.getWidth(),m=d.getHeight();g.clear();try{for(e=u.getImageData(0,0,p,m),n=e.data,i=g.getImageData(0,0,p,m),a=i.data,r=n.length,s=Kinetic.Util._hexToRgb(this.colorKey),o=0;r>o;o+=4)c=n[o+3],c>l&&(a[o]=s.r,a[o+1]=s.g,a[o+2]=s.b,a[o+3]=255);g.putImageData(i,0,0)}catch(v){Kinetic.Util.warn("Unable to draw hit graph from cached scene canvas. "+v.message)}return this}}),Kinetic.Util.extend(Kinetic.Shape,Kinetic.Node),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"stroke"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeRed",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeGreen",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeBlue",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeAlpha",1,Kinetic.Validators.alphaComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeWidth",2),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"lineJoin"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"lineCap"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"sceneFunc"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"hitFunc"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"dash"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowColor"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowRed",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowGreen",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowBlue",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowAlpha",1,Kinetic.Validators.alphaComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowBlur"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowOpacity"),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"shadowOffset",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowOffsetX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowOffsetY",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternImage"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fill"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRed",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillGreen",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillBlue",0,Kinetic.Validators.RGBComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillAlpha",1,Kinetic.Validators.alphaComponent),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternY",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientColorStops"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientStartRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientEndRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientColorStops"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternRepeat","repeat"),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"shadowEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"dashEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"strokeScaleEnabled",!0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPriority","color"),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillPatternOffset",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternOffsetX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternOffsetY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillPatternScale",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternScaleX",1),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternScaleY",1),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillLinearGradientStartPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientStartPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientStartPointY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillLinearGradientEndPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientEndPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillLinearGradientEndPointY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillRadialGradientStartPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientStartPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientStartPointY",0),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Shape,"fillRadialGradientEndPoint",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientEndPointX",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillRadialGradientEndPointY",0),Kinetic.Factory.addGetterSetter(Kinetic.Shape,"fillPatternRotation",0),Kinetic.Factory.backCompat(Kinetic.Shape,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),Kinetic.Collection.mapMethods(Kinetic.Shape)}(),function(){function t(t,e){t.content.addEventListener(e,function(n){t[L+e](n)},!1)}var e="Stage",n="string",i="px",a="mouseout",r="mouseleave",s="mouseover",o="mouseenter",c="mousemove",l="mousedown",h="mouseup",d="click",u="dblclick",f="touchstart",g="touchend",p="tap",m="dbltap",v="touchmove",_="contentMouseout",y="contentMouseover",b="contentMousemove",S="contentMousedown",x="contentMouseup",w="contentClick",C="contentDblclick",T="contentTouchstart",K="contentTouchend",D="contentDbltap",k="contentTouchmove",F="div",P="relative",M="inline-block",A="kineticjs-content",I=" ",L="_",R="container",N="",G=[l,c,h,a,f,v,g,s],j=G.length;Kinetic.Util.addMethods(Kinetic.Stage,{___init:function(t){this.nodeType=e,Kinetic.Container.call(this,t),this._id=Kinetic.idCounter++,this._buildDOM(),this._bindContentEvents(),this._enableNestedTransforms=!1,Kinetic.stages.push(this)},_validateAdd:function(t){"Layer"!==t.getType()&&Kinetic.Util.error("You may only add layers to the stage.")},setContainer:function(t){if(typeof t===n){var e=t;if(t=Kinetic.document.getElementById(t),!t)throw"Can not find container in document with id "+e}return this._setAttr(R,t),this},shouldDrawHit:function(){return!0},draw:function(){return Kinetic.Node.prototype.draw.call(this),this},setHeight:function(t){return Kinetic.Node.prototype.setHeight.call(this,t),this._resizeDOM(),this},setWidth:function(t){return Kinetic.Node.prototype.setWidth.call(this,t),this._resizeDOM(),this},clear:function(){var t,e=this.children,n=e.length;for(t=0;n>t;t++)e[t].clear();return this},clone:function(t){return t||(t={}),t.container=Kinetic.document.createElement(F),Kinetic.Container.prototype.clone.call(this,t)},destroy:function(){var t=this.content;Kinetic.Container.prototype.destroy.call(this),t&&Kinetic.Util._isInDocument(t)&&this.getContainer().removeChild(t);var e=Kinetic.stages.indexOf(this);e>-1&&Kinetic.stages.splice(e,1)},getPointerPosition:function(){return this.pointerPos},getStage:function(){return this},getContent:function(){return this.content},toDataURL:function(t){function e(a){var r=c[a],l=r.toDataURL(),h=new Kinetic.window.Image;h.onload=function(){o.drawImage(h,0,0),a<c.length-1?e(a+1):t.callback(s.toDataURL(n,i))},h.src=l}t=t||{};var n=t.mimeType||null,i=t.quality||null,a=t.x||0,r=t.y||0,s=new Kinetic.SceneCanvas({width:t.width||this.getWidth(),height:t.height||this.getHeight(),pixelRatio:1}),o=s.getContext()._context,c=this.children;(a||r)&&o.translate(-1*a,-1*r),e(0)},toImage:function(t){var e=t.callback;t.callback=function(t){Kinetic.Util._getImage(t,function(t){e(t)})},this.toDataURL(t)},getIntersection:function(t){var e,n,i=this.getChildren(),a=i.length,r=a-1;for(e=r;e>=0;e--)if(n=i[e].getIntersection(t))return n;return null},_resizeDOM:function(){if(this.content){var t,e,n=this.getWidth(),a=this.getHeight(),r=this.getChildren(),s=r.length;for(this.content.style.width=n+i,this.content.style.height=a+i,this.bufferCanvas.setSize(n,a),this.bufferHitCanvas.setSize(n,a),t=0;s>t;t++)e=r[t],e.getCanvas().setSize(n,a),e.hitCanvas.setSize(n,a),e.draw()}},add:function(t){if(!(arguments.length>1))return Kinetic.Container.prototype.add.call(this,t),t._setCanvasSize(this.width(),this.height()),t.draw(),this.content.appendChild(t.canvas._canvas),this;for(var e=0;e<arguments.length;e++)this.add(arguments[e])},getParent:function(){return null},getLayer:function(){return null},getLayers:function(){return this.getChildren()},_bindContentEvents:function(){for(var e=0;j>e;e++)t(this,G[e])},_mouseover:function(t){Kinetic.UA.mobile||(this._setPointerPosition(t),this._fire(y,{evt:t}))},_mouseout:function(t){if(!Kinetic.UA.mobile){this._setPointerPosition(t);var e=this.targetShape;e&&!Kinetic.isDragging()&&(e._fireAndBubble(a,{evt:t}),e._fireAndBubble(r,{evt:t}),this.targetShape=null),this.pointerPos=void 0,this._fire(_,{evt:t})}},_mousemove:function(t){if(!Kinetic.UA.mobile){this._setPointerPosition(t);var e=Kinetic.DD,n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?Kinetic.isDragging()||this.targetShape&&this.targetShape._id===n._id?n._fireAndBubble(c,{evt:t}):(this.targetShape&&(this.targetShape._fireAndBubble(a,{evt:t},n),this.targetShape._fireAndBubble(r,{evt:t},n)),n._fireAndBubble(s,{evt:t},this.targetShape),n._fireAndBubble(o,{evt:t},this.targetShape),this.targetShape=n):this.targetShape&&!Kinetic.isDragging()&&(this.targetShape._fireAndBubble(a,{evt:t}),this.targetShape._fireAndBubble(r,{evt:t}),this.targetShape=null),this._fire(b,{evt:t}),e&&e._drag(t)}t.preventDefault&&t.preventDefault()},_mousedown:function(t){if(!Kinetic.UA.mobile){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());Kinetic.listenClickTap=!0,e&&e.isListening()&&(this.clickStartShape=e,e._fireAndBubble(l,{evt:t})),this._fire(S,{evt:t})}t.preventDefault&&t.preventDefault()},_mouseup:function(t){if(!Kinetic.UA.mobile){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition()),n=this.clickStartShape,i=!1;Kinetic.inDblClickWindow?(i=!0,Kinetic.inDblClickWindow=!1):Kinetic.inDblClickWindow=!0,setTimeout(function(){Kinetic.inDblClickWindow=!1},Kinetic.dblClickWindow),e&&e.isListening()&&(e._fireAndBubble(h,{evt:t}),Kinetic.listenClickTap&&n&&n._id===e._id&&(e._fireAndBubble(d,{evt:t}),i&&e._fireAndBubble(u,{evt:t}))),this._fire(x,{evt:t}),Kinetic.listenClickTap&&(this._fire(w,{evt:t}),i&&this._fire(C,{evt:t})),Kinetic.listenClickTap=!1}t.preventDefault&&t.preventDefault()},_touchstart:function(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition());Kinetic.listenClickTap=!0,e&&e.isListening()&&(this.tapStartShape=e,e._fireAndBubble(f,{evt:t}),e.isListening()&&t.preventDefault&&t.preventDefault()),this._fire(T,{evt:t})},_touchend:function(t){this._setPointerPosition(t);var e=this.getIntersection(this.getPointerPosition()),n=!1;Kinetic.inDblClickWindow?(n=!0,Kinetic.inDblClickWindow=!1):Kinetic.inDblClickWindow=!0,setTimeout(function(){Kinetic.inDblClickWindow=!1},Kinetic.dblClickWindow),e&&e.isListening()&&(e._fireAndBubble(g,{evt:t}),Kinetic.listenClickTap&&e._id===this.tapStartShape._id&&(e._fireAndBubble(p,{evt:t}),n&&e._fireAndBubble(m,{evt:t})),e.isListening()&&t.preventDefault&&t.preventDefault()),Kinetic.listenClickTap&&(this._fire(K,{evt:t}),n&&this._fire(D,{evt:t})),Kinetic.listenClickTap=!1},_touchmove:function(t){this._setPointerPosition(t);var e=Kinetic.DD,n=this.getIntersection(this.getPointerPosition());n&&n.isListening()&&(n._fireAndBubble(v,{evt:t}),n.isListening()&&t.preventDefault&&t.preventDefault()),this._fire(k,{evt:t}),e&&e._drag(t)},_setPointerPosition:function(t){var e,n=this._getContentPosition(),i=t.offsetX,a=t.clientX,r=null,s=null;t=t?t:window.event,void 0!==t.touches?t.touches.length>0&&(e=t.touches[0],r=e.clientX-n.left,s=e.clientY-n.top):void 0!==i?(r=i,s=t.offsetY):"mozilla"===Kinetic.UA.browser?(r=t.layerX,s=t.layerY):void 0!==a&&n&&(r=a-n.left,s=t.clientY-n.top),null!==r&&null!==s&&(this.pointerPos={x:r,y:s})},_getContentPosition:function(){var t=this.content.getBoundingClientRect?this.content.getBoundingClientRect():{top:0,left:0};return{top:t.top,left:t.left}},_buildDOM:function(){var t=this.getContainer();if(!t){if(Kinetic.Util.isBrowser())throw"Stage has not container. But container is required";t=Kinetic.document.createElement(F)}t.innerHTML=N,this.content=Kinetic.document.createElement(F),this.content.style.position=P,this.content.style.display=M,this.content.className=A,this.content.setAttribute("role","presentation"),t.appendChild(this.content),this.bufferCanvas=new Kinetic.SceneCanvas({pixelRatio:1}),this.bufferHitCanvas=new Kinetic.HitCanvas,this._resizeDOM()},_onContent:function(t,e){var n,i,a=t.split(I),r=a.length;for(n=0;r>n;n++)i=a[n],this.content.addEventListener(i,e,!1)},cache:function(){Kinetic.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.")},clearCache:function(){}}),Kinetic.Util.extend(Kinetic.Stage,Kinetic.Container),Kinetic.Factory.addGetter(Kinetic.Stage,"container"),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Stage,"container")}(),function(){Kinetic.Util.addMethods(Kinetic.BaseLayer,{___init:function(t){this.nodeType="Layer",Kinetic.Container.call(this,t)},createPNGStream:function(){return this.canvas._canvas.createPNGStream()},getCanvas:function(){return this.canvas},getHitCanvas:function(){return this.hitCanvas},getContext:function(){return this.getCanvas().getContext()},clear:function(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this},setZIndex:function(t){Kinetic.Node.prototype.setZIndex.call(this,t);var e=this.getStage();return e&&(e.content.removeChild(this.getCanvas()._canvas),t<e.getChildren().length-1?e.content.insertBefore(this.getCanvas()._canvas,e.getChildren()[t+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas)),this},moveToTop:function(){Kinetic.Node.prototype.moveToTop.call(this);var t=this.getStage();t&&(t.content.removeChild(this.getCanvas()._canvas),t.content.appendChild(this.getCanvas()._canvas))},moveUp:function(){if(Kinetic.Node.prototype.moveUp.call(this)){var t=this.getStage();t&&(t.content.removeChild(this.getCanvas()._canvas),this.index<t.getChildren().length-1?t.content.insertBefore(this.getCanvas()._canvas,t.getChildren()[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getCanvas()._canvas))}},moveDown:function(){if(Kinetic.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[this.index+1].getCanvas()._canvas)}}},moveToBottom:function(){if(Kinetic.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.getChildren();t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[1].getCanvas()._canvas)}}},getLayer:function(){return this},remove:function(){var t=this.getCanvas()._canvas;return Kinetic.Node.prototype.remove.call(this),t&&t.parentNode&&Kinetic.Util._isInDocument(t)&&t.parentNode.removeChild(t),this},getStage:function(){return this.parent}}),Kinetic.Util.extend(Kinetic.BaseLayer,Kinetic.Container),Kinetic.Factory.addGetterSetter(Kinetic.BaseLayer,"clearBeforeDraw",!0),Kinetic.Collection.mapMethods(Kinetic.BaseLayer)}(),function(){var t="#",e="beforeDraw",n="draw",i=[{x:0,y:0},{x:-1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1}],a=i.length;Kinetic.Util.addMethods(Kinetic.Layer,{____init:function(t){this.nodeType="Layer",this.canvas=new Kinetic.SceneCanvas,this.hitCanvas=new Kinetic.HitCanvas,Kinetic.BaseLayer.call(this,t)},_setCanvasSize:function(t,e){this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e)},_validateAdd:function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&Kinetic.Util.error("You may only add groups and shapes to a layer.")},getIntersection:function(t){var e,n,r,s;if(!this.hitGraphEnabled()||!this.isVisible())return null;for(n=0;a>n;n++){if(r=i[n],e=this._getIntersection({x:t.x+r.x,y:t.y+r.y}),s=e.shape)return s;if(!e.antialiased)return null}},_getIntersection:function(e){var n,i,a=this.hitCanvas.context._context.getImageData(e.x,e.y,1,1).data,r=a[3];return 255===r?(n=Kinetic.Util._rgbToHex(a[0],a[1],a[2]),i=Kinetic.shapes[t+n],{shape:i}):r>0?{antialiased:!0}:{}},drawScene:function(t,i){var a=this.getLayer(),r=t||a&&a.getCanvas();return this._fire(e,{node:this}),this.getClearBeforeDraw()&&r.getContext().clear(),Kinetic.Container.prototype.drawScene.call(this,r,i),this._fire(n,{node:this}),this},_applyTransform:function(t,e,n){var i=t.getAbsoluteTransform(n).getMatrix();e.transform(i[0],i[1],i[2],i[3],i[4],i[5])},drawHit:function(t,e){var n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.getClearBeforeDraw()&&n.getHitCanvas().getContext().clear(),Kinetic.Container.prototype.drawHit.call(this,i,e),this},clear:function(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this},setVisible:function(t){return Kinetic.Node.prototype.setVisible.call(this,t),t?(this.getCanvas()._canvas.style.display="block",this.hitCanvas._canvas.style.display="block"):(this.getCanvas()._canvas.style.display="none",this.hitCanvas._canvas.style.display="none"),this},enableHitGraph:function(){return this.setHitGraphEnabled(!0),this},disableHitGraph:function(){return this.setHitGraphEnabled(!1),this}}),Kinetic.Util.extend(Kinetic.Layer,Kinetic.BaseLayer),Kinetic.Factory.addGetterSetter(Kinetic.Layer,"hitGraphEnabled",!0),Kinetic.Collection.mapMethods(Kinetic.Layer)}(),function(){Kinetic.Util.addMethods(Kinetic.FastLayer,{____init:function(t){this.nodeType="Layer",this.canvas=new Kinetic.SceneCanvas,Kinetic.BaseLayer.call(this,t)},_validateAdd:function(t){var e=t.getType();"Shape"!==e&&Kinetic.Util.error("You may only add shapes to a fast layer.")},_setCanvasSize:function(t,e){this.canvas.setSize(t,e)},hitGraphEnabled:function(){
return!1},getIntersection:function(){return null},drawScene:function(t){var e=this.getLayer(),n=t||e&&e.getCanvas();return this.getClearBeforeDraw()&&n.getContext().clear(),Kinetic.Container.prototype.drawScene.call(this,n),this},_applyTransform:function(t,e,n){if(!n||n._id!==this._id){var i=t.getTransform().getMatrix();e.transform(i[0],i[1],i[2],i[3],i[4],i[5])}},draw:function(){return this.drawScene(),this},clear:function(t){return this.getContext().clear(t),this},setVisible:function(t){return Kinetic.Node.prototype.setVisible.call(this,t),this.getCanvas()._canvas.style.display=t?"block":"none",this}}),Kinetic.Util.extend(Kinetic.FastLayer,Kinetic.BaseLayer),Kinetic.Collection.mapMethods(Kinetic.FastLayer)}(),function(){Kinetic.Util.addMethods(Kinetic.Group,{___init:function(t){this.nodeType="Group",Kinetic.Container.call(this,t)},_validateAdd:function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&Kinetic.Util.error("You may only add groups and shapes to groups.")}}),Kinetic.Util.extend(Kinetic.Group,Kinetic.Container),Kinetic.Collection.mapMethods(Kinetic.Group)}(),function(){Kinetic.Rect=function(t){this.___init(t)},Kinetic.Rect.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Rect",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.getCornerRadius(),n=this.getWidth(),i=this.getHeight();t.beginPath(),e?(t.moveTo(e,0),t.lineTo(n-e,0),t.arc(n-e,e,e,3*Math.PI/2,0,!1),t.lineTo(n,i-e),t.arc(n-e,i-e,e,0,Math.PI/2,!1),t.lineTo(e,i),t.arc(e,i-e,e,Math.PI/2,Math.PI,!1),t.lineTo(0,e),t.arc(e,e,e,Math.PI,3*Math.PI/2,!1)):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Rect,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Rect,"cornerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Rect)}(),function(){var t=2*Math.PI-1e-4,e="Circle";Kinetic.Circle=function(t){this.___init(t)},Kinetic.Circle.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className=e,this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){e.beginPath(),e.arc(0,0,this.getRadius(),0,t,!1),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(t){Kinetic.Node.prototype.setWidth.call(this,t),this.setRadius(t/2)},setHeight:function(t){Kinetic.Node.prototype.setHeight.call(this,t),this.setRadius(t/2)}},Kinetic.Util.extend(Kinetic.Circle,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Circle,"radius",0),Kinetic.Collection.mapMethods(Kinetic.Circle)}(),function(){var t=2*Math.PI-1e-4,e="Ellipse";Kinetic.Ellipse=function(t){this.___init(t)},Kinetic.Ellipse.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className=e,this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var n=this.getRadius(),i=n.x,a=n.y;e.beginPath(),e.save(),i!==a&&e.scale(1,a/i),e.arc(0,0,i,0,t,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius().x},getHeight:function(){return 2*this.getRadius().y},setWidth:function(t){Kinetic.Node.prototype.setWidth.call(this,t),this.setRadius({x:t/2})},setHeight:function(t){Kinetic.Node.prototype.setHeight.call(this,t),this.setRadius({y:t/2})}},Kinetic.Util.extend(Kinetic.Ellipse,Kinetic.Shape),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Ellipse,"radius",["x","y"]),Kinetic.Factory.addGetterSetter(Kinetic.Ellipse,"radiusX",0),Kinetic.Factory.addGetterSetter(Kinetic.Ellipse,"radiusY",0),Kinetic.Collection.mapMethods(Kinetic.Ellipse)}(),function(){var t=2*Math.PI-1e-4;Kinetic.Ring=function(t){this.___init(t)},Kinetic.Ring.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Ring",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){e.beginPath(),e.arc(0,0,this.getInnerRadius(),0,t,!1),e.moveTo(this.getOuterRadius(),0),e.arc(0,0,this.getOuterRadius(),t,0,!0),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(t){Kinetic.Node.prototype.setWidth.call(this,t),this.setOuterRadius(t/2)},setHeight:function(t){Kinetic.Node.prototype.setHeight.call(this,t),this.setOuterRadius(t/2)}},Kinetic.Util.extend(Kinetic.Ring,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Ring,"innerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Ring,"outerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Ring)}(),function(){Kinetic.Wedge=function(t){this.___init(t)},Kinetic.Wedge.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Wedge",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){t.beginPath(),t.arc(0,0,this.getRadius(),0,Kinetic.getAngle(this.getAngle()),this.getClockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Wedge,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Wedge,"radius",0),Kinetic.Factory.addGetterSetter(Kinetic.Wedge,"angle",0),Kinetic.Factory.addGetterSetter(Kinetic.Wedge,"clockwise",!1),Kinetic.Factory.backCompat(Kinetic.Wedge,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Kinetic.Collection.mapMethods(Kinetic.Wedge)}(),function(){Math.PI/180,Kinetic.Arc=function(t){this.___init(t)},Kinetic.Arc.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Arc",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=Kinetic.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.getOuterRadius(),0,e,n),t.arc(0,0,this.getInnerRadius(),e,0,!n),t.closePath(),t.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Arc,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"innerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"outerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"angle",0),Kinetic.Factory.addGetterSetter(Kinetic.Arc,"clockwise",!1),Kinetic.Collection.mapMethods(Kinetic.Arc)}(),function(){var t="Image";Kinetic.Image=function(t){this.___init(t)},Kinetic.Image.prototype={___init:function(e){Kinetic.Shape.call(this,e),this.className=t,this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()},_sceneFunc:function(t){var e,n,i,a,r=this.getWidth(),s=this.getHeight(),o=this.getImage();o&&(e=this.getCrop(),n=e.width,i=e.height,a=n&&i?[o,e.x,e.y,n,i,0,0,r,s]:[o,0,0,r,s]),t.beginPath(),t.rect(0,0,r,s),t.closePath(),t.fillStrokeShape(this),o&&t.drawImage.apply(t,a)},_hitFunc:function(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},getWidth:function(){var t=this.getImage();return this.attrs.width||(t?t.width:0)},getHeight:function(){var t=this.getImage();return this.attrs.height||(t?t.height:0)}},Kinetic.Util.extend(Kinetic.Image,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Image,"image"),Kinetic.Factory.addComponentsGetterSetter(Kinetic.Image,"crop",["x","y","width","height"]),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropX",0),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropY",0),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropWidth",0),Kinetic.Factory.addGetterSetter(Kinetic.Image,"cropHeight",0),Kinetic.Collection.mapMethods(Kinetic.Image)}(),function(){function t(t){t.fillText(this.partialText,0,0)}function e(t){t.strokeText(this.partialText,0,0)}var n="auto",i="center",a="Change.kinetic",r="2d",s="-",o="",c="left",l="text",h="Text",d="middle",u="normal",f="px ",g=" ",p="right",m="word",v="char",_="none",y=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","lineHeight","text","width","height","wrap"],b=y.length,S=Kinetic.Util.createCanvasElement().getContext(r);Kinetic.Text=function(t){this.___init(t)},Kinetic.Text.prototype={___init:function(i){var r=this;void 0===i.width&&(i.width=n),void 0===i.height&&(i.height=n),Kinetic.Shape.call(this,i),this._fillFunc=t,this._strokeFunc=e,this.className=h;for(var s=0;b>s;s++)this.on(y[s]+a,r._setTextData);this._setTextData(),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(t){var e,n=this.getPadding(),a=this.getTextHeight(),r=this.getLineHeight()*a,s=this.textArr,o=s.length,l=this.getWidth();for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",d),t.setAttr("textAlign",c),t.save(),t.translate(n,0),t.translate(0,n+a/2),e=0;o>e;e++){var h=s[e],u=h.text,f=h.width;t.save(),this.getAlign()===p?t.translate(l-f-2*n,0):this.getAlign()===i&&t.translate((l-f-2*n)/2,0),this.partialText=u,t.fillStrokeShape(this),t.restore(),t.translate(0,r)}t.restore()},_hitFunc:function(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},setText:function(t){var e=Kinetic.Util._isString(t)?t:t.toString();return this._setAttr(l,e),this},getWidth:function(){return this.attrs.width===n?this.getTextWidth()+2*this.getPadding():this.attrs.width},getHeight:function(){return this.attrs.height===n?this.getTextHeight()*this.textArr.length*this.getLineHeight()+2*this.getPadding():this.attrs.height},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},_getTextSize:function(t){var e,n=S,i=this.getFontSize();return n.save(),n.font=this._getContextFont(),e=n.measureText(t),n.restore(),{width:e.width,height:parseInt(i,10)}},_getContextFont:function(){return this.getFontStyle()+g+this.getFontVariant()+g+this.getFontSize()+f+this.getFontFamily()},_addTextLine:function(t,e){return this.textArr.push({text:t,width:e})},_getTextWidth:function(t){return S.measureText(t).width},_setTextData:function(){var t=this.getText().split("\n"),e=+this.getFontSize(),i=0,a=this.getLineHeight()*e,r=this.attrs.width,o=this.attrs.height,c=r!==n,l=o!==n,h=this.getPadding(),d=r-2*h,u=o-2*h,f=0,p=this.getWrap(),m=p!==_,y=p!==v&&m;this.textArr=[],S.save(),S.font=this._getContextFont();for(var b=0,x=t.length;x>b;++b){var w=t[b],C=this._getTextWidth(w);if(c&&C>d)for(;w.length>0;){for(var T=0,K=w.length,D="",k=0;K>T;){var F=T+K>>>1,P=w.slice(0,F+1),M=this._getTextWidth(P);d>=M?(T=F+1,D=P,k=M):K=F}if(!D)break;if(y){var A=Math.max(D.lastIndexOf(g),D.lastIndexOf(s))+1;A>0&&(T=A,D=D.slice(0,T),k=this._getTextWidth(D))}if(this._addTextLine(D,k),i=Math.max(i,k),f+=a,!m||l&&f+a>u)break;if(w=w.slice(T),w.length>0&&(C=this._getTextWidth(w),d>=C)){this._addTextLine(w,C),f+=a,i=Math.max(i,C);break}}else this._addTextLine(w,C),f+=a,i=Math.max(i,C);if(l&&f+a>u)break}S.restore(),this.textHeight=e,this.textWidth=i}},Kinetic.Util.extend(Kinetic.Text,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Text,"fontFamily","Arial"),Kinetic.Factory.addGetterSetter(Kinetic.Text,"fontSize",12),Kinetic.Factory.addGetterSetter(Kinetic.Text,"fontStyle",u),Kinetic.Factory.addGetterSetter(Kinetic.Text,"fontVariant",u),Kinetic.Factory.addGetterSetter(Kinetic.Text,"padding",0),Kinetic.Factory.addGetterSetter(Kinetic.Text,"align",c),Kinetic.Factory.addGetterSetter(Kinetic.Text,"lineHeight",1),Kinetic.Factory.addGetterSetter(Kinetic.Text,"wrap",m),Kinetic.Factory.addGetter(Kinetic.Text,"text",o),Kinetic.Factory.addOverloadedGetterSetter(Kinetic.Text,"text"),Kinetic.Collection.mapMethods(Kinetic.Text)}(),function(){Kinetic.Line=function(t){this.___init(t)},Kinetic.Line.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Line",this.on("pointsChange.kinetic tensionChange.kinetic closedChange.kinetic",function(){this._clearCache("tensionPoints")}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e,n,i,a=this.getPoints(),r=a.length,s=this.getTension(),o=this.getClosed();if(t.beginPath(),t.moveTo(a[0],a[1]),0!==s&&r>4){for(e=this.getTensionPoints(),n=e.length,i=o?0:4,o||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);n-2>i;)t.bezierCurveTo(e[i++],e[i++],e[i++],e[i++],e[i++],e[i++]);o||t.quadraticCurveTo(e[n-2],e[n-1],a[r-2],a[r-1])}else for(i=2;r>i;i+=2)t.lineTo(a[i],a[i+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)},getTensionPoints:function(){return this._getCache("tensionPoints",this._getTensionPoints)},_getTensionPoints:function(){return this.getClosed()?this._getTensionPointsClosed():Kinetic.Util._expandPoints(this.getPoints(),this.getTension())},_getTensionPointsClosed:function(){var t=this.getPoints(),e=t.length,n=this.getTension(),i=Kinetic.Util,a=i._getControlPoints(t[e-2],t[e-1],t[0],t[1],t[2],t[3],n),r=i._getControlPoints(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],n),s=Kinetic.Util._expandPoints(t,n),o=[a[2],a[3]].concat(s).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],a[0],a[1],t[0],t[1]]);return o}},Kinetic.Util.extend(Kinetic.Line,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Line,"closed",!1),Kinetic.Factory.addGetterSetter(Kinetic.Line,"tension",0),Kinetic.Factory.addGetterSetter(Kinetic.Line,"points"),Kinetic.Collection.mapMethods(Kinetic.Line)}(),function(){Kinetic.Sprite=function(t){this.___init(t)},Kinetic.Sprite.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Sprite",this.anim=new Kinetic.Animation,this.on("animationChange.kinetic",function(){this.frameIndex(0)}),this.on("frameRateChange.kinetic",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(t){var e=this.getAnimation(),n=this.frameIndex(),i=4*n,a=this.getAnimations()[e],r=a[i+0],s=a[i+1],o=a[i+2],c=a[i+3],l=this.getImage();l&&t.drawImage(l,r,s,o,c,0,0,o,c)},_hitFunc:function(t){var e=this.getAnimation(),n=this.frameIndex(),i=4*n,a=this.getAnimations()[e],r=a[i+2],s=a[i+3];t.beginPath(),t.rect(0,0,r,s),t.closePath(),t.fillShape(this)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()},_setInterval:function(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.getFrameRate())},start:function(){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()},stop:function(){this.anim.stop(),clearInterval(this.interval)},isRunning:function(){return this.anim.isRunning()},_updateIndex:function(){var t=this.frameIndex(),e=this.getAnimation(),n=this.getAnimations(),i=n[e],a=i.length/4;this.frameIndex(a-1>t?t+1:0)}},Kinetic.Util.extend(Kinetic.Sprite,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"animation"),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"animations"),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"image"),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"frameIndex",0),Kinetic.Factory.addGetterSetter(Kinetic.Sprite,"frameRate",17),Kinetic.Factory.backCompat(Kinetic.Sprite,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Kinetic.Collection.mapMethods(Kinetic.Sprite)}(),function(){Kinetic.Path=function(t){this.___init(t)},Kinetic.Path.prototype={___init:function(t){this.dataArray=[];var e=this;Kinetic.Shape.call(this,t),this.className="Path",this.dataArray=Kinetic.Path.parsePathData(this.getData()),this.on("dataChange.kinetic",function(){e.dataArray=Kinetic.Path.parsePathData(this.getData())}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.dataArray,n=!1;t.beginPath();for(var i=0;i<e.length;i++){var a=e[i].command,r=e[i].points;switch(a){case"L":t.lineTo(r[0],r[1]);break;case"M":t.moveTo(r[0],r[1]);break;case"C":t.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"Q":t.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case"A":var s=r[0],o=r[1],c=r[2],l=r[3],h=r[4],d=r[5],u=r[6],f=r[7],g=c>l?c:l,p=c>l?1:c/l,m=c>l?l/c:1;t.translate(s,o),t.rotate(u),t.scale(p,m),t.arc(0,0,g,h,h+d,1-f),t.scale(1/p,1/m),t.rotate(-u),t.translate(-s,-o);break;case"z":t.closePath(),n=!0}}n?t.fillStrokeShape(this):t.strokeShape(this)}},Kinetic.Util.extend(Kinetic.Path,Kinetic.Shape),Kinetic.Path.getLineLength=function(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))},Kinetic.Path.getPointOnLine=function(t,e,n,i,a,r,s){void 0===r&&(r=e),void 0===s&&(s=n);var o=(a-n)/(i-e+1e-8),c=Math.sqrt(t*t/(1+o*o));e>i&&(c*=-1);var l,h=o*c;if(i===e)l={x:r,y:s+h};else if((s-n)/(r-e+1e-8)===o)l={x:r+c,y:s+h};else{var d,u,f=this.getLineLength(e,n,i,a);if(1e-8>f)return;var g=(r-e)*(i-e)+(s-n)*(a-n);g/=f*f,d=e+g*(i-e),u=n+g*(a-n);var p=this.getLineLength(r,s,d,u),m=Math.sqrt(t*t-p*p);c=Math.sqrt(m*m/(1+o*o)),e>i&&(c*=-1),h=o*c,l={x:d+c,y:u+h}}return l},Kinetic.Path.getPointOnCubicBezier=function(t,e,n,i,a,r,s,o,c){function l(t){return t*t*t}function h(t){return 3*t*t*(1-t)}function d(t){return 3*t*(1-t)*(1-t)}function u(t){return(1-t)*(1-t)*(1-t)}var f=o*l(t)+r*h(t)+i*d(t)+e*u(t),g=c*l(t)+s*h(t)+a*d(t)+n*u(t);return{x:f,y:g}},Kinetic.Path.getPointOnQuadraticBezier=function(t,e,n,i,a,r,s){function o(t){return t*t}function c(t){return 2*t*(1-t)}function l(t){return(1-t)*(1-t)}var h=r*o(t)+i*c(t)+e*l(t),d=s*o(t)+a*c(t)+n*l(t);return{x:h,y:d}},Kinetic.Path.getPointOnEllipticalArc=function(t,e,n,i,a,r){var s=Math.cos(r),o=Math.sin(r),c={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:t+(c.x*s-c.y*o),y:e+(c.x*o+c.y*s)}},Kinetic.Path.parsePathData=function(t){if(!t)return[];var e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var i=0;i<n.length;i++)e=e.replace(new RegExp(n[i],"g"),"|"+n[i]);var a=e.split("|"),r=[],s=0,o=0;for(i=1;i<a.length;i++){var c=a[i],l=c.charAt(0);c=c.slice(1),c=c.replace(new RegExp(",-","g"),"-"),c=c.replace(new RegExp("-","g"),",-"),c=c.replace(new RegExp("e,-","g"),"e-");var h=c.split(",");h.length>0&&""===h[0]&&h.shift();for(var d=0;d<h.length;d++)h[d]=parseFloat(h[d]);for(;h.length>0&&!isNaN(h[0]);){var u,f,g,p,m,v,_,y,b,S,x=null,w=[],C=s,T=o;switch(l){case"l":s+=h.shift(),o+=h.shift(),x="L",w.push(s,o);break;case"L":s=h.shift(),o=h.shift(),w.push(s,o);break;case"m":var K=h.shift(),D=h.shift();if(s+=K,o+=D,x="M",r.length>2&&"z"===r[r.length-1].command)for(var k=r.length-2;k>=0;k--)if("M"===r[k].command){s=r[k].points[0]+K,o=r[k].points[1]+D;break}w.push(s,o),l="l";break;case"M":s=h.shift(),o=h.shift(),x="M",w.push(s,o),l="L";break;case"h":s+=h.shift(),x="L",w.push(s,o);break;case"H":s=h.shift(),x="L",w.push(s,o);break;case"v":o+=h.shift(),x="L",w.push(s,o);break;case"V":o=h.shift(),x="L",w.push(s,o);break;case"C":w.push(h.shift(),h.shift(),h.shift(),h.shift()),s=h.shift(),o=h.shift(),w.push(s,o);break;case"c":w.push(s+h.shift(),o+h.shift(),s+h.shift(),o+h.shift()),s+=h.shift(),o+=h.shift(),x="C",w.push(s,o);break;case"S":f=s,g=o,u=r[r.length-1],"C"===u.command&&(f=s+(s-u.points[2]),g=o+(o-u.points[3])),w.push(f,g,h.shift(),h.shift()),s=h.shift(),o=h.shift(),x="C",w.push(s,o);break;case"s":f=s,g=o,u=r[r.length-1],"C"===u.command&&(f=s+(s-u.points[2]),g=o+(o-u.points[3])),w.push(f,g,s+h.shift(),o+h.shift()),s+=h.shift(),o+=h.shift(),x="C",w.push(s,o);break;case"Q":w.push(h.shift(),h.shift()),s=h.shift(),o=h.shift(),w.push(s,o);break;case"q":w.push(s+h.shift(),o+h.shift()),s+=h.shift(),o+=h.shift(),x="Q",w.push(s,o);break;case"T":f=s,g=o,u=r[r.length-1],"Q"===u.command&&(f=s+(s-u.points[0]),g=o+(o-u.points[1])),s=h.shift(),o=h.shift(),x="Q",w.push(f,g,s,o);break;case"t":f=s,g=o,u=r[r.length-1],"Q"===u.command&&(f=s+(s-u.points[0]),g=o+(o-u.points[1])),s+=h.shift(),o+=h.shift(),x="Q",w.push(f,g,s,o);break;case"A":p=h.shift(),m=h.shift(),v=h.shift(),_=h.shift(),y=h.shift(),b=s,S=o,s=h.shift(),o=h.shift(),x="A",w=this.convertEndpointToCenterParameterization(b,S,s,o,_,y,p,m,v);break;case"a":p=h.shift(),m=h.shift(),v=h.shift(),_=h.shift(),y=h.shift(),b=s,S=o,s+=h.shift(),o+=h.shift(),x="A",w=this.convertEndpointToCenterParameterization(b,S,s,o,_,y,p,m,v)}r.push({command:x||l,points:w,start:{x:C,y:T},pathLength:this.calcLength(C,T,x||l,w)})}("z"===l||"Z"===l)&&r.push({command:"z",points:[],start:void 0,pathLength:0})}return r},Kinetic.Path.calcLength=function(t,e,n,i){var a,r,s,o,c=Kinetic.Path;switch(n){case"L":return c.getLineLength(t,e,i[0],i[1]);case"C":for(a=0,r=c.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),o=.01;1>=o;o+=.01)s=c.getPointOnCubicBezier(o,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),a+=c.getLineLength(r.x,r.y,s.x,s.y),r=s;return a;case"Q":for(a=0,r=c.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),o=.01;1>=o;o+=.01)s=c.getPointOnQuadraticBezier(o,t,e,i[0],i[1],i[2],i[3]),a+=c.getLineLength(r.x,r.y,s.x,s.y),r=s;return a;case"A":a=0;var l=i[4],h=i[5],d=i[4]+h,u=Math.PI/180;if(Math.abs(l-d)<u&&(u=Math.abs(l-d)),r=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),0>h)for(o=l-u;o>d;o-=u)s=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],o,0),a+=c.getLineLength(r.x,r.y,s.x,s.y),r=s;else for(o=l+u;d>o;o+=u)s=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],o,0),a+=c.getLineLength(r.x,r.y,s.x,s.y),r=s;return s=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),a+=c.getLineLength(r.x,r.y,s.x,s.y)}return 0},Kinetic.Path.convertEndpointToCenterParameterization=function(t,e,n,i,a,r,s,o,c){var l=c*(Math.PI/180),h=Math.cos(l)*(t-n)/2+Math.sin(l)*(e-i)/2,d=-1*Math.sin(l)*(t-n)/2+Math.cos(l)*(e-i)/2,u=h*h/(s*s)+d*d/(o*o);u>1&&(s*=Math.sqrt(u),o*=Math.sqrt(u));var f=Math.sqrt((s*s*o*o-s*s*d*d-o*o*h*h)/(s*s*d*d+o*o*h*h));a===r&&(f*=-1),isNaN(f)&&(f=0);var g=f*s*d/o,p=f*-o*h/s,m=(t+n)/2+Math.cos(l)*g-Math.sin(l)*p,v=(e+i)/2+Math.sin(l)*g+Math.cos(l)*p,_=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},y=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(_(t)*_(e))},b=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(y(t,e))},S=b([1,0],[(h-g)/s,(d-p)/o]),x=[(h-g)/s,(d-p)/o],w=[(-1*h-g)/s,(-1*d-p)/o],C=b(x,w);return y(x,w)<=-1&&(C=Math.PI),y(x,w)>=1&&(C=0),0===r&&C>0&&(C-=2*Math.PI),1===r&&0>C&&(C+=2*Math.PI),[m,v,s,o,S,C,l,r]},Kinetic.Factory.addGetterSetter(Kinetic.Path,"data"),Kinetic.Collection.mapMethods(Kinetic.Path)}(),function(){function t(t){t.fillText(this.partialText,0,0)}function e(t){t.strokeText(this.partialText,0,0)}var n="",i="normal";Kinetic.TextPath=function(t){this.___init(t)},Kinetic.TextPath.prototype={___init:function(n){var i=this;this.dummyCanvas=Kinetic.Util.createCanvasElement(),this.dataArray=[],Kinetic.Shape.call(this,n),this._fillFunc=t,this._strokeFunc=e,this._fillFuncHit=t,this._strokeFuncHit=e,this.className="TextPath",this.dataArray=Kinetic.Path.parsePathData(this.attrs.data),this.on("dataChange.kinetic",function(){i.dataArray=Kinetic.Path.parsePathData(this.attrs.data)}),this.on("textChange.kinetic textStroke.kinetic textStrokeWidth.kinetic",i._setTextData),i._setTextData(),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline","middle"),t.setAttr("textAlign","left"),t.save();for(var e=this.glyphInfo,n=0;n<e.length;n++){t.save();var i=e[n].p0;t.translate(i.x,i.y),t.rotate(e[n].rotation),this.partialText=e[n].text,t.fillStrokeShape(this),t.restore()}t.restore()},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},setText:function(t){Kinetic.Text.prototype.setText.call(this,t)},_getTextSize:function(t){var e=this.dummyCanvas,n=e.getContext("2d");n.save(),n.font=this._getContextFont();var i=n.measureText(t);return n.restore(),{width:i.width,height:parseInt(this.attrs.fontSize,10)}},_setTextData:function(){var t=this,e=this._getTextSize(this.attrs.text);this.textWidth=e.width,this.textHeight=e.height,this.glyphInfo=[];for(var n,i,a,r=this.attrs.text.split(""),s=-1,o=0,c=function(){o=0;for(var e=t.dataArray,i=s+1;i<e.length;i++){if(e[i].pathLength>0)return s=i,e[i];"M"==e[i].command&&(n={x:e[i].points[0],y:e[i].points[1]})}return{}},l=function(e){var r=t._getTextSize(e).width,s=0,l=0;for(i=void 0;Math.abs(r-s)/r>.01&&25>l;){l++;for(var h=s;void 0===a;)a=c(),a&&h+a.pathLength<r&&(h+=a.pathLength,a=void 0);if(a==={}||void 0===n)return;var d=!1;switch(a.command){case"L":Kinetic.Path.getLineLength(n.x,n.y,a.points[0],a.points[1])>r?i=Kinetic.Path.getPointOnLine(r,n.x,n.y,a.points[0],a.points[1],n.x,n.y):a=void 0;break;case"A":var u=a.points[4],f=a.points[5],g=a.points[4]+f;0===o?o=u+1e-8:r>s?o+=Math.PI/180*f/Math.abs(f):o-=Math.PI/360*f/Math.abs(f),(0>f&&g>o||f>=0&&o>g)&&(o=g,d=!0),i=Kinetic.Path.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],o,a.points[6]);break;case"C":0===o?o=r>a.pathLength?1e-8:r/a.pathLength:r>s?o+=(r-s)/a.pathLength:o-=(s-r)/a.pathLength,o>1&&(o=1,d=!0),i=Kinetic.Path.getPointOnCubicBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case"Q":0===o?o=r/a.pathLength:r>s?o+=(r-s)/a.pathLength:o-=(s-r)/a.pathLength,o>1&&(o=1,d=!0),i=Kinetic.Path.getPointOnQuadraticBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}void 0!==i&&(s=Kinetic.Path.getLineLength(n.x,n.y,i.x,i.y)),d&&(d=!1,a=void 0)}},h=0;h<r.length&&(l(r[h]),void 0!==n&&void 0!==i);h++){var d=Kinetic.Path.getLineLength(n.x,n.y,i.x,i.y),u=0,f=Kinetic.Path.getPointOnLine(u+d/2,n.x,n.y,i.x,i.y),g=Math.atan2(i.y-n.y,i.x-n.x);this.glyphInfo.push({transposeX:f.x,transposeY:f.y,text:r[h],rotation:g,p0:n,p1:i}),n=i}}},Kinetic.TextPath.prototype._getContextFont=Kinetic.Text.prototype._getContextFont,Kinetic.Util.extend(Kinetic.TextPath,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.TextPath,"fontFamily","Arial"),Kinetic.Factory.addGetterSetter(Kinetic.TextPath,"fontSize",12),Kinetic.Factory.addGetterSetter(Kinetic.TextPath,"fontStyle",i),Kinetic.Factory.addGetterSetter(Kinetic.TextPath,"fontVariant",i),Kinetic.Factory.addGetter(Kinetic.TextPath,"text",n),Kinetic.Collection.mapMethods(Kinetic.TextPath)}(),function(){Kinetic.RegularPolygon=function(t){this.___init(t)},Kinetic.RegularPolygon.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="RegularPolygon",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e,n,i,a=this.attrs.sides,r=this.attrs.radius;for(t.beginPath(),t.moveTo(0,0-r),e=1;a>e;e++)n=r*Math.sin(2*e*Math.PI/a),i=-1*r*Math.cos(2*e*Math.PI/a),t.lineTo(n,i);t.closePath(),t.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.RegularPolygon,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.RegularPolygon,"radius",0),Kinetic.Factory.addGetterSetter(Kinetic.RegularPolygon,"sides",0),Kinetic.Collection.mapMethods(Kinetic.RegularPolygon)}(),function(){Kinetic.Star=function(t){this.___init(t)},Kinetic.Star.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Star",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(var a=1;2*i>a;a++){var r=a%2===0?n:e,s=r*Math.sin(a*Math.PI/i),o=-1*r*Math.cos(a*Math.PI/i);t.lineTo(s,o)}t.closePath(),t.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Star,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Star,"numPoints",5),Kinetic.Factory.addGetterSetter(Kinetic.Star,"innerRadius",0),Kinetic.Factory.addGetterSetter(Kinetic.Star,"outerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Star)}(),function(){var t=["fontFamily","fontSize","fontStyle","padding","lineHeight","text"],e="Change.kinetic",n="none",i="up",a="right",r="down",s="left",o="Label",c=t.length;Kinetic.Label=function(t){this.____init(t)},Kinetic.Label.prototype={____init:function(t){var e=this;this.className=o,Kinetic.Group.call(this,t),this.on("add.kinetic",function(t){e._addListeners(t.child),e._sync()})},getText:function(){return this.find("Text")[0]},getTag:function(){return this.find("Tag")[0]},_addListeners:function(n){var i,a=this,r=function(){a._sync()};for(i=0;c>i;i++)n.on(t[i]+e,r)},getWidth:function(){return this.getText().getWidth()},getHeight:function(){return this.getText().getHeight()},_sync:function(){var t,e,n,o,c,l,h,d=this.getText(),u=this.getTag();if(d&&u){switch(t=d.getWidth(),e=d.getHeight(),n=u.getPointerDirection(),o=u.getPointerWidth(),h=u.getPointerHeight(),c=0,l=0,n){case i:c=t/2,l=-1*h;break;case a:c=t+o,l=e/2;break;case r:c=t/2,l=e+h;break;case s:c=-1*o,l=e/2}u.setAttrs({x:-1*c,y:-1*l,width:t,height:e}),d.setAttrs({x:-1*c,y:-1*l})}}},Kinetic.Util.extend(Kinetic.Label,Kinetic.Group),Kinetic.Collection.mapMethods(Kinetic.Label),Kinetic.Tag=function(t){this.___init(t)},Kinetic.Tag.prototype={___init:function(t){Kinetic.Shape.call(this,t),this.className="Tag",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var e=this.getWidth(),n=this.getHeight(),o=this.getPointerDirection(),c=this.getPointerWidth(),l=this.getPointerHeight();t.beginPath(),t.moveTo(0,0),o===i&&(t.lineTo((e-c)/2,0),t.lineTo(e/2,-1*l),t.lineTo((e+c)/2,0)),t.lineTo(e,0),o===a&&(t.lineTo(e,(n-l)/2),t.lineTo(e+c,n/2),t.lineTo(e,(n+l)/2)),t.lineTo(e,n),o===r&&(t.lineTo((e+c)/2,n),t.lineTo(e/2,n+l),t.lineTo((e-c)/2,n)),t.lineTo(0,n),o===s&&(t.lineTo(0,(n+l)/2),t.lineTo(-1*c,n/2),t.lineTo(0,(n-l)/2)),t.closePath(),t.fillStrokeShape(this)}},Kinetic.Util.extend(Kinetic.Tag,Kinetic.Shape),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"pointerDirection",n),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"pointerWidth",0),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"pointerHeight",0),Kinetic.Factory.addGetterSetter(Kinetic.Tag,"cornerRadius",0),Kinetic.Collection.mapMethods(Kinetic.Tag)}(),function(t){"use strict";t(["jquery"],function(t){function e(e){return t.isFunction(e)||t.isPlainObject(e)?e:{top:e,left:e}}var n=t.scrollTo=function(e,n,i){return t(window).scrollTo(e,n,i)};return n.defaults={axis:"xy",duration:0,limit:!0},n.window=function(e){return t(window)._scrollable()},t.fn._scrollable=function(){return this.map(function(){var e=this,n=!e.nodeName||-1!=t.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!n)return e;var i=(e.contentWindow||e).document||e.ownerDocument||e;return/webkit/i.test(navigator.userAgent)||"BackCompat"==i.compatMode?i.body:i.documentElement})},t.fn.scrollTo=function(i,a,r){return"object"==typeof a&&(r=a,a=0),"function"==typeof r&&(r={onAfter:r}),"max"==i&&(i=9e9),r=t.extend({},n.defaults,r),a=a||r.duration,r.queue=r.queue&&r.axis.length>1,r.queue&&(a/=2),r.offset=e(r.offset),r.over=e(r.over),this._scrollable().each(function(){function s(t){l.animate(d,a,r.easing,t&&function(){t.call(this,h,r)})}if(null!=i){var o,c=this,l=t(c),h=i,d={},u=l.is("html,body");switch(typeof h){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(h)){h=e(h);break}if(h=u?t(h):t(h,this),!h.length)return;case"object":(h.is||h.style)&&(o=(h=t(h)).offset())}var f=t.isFunction(r.offset)&&r.offset(c,h)||r.offset;t.each(r.axis.split(""),function(t,e){var i="x"==e?"Left":"Top",a=i.toLowerCase(),g="scroll"+i,p=c[g],m=n.max(c,e);if(o)d[g]=o[a]+(u?0:p-l.offset()[a]),r.margin&&(d[g]-=parseInt(h.css("margin"+i))||0,d[g]-=parseInt(h.css("border"+i+"Width"))||0),d[g]+=f[a]||0,r.over[a]&&(d[g]+=h["x"==e?"width":"height"]()*r.over[a]);else{var v=h[a];d[g]=v.slice&&"%"==v.slice(-1)?parseFloat(v)/100*m:v}r.limit&&/^\d+$/.test(d[g])&&(d[g]=d[g]<=0?0:Math.min(d[g],m)),!t&&r.queue&&(p!=d[g]&&s(r.onAfterFirst),delete d[g])}),s(r.onAfter)}}).end()},n.max=function(e,n){var i="x"==n?"Width":"Height",a="scroll"+i;if(!t(e).is("html,body"))return e[a]-t(e)[i.toLowerCase()]();var r="client"+i,s=e.ownerDocument.documentElement,o=e.ownerDocument.body;return Math.max(s[a],o[a])-Math.min(s[r],o[r])},n})}("function"==typeof define&&define.amd?define:function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(){if(!t.contains(document.documentElement,this))return t(this).timeago("dispose"),this;var e=n(this),s=r.settings;return isNaN(e.datetime)||(0==s.cutoff||Math.abs(a(e.datetime))<s.cutoff)&&t(this).text(i(e.datetime)),this}function n(e){if(e=t(e),!e.data("timeago")){e.data("timeago",{datetime:r.datetime(e)});var n=t.trim(e.text());r.settings.localeTitle?e.attr("title",e.data("timeago").datetime.toLocaleString()):!(n.length>0)||r.isTime(e)&&e.attr("title")||e.attr("title",n)}return e.data("timeago")}function i(t){return r.inWords(a(t))}function a(t){return(new Date).getTime()-t.getTime()}t.timeago=function(e){return i(e instanceof Date?e:"string"==typeof e?t.timeago.parse(e):"number"==typeof e?new Date(e):t.timeago.datetime(e));
};var r=t.timeago;t.extend(t.timeago,{settings:{refreshMillis:6e4,allowPast:!0,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",inPast:"any moment now",seconds:"less than a minute",minute:"a minute",minutes:"%d minutes",hour:" an hour",hours:"%d hours",day:"a day",days:"%d days",month:"a month",months:"%d months",year:"a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(e){function n(n,a){var r=t.isFunction(n)?n(a,e):n,s=i.numbers&&i.numbers[a]||a;return r.replace(/%d/i,s)}if(!this.settings.allowPast&&!this.settings.allowFuture)throw"timeago allowPast and allowFuture settings can not both be set to false.";var i=this.settings.strings,a=i.prefixAgo,r=i.suffixAgo;if(this.settings.allowFuture&&e<0&&(a=i.prefixFromNow,r=i.suffixFromNow),!this.settings.allowPast&&e>=0)return this.settings.strings.inPast;var s=Math.abs(e)/1e3,o=s/60,c=o/60,l=c/24,h=l/365,d=s<45&&n(i.seconds,Math.round(s))||s<90&&n(i.minute,1)||o<45&&n(i.minutes,Math.round(o))||o<90&&n(i.hour,1)||c<24&&n(i.hours,Math.round(c))||c<42&&n(i.day,1)||l<30&&n(i.days,Math.round(l))||l<45&&n(i.month,1)||l<365&&n(i.months,Math.round(l/30))||h<1.5&&n(i.year,1)||n(i.years,Math.round(h)),u=i.wordSeparator||"";return void 0===i.wordSeparator&&(u=" "),t.trim([a,d,r].join(u))},parse:function(e){var n=t.trim(e);return n=n.replace(/\.\d+/,""),n=n.replace(/-/,"/").replace(/-/,"/"),n=n.replace(/T/," ").replace(/Z/," UTC"),n=n.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),n=n.replace(/([\+\-]\d\d)$/," $100"),new Date(n)},datetime:function(e){var n=r.isTime(e)?t(e).attr("datetime"):t(e).attr("title");return r.parse(n)},isTime:function(e){return"time"===t(e).get(0).tagName.toLowerCase()}});var s={init:function(){var n=t.proxy(e,this);n();var i=r.settings;i.refreshMillis>0&&(this._timeagoInterval=setInterval(n,i.refreshMillis))},update:function(n){var i=r.parse(n);t(this).data("timeago",{datetime:i}),r.settings.localeTitle&&t(this).attr("title",i.toLocaleString()),e.apply(this)},updateFromDOM:function(){t(this).data("timeago",{datetime:r.parse(r.isTime(this)?t(this).attr("datetime"):t(this).attr("title"))}),e.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};t.fn.timeago=function(t,e){var n=t?s[t]:s.init;if(!n)throw new Error("Unknown function name '"+t+"' for timeago");return this.each(function(){n.call(this,e)}),this},document.createElement("abbr"),document.createElement("time")});var ride=$(".joyride-layer").data("ride");$(document).on("click",".show-tutorial",function(){runJoyride()}),$(document).on("change","#select-all-schools",function(){var t=$(this),e=$(".list-items .school.item"),n=!1;t.is(":checked")&&(n=!0),$.each(e,function(){$(this).find(".select-school-chkbx").prop("checked",n).trigger("change")})}),$(document).on("change",".select-school-chkbx",function(){var t=$(this),e=t.closest(".school.item");t.is(":checked")?e.addClass("selected"):e.removeClass("selected")}),$(document).on("showTutorial",function(){ride=$(".joyride-layer").data("ride"),ride||runJoyride()}),$(document).on("click",".revenue-organizaton-button",function(t){var e=$(this).data("college"),n=$("#partner-redirect-modal"),i=$("#recruitmeModal"),a=e.ro_detail.type;$(".manage-students-ajax-loader").show(),$.ajax({url:"/ajax/recruiteme/"+e.college_id,type:"GET",data:{ro_id:e.ro_detail.ro_id},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(t){"click"==a||"linkout"==a?"success"==t.status&&(n.data("url",t.url),n.foundation("reveal","open")):"post"==a&&(i.html(t),i.foundation("reveal","open")),$(".manage-students-ajax-loader").hide()})}),$(document).on("click","#partner-redirect-modal .partner-redirect-continue-button",function(t){var e=$("#partner-redirect-modal"),n=e.data("url");window.open(n,"_blank"),e.foundation("reveal","close")});var isInIframe=window.location!=window.parent.location;isInIframe&&parent.setIframeHeight($(document).height()+5);var m=moment(),handleCalendar=function(){var t=new Date,e=(t.getDate(),t.getMonth(),t.getFullYear(),{});new Date;$("#calendar").fullCalendar({header:e,defaultView:"month",editable:!1,height:"1000",eventClick:function(t,e,n){attachIframe(t.id)},selectable:!0,selectHelper:!0,select:function(t,e,n){var i=new Date(t),a=(new Date,$.fullCalendar.moment(i));a=a.format("MM-DD-YYYY");var r=$.fullCalendar.moment(r);r=r.format("MM-DD-YYYY"),a<r?$("#event-notallowed-modal").foundation("reveal","open"):$("#event-add-modal").foundation("reveal","open")},droppable:!0,drop:function(t,e){},eventSources:"/getevents",eventMouseover:function(t,e){var n=t.start;n=moment(n,"YYYY-MM-DD hh:mm:ss a"),n=n.format("MMM D");var i=t.end;i=moment(i,"YYYY-MM-DD hh:mm:ss a"),i=i.format("MMM D");var a="";a+='<div class="event-tooltip tooltipevent">',a+='<div class="event-title-detail"><span class="fs16">'+t.title+'</span> <span class="fs22 d-block pt10">'+n+" - "+i+"</span></div>",a+='<div class="event-body-detail">',a+='<div class="small-12">',a+='<div class="small-4 columns"> <img src="/images/collge_logo2.png"></div>',a+='<div class="small-8 columns no-padding pt10">',a+='<span class="c-blue fs18 f-bold">UCI</span>  <br />  <span class="c79 fs14">Irvine CA</span>',a+='</div><div class="clearfix"></div></div></div></div>',$("body").append(a),$(this).mouseover(function(t){$(this).css("z-index",1e4),$(".tooltipevent").fadeIn("500"),$(".tooltipevent").fadeTo("10",1.9)}).mousemove(function(t){$(".tooltipevent").css("top",t.pageY+10),$(".tooltipevent").css("left",t.pageX+20)})},eventMouseout:function(t,e){$(this).css("z-index",8),$(".tooltipevent").remove()},eventAfterAllRender:function(t){setCurrMonthText()}}),$(".prev-button").click(function(){$("#calendar").fullCalendar("next"),setCurrMonthText()}),$(".next-button").click(function(){$("#calendar").fullCalendar("prev");setCurrMonthText()})};$('[name="other-chk"]').click(function(){$('[name="other-chk"]').is(":checked")?$('[name="other_val"]').show():$('[name="other_val"]').hide()}),$(window).resize(function(){$(window).width()<640?$(".rightMessageColumn").is(":visible")&&$(".leftMessageColumn").is(":visible")?($(".leftMessageColumn").show(),$(".rightMessageColumn").hide()):$(".rightMessageColumn").is(":visible")?$(".rightMessageColumn").show():$(".leftMessageColumn").show():($(".rightMessageColumn").show(),$(".leftMessageColumn").show())}),$(document).on("click",".messageMainWindow .leftMessageColumn .messageContacts:not(.loadmore-row)",function(){if($(window).width()<640){var t=" < "+$(this).find(".messageName").text();$(".chat-msg-title-back").addClass("is-mobile-back-btn").html(t),Plex.common.slideHide($(this).closest(".leftMessageColumn"),$(".rightMessageColumn"),"left",500)}}),$(document).on("click",".chat-msg-title-back.is-mobile-back-btn",function(){$(window).width()<640&&($(".chat-msg-title-back").removeClass("is-mobile-back-btn").html("MESSAGE CENTER"),Plex.common.slideHide($(".rightMessageColumn"),$(".leftMessageColumn"),"right",500))}),$(document).on("click","#content-list-div .eddy-school-link",function(){window.open("https://www.elearners.com/a/Plexuss","_blank")}),$(document).on("mouseover",".appl-tip",function(){$(this).parent().find(".appl-tipper").show()}),$(document).on("mouseout",".appl-tip",function(){$(this).parent().find(".appl-tipper").hide()}),Plex.messages={windowActiveNow:void 0,enterEnabled:!0,currentTopicIdSelected:void 0,currentTopicNumUnread:void 0,recipient_id:void 0,sticky_recipient_type:void 0,firstMessageIdInTopic:void 0,lastMessageIdInTopic:void 0,lastMessageDateInTopic:void 0,lastMessageUserInTopic:void 0,lastMessageTimestampInTopic:void 0,bottomMessageReadGap:10,messageheartbeattime:5e3,ReadScrollDisabled:!0,sticky_recipient_id:void 0,stickyEnabled:!1,sendMessageUrl:"/ajax/messaging/postMsg",topicReadUrl:"/admin/ajax/messages/setMsgRead/",getMsgsHistoryUrl:"/ajax/messaging/getHistoryMsg/",noMoreHistoryMsg:!1,messageArea:void 0,sendButton:void 0,idleChecker:void 0,messageWindow:void 0,sticky_thread_type:void 0,isAjaxRunning:!1,isPrevMessageRunning:!1,leftHandsideMessagesTopics:void 0,isText:!1},$(document).ready(function(){Plex.messages.initialize(),Plex.messages.isText(),$(".rightMessageColumn .msgScrollBox").scroll(function(){var t=$(this);0==t.scrollTop()&&0==Plex.messages.noMoreHistoryMsg&&Plex.messages.getPreviousMessages()})}),Plex.messages.initialize=function(){this.cacheMessagesItems(),this.bindTextareaEnter(),this.setReadMessageScrollChecker(),this.setIdleChecker()},Plex.messages.setIdleChecker=function(){if(this.idleChecker)return void console.log("messages idle checker already exists!");var t=this;this.idleChecker=$(document).idle({onIdle:function(){t.stopMessageHeartBeatTimer(),$("#messages_idle_overlay").show("slide",{direction:"left"},250).closest(".idle_overlay_wrapper").css({"z-index":"2"})},onActive:function(){var e=$(".messageMainWindow");e.length&&!e.is(":hidden")&&(t.stopMessageHeartBeatTimer(),t.getTopicList(t.startMessageHeartBeatTimer),$("#messages_idle_overlay").hide("slide",{direction:"left"},250).closest(".idle_overlay_wrapper").css({"z-index":"1"}))},idle:6e5})},Plex.messages.cacheMessagesItems=function(){this.messageArea=$(".msgScrollBox"),this.sendButton=$(".messageTxtbox").children(".row").find(".sendbutton"),this.mainMessagesCount=$(".switchbuttons-wrapper").children(".switchbuttons.privateChatButton").children(".unread_count")},Plex.messages.changeTopic=function(t){var e=$(".leftMessageColumn"),n=$(".rightMessageColumn"),i=$(t),a=i.data("is-text");a&&+a?Plex.messages.enableTextMessaging():Plex.messages.disableTextMessaging(),this.currentTopicIdSelected=i.data("topicid"),this.currentTopicNumUnread=i.data("num_unread"),this.recipient_id=i.data("recipient_id"),this.sticky_recipient_type=i.data("sticky_recipient_type"),this.lastMessageIdInTopic=void 0,this.firstMessageIdInTopic=void 0,this.noMoreHistoryMsg=!1,this.lastMessageDateInTopic=void 0,this.lastMessageUserInTopic=void 0,this.lastMessageTimestampInTopic=void 0,e.find(".messageContacts").removeClass("selected");var r=e.find(".messageReadActive");if(void 0!==r){r.removeClass("messageReadActive"),r.addClass("messageRead");var s=i.find(".messageRead");s.removeClass("messageRead"),s.addClass("messageReadActive")}n.find(".msgScrollBox").html(""),i.addClass("selected"),this.getMessages(),this.setThreadRead()},Plex.messages.getDataInfoFromSelectedItem=function(t){"undefined"==typeof this.currentTopicIdSelected&&(this.currentTopicIdSelected=t.data("topicid")),"undefined"==typeof this.currentTopicNumUnread&&(this.currentTopicNumUnread=t.data("num_unread")),"undefined"==typeof this.recipient_id&&(this.recipient_id=t.data("recipient_id")),"undefined"==typeof this.sticky_recipient_type&&(this.sticky_recipient_type=t.data("sticky_recipient_type"))},Plex.messages.getTopicList=function(t){var e=this,n="";if(!Plex.messages.isAjaxRunning){if(Plex.messages.isAjaxRunning=!0,this.stickyEnabled){var i=$(".leftMessageColumn .usersArea"),a=i.find(".messageContacts:first-child");this.getDataInfoFromSelectedItem(a),n=this.getUserNewTopicsUrl+"/"+e.sticky_recipient_id+"/"+e.sticky_recipient_type}else n=this.getUserNewTopicsUrl;$.ajax({url:n,type:"GET",dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(t){Plex.messages.isAjaxRunning=!1,Plex.messages.leftHandsideMessagesTopics!==t.topicUsr&&(Plex.messages.leftHandsideMessagesTopics=t.topicUsr,e.addTopicList(t))}),"undefined"!=typeof t&&t()}},Plex.messages.loadMoreMessages=function(t){var e=this,n="";if(Plex.messages.isAjaxRunning=!0,this.stickyEnabled){var i=$(".leftMessageColumn .usersArea"),a=i.find(".messageContacts:first-child");this.getDataInfoFromSelectedItem(a),n=this.getUserNewTopicsUrl+"/"+e.sticky_recipient_id+"/"+e.sticky_recipient_type+"?loadMore=true"}else n=this.getUserNewTopicsUrl+"?loadMore=true";$(".loading-more img").show(),$.ajax({url:n,type:"GET",dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(t){$(".loading-more").hide(),Plex.messages.isAjaxRunning=!1,Plex.messages.leftHandsideMessagesTopics!==t.topicUsr&&(Plex.messages.leftHandsideMessagesTopics=t.topicUsr,e.addTopicList(t))})},Plex.messages.addTopicList=function(t){var e="",n=this,i=0,a=0;$.each(t.topicUsr,function(t,r){var s=r.thread_members.length,o=parseInt(r.num_unread_msg)?" has_unread":"";i=r.thread_total_count,a++;var c="";if(1==r.has_text?c="activeText":1==r.is_campaign&&(c="activeCampaign"),s>1){e+='<div class="row messageContacts'+o+" "+c+'" data-num_unread="'+r.num_unread_msg+'" data-topicid="'+r.thread_id+'" data-recipient_id="'+r.thread_type_id+'" data-sticky_recipient_type="'+r.thread_type+'" data-is-text="'+r.has_text+'" onclick="Plex.messages.changeTopic(this);">',e+='<div class="column">',e+='<div class="row">',$.each(r.thread_members,function(t,n){var i=t+1,a="";a=i==s?"end":"",e+='<div class="column small-2 '+a+'">',e+='<img src="'+n.img+'" alt="'+n.Name+'" title="'+n.Name+'" >',e+="</div>"}),e+="</div>",e+="</div>",e+='<div class="column small-7">',e+='<div class="row">',e+='<div class="column small-12 text-left messageName">'+r.Name+"</div>",e+='<div class="column small-12 text-left messageSample">'+r.msg+"</div>",e+="</div>",e+="</div>";var l;l=0==r.num_unread_msg?"&nbsp;":r.num_unread_msg,r.msg_read_time!=-1&&void 0!==r.msg_read_time?(e+=n.stickyEnabled&&0===t&&""+r.num_unread_msg=="0"&&"Read"===r.msg_read_time?'<div class="column small-12 messageRead inline hidden">':'<div class="column small-12 messageRead inline">',e+="<span>"+r.msg_read_time+"</span>",e+="</div>"):e+='<div class="column small-3 messageDate inline">'+r.formatted_date+"</div>",e+="</div>"}else{e+='<div class="row messageContacts'+o+" "+c+'" data-num_unread="'+r.num_unread_msg+'" data-topicid="'+r.thread_id+'" data-recipient_id="'+r.thread_type_id+'" data-sticky_recipient_type="'+r.thread_type+'" data-is-text="'+r.has_text+'" onclick="Plex.messages.changeTopic(this);">',e+='<div class="column small-2">',e+='<img src="'+r.img+'" alt="'+r.Name+'" title="'+r.Name+'">',e+="</div>",e+='<div class="column small-7">',e+='<div class="row">',e+='<div class="column small-12 text-left messageName">'+r.Name+"</div>",e+='<div class="column small-12 text-left messageSample">'+r.msg+"</div>",e+="</div>",e+="</div>";var l;l=0==r.num_unread_msg?"&nbsp;":r.num_unread_msg,r.msg_read_time!=-1&&void 0!==r.msg_read_time?(e+=n.stickyEnabled&&0===t&&""+r.num_unread_msg=="0"&&"Read"===r.msg_read_time?'<div class="column small-12 messageRead inline hidden">':'<div class="column small-12 messageRead inline">',e+="<span>"+r.msg_read_time+"</span>",e+="</div>"):e+='<div class="column small-3 messageDate inline">'+r.formatted_date+"</div>",e+="</div>"}}),i>10&&(a>=i?(e+='<div class="row messageContacts">',e+='<div class="column small-12 text-center noMoreMessages">No more results</div>',e+="</div>"):(e+='<div class="row messageContacts loadmore-row">',e+='<div class="column small-12 text-center loadMoreMessages" onclick="Plex.messages.loadMoreMessages(this);"><span class="loading-more"><img src="https://s3-us-west-2.amazonaws.com/asset.plexuss.com/news/images/loading.gif" alt="loading gif" /></span>Show more results</div>',e+="</div>"));var r=$(".leftMessageColumn .usersArea");if(r.html(e),"undefined"==typeof this.currentTopicIdSelected){var s=r.find(".messageContacts:first-child");this.currentTopicIdSelected=s.data("topicid"),this.recipient_id=s.data("recipient_id"),this.sticky_recipient_type=s.data("sticky_recipient_type")}this.stickyEnabled&&this.currentTopicIdSelected==this.sticky_recipient_id;var o=r.find("[data-topicid="+this.currentTopicIdSelected+"]");o.length||(o=r.find('[data-recipient_id="'+this.sticky_recipient_id+'"]')),o.addClass("selected");var c=o.find(".messageRead");c.removeClass("messageRead"),c.addClass("messageReadActive"),this.currentTopicNumUnread=o.data("num_unread"),this.setThreadRead(),this.getMessages()},Plex.messages.getMessages=function(){var t=this,e="",n=!1,i=!1;Plex.messages.isAjaxRunning=!0,"undefined"!=typeof this.lastMessageIdInTopic?(e=this.getMessagesUrl+this.currentTopicIdSelected+"/"+this.lastMessageIdInTopic,n=!0):e=this.getMessagesUrl+this.currentTopicIdSelected,$.ajax({url:e,type:"GET",dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(e){var a=null;a=e.college_rep_info?e.college_rep_info:e.user_info,null!=a&&"[]"!=a?Plex.initRep(JSON.parse(a)):Plex.unmountStudentPanel&&Plex.unmountStudentPanel(),Plex.messages.isAjaxRunning=!1,e=JSON.parse(e.msg),0!=e.length&&t.addmessages(e,n,i)})},Plex.messages.getPreviousMessages=function(){var t=this,e="",n=!1,i=!0;Plex.messages.isPrevMessageRunning||(Plex.messages.isPrevMessageRunning=!0,e=this.getMsgsHistoryUrl+this.currentTopicIdSelected+"/-1/"+Plex.messages.firstMessageIdInTopic,$.ajax({url:e,type:"GET",dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(e){Plex.messages.isPrevMessageRunning=!1,e=JSON.parse(e.msg),0==e.length?(Plex.messages.noMoreHistoryMsg=!0,$(".rightMessageColumn .msgScrollBox .msg_history_load_more").remove()):t.addmessages(e,n,i)}))},Plex.messages.addmessages=function(t,e,n){var i="",a=!1,r=$(".rightMessageColumn .msgScrollBox"),s=0,o=0;$.each(t,function(t,n){var r=Plex.messages.lastMessageDateInTopic,c=Plex.common.make_date(n.date);if(c=c.toLocaleDateString(),o=n.show_previous_msg,a||e||(a=!0,Plex.messages.firstMessageIdInTopic=n.msg_id),r!=c){Plex.messages.lastMessageDateInTopic=c;var l=Plex.common.get_date_separator(n.date);i+="<div class='row dateSeparator text-center'>",i+="<div class='separatorStrike strikeLeft'></div>",i+="<div class='small-12 column'>",i+=l,i+="</div>",i+="<div class='separatorStrike strikeRight'></div>",i+="</div>"}var h="";n.is_org&&(h=" orgMsg");var d="";n.is_current_user&&(d=" currentUser");var u="",f="";if(0!=s){var g=Plex.messages.lastMessageUserInTopic;Plex.messages.lastMessageUserInTopic=n.full_name,g==n.full_name&&(u=" hideUser")}var p=n.time,m="";if(0!=s){var v=Plex.messages.lastMessageTimestampInTopic;Plex.messages.lastMessageTimestampInTopic=p,v==p&&(m=" hideTime")}i+='<div class="row messageitems'+h+d+u+m+f+'" data-message_id="'+n.msg_id+'">',i+='<div class="column medium-2 msgName"',i+=' title="'+n.full_name+'">'+n.Name+"</div>",i+='<div class="column medium-9 message">'+n.msg+"</div>",i+='<div class="column medium-1 msgDate messageDate medium-text-right">'+p+"</div>",i+="</div>",s++}),n?($(".rightMessageColumn .msgScrollBox .msg_history_load_more").remove(),$(".rightMessageColumn .msgScrollBox").prepend(i)):e?($(".rightMessageColumn .msgScrollBox").append(i),Plex.messages.scrollMsgWindow()):($(".rightMessageColumn .msgScrollBox").html(i),Plex.messages.scrollMsgWindow()),r.hasScrollBar()||1!=o||($(".rightMessageColumn .msgScrollBox .msg_history_load_more").remove(),i='<div onclick="Plex.messages.getPreviousMessages();" class="column small-1 small-centered msg_history_load_more"><span class="column small-12 small-centered">Show Previous Messages</span></div>',$(".rightMessageColumn .msgScrollBox").prepend(i)),this.lastMessageIdInTopic=$(".messageitems:last-child").data("message_id")},Plex.messages.bindTextareaEnter=function(){var t=$(".msgtext");t.keypress(function(t){13!=t.keyCode||t.shiftKey||(t.preventDefault(),Plex.messages.sendMessage())})},Plex.messages.sendMessage=function(){var t=$(".msgtext");t.find(".remove-file-btn").remove();var e=t.html();if(""!=e&&this.enterEnabled){this.disableSubmit(),t.html(""),Plex.messages.stopMessageHeartBeatTimer(),this.recipient_id==this.sticky_recipient_id&&(this.stickyEnabled=!1,this.sticky_recipient_id=void 0);var n=this.sendMessageUrl,i={};if(i.thread_id=this.currentTopicIdSelected,i.message=e,this.currentTopicIdSelected==-1){switch(this.sticky_recipient_type){case"user":case"users":0==this.stickyEnabled?(i.to_user_id=this.recipient_id,i.college_id=this.college_id):(i.to_user_id=this.sticky_recipient_id,i.college_id=this.college_id);break;case"college":case"colleges":0==this.stickyEnabled?(i.to_user_id="",i.college_id=this.recipient_id):(i.to_user_id="",i.college_id=this.sticky_recipient_id);break;default:console.log("we need a sticky recipient type in order to create a thread!")}i.thread_type=this.sticky_thread_type,this.sticky_thread_type=void 0}var a=this;$.ajax({method:"POST",url:n,data:i,dataType:"text",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){/^\d+$/.test(t)&&(Plex.messages.currentTopicIdSelected=t),a.getTopicList(a.startMessageHeartBeatTimer)}}).always(function(){Plex.messages.enableSubmit()}),mixpanel.track("Message_Student_Offline",{location:document.body.id})}},Plex.messages.toggleSendButton=function(t){var e=this.sendButton;"undefined"==typeof t||0==t?e.hasClass("disabled")||e.addClass("disabled"):e.hasClass("disabled")&&e.removeClass("disabled")},Plex.messages.scrollMsgWindow=function(){var t=$(".msgScrollBox"),e=t.prop("scrollHeight")-t.height();t.animate({scrollTop:e},250)},Plex.messages.startMessageHeartBeatTimer=function(){Plex.messages.hbtimer&&clearInterval(Plex.messages.hbtimer),Plex.messages.hbtimer=setInterval(function(){Plex.messages.getTopicList()},Plex.messages.messageheartbeattime)},Plex.messages.stopMessageHeartBeatTimer=function(){clearInterval(Plex.messages.hbtimer)},Plex.messages.setReadMessageScrollChecker=function(){this.messageArea.scroll(function(){if(!Plex.messages.ReadScrollDisabled){var t=$(this),e=t.height(),n=t.scrollTop(),i=t.prop("scrollHeight");i-n==e&&Plex.messages.setThreadRead()}})},Plex.messages.setThreadRead=function(){if(this.currentTopicNumUnread&&(message_area=this.messageArea,!message_area.hasScrollBar()||message_area.scrollTop()+message_area.innerHeight()>=message_area[0].scrollHeight)){var t=Plex.messages.topicReadUrl+Plex.messages.currentTopicIdSelected;$.ajax({url:t,type:"GET",dataType:"html",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(){})}},Plex.messages.enableSubmit=function(){Plex.messages.toggleSendButton(1),Plex.messages.enterEnabled=!0},Plex.messages.disableSubmit=function(){Plex.messages.toggleSendButton(),Plex.messages.enterEnabled=!1},Plex.messages.isText=function(){window.location.pathname.indexOf("inquiry-txt")>-1?(Plex.messages.isText=!0,Plex.messages.enableTextMessaging()):$(".leftMessageColumn .usersArea > div:first-child").trigger("click")},$(document).on("keyup",".msgtext",function(){if(Plex.messages.isText){var t=$(this).val().length;t<=160?$("#current-text-count").html(t):e.preventDefault()}}),Plex.messages.enableTextMessaging=function(){var t=$(".msgtext");t.prop("maxLength",160),t.prop("placeholder","Text Message"),t.addClass("is-text"),$(".text-count, .text-label").show()},Plex.messages.disableTextMessaging=function(){var t=$(".msgtext");t.removeAttr("maxLength"),t.removeAttr("placeholder"),t.removeClass("is-text"),$(".text-count, .text-label").hide()},"undefined"!=typeof Plex&&(Plex.common={}),function(t){t.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()}}(jQuery),Plex.common.get_date_separator=function(t){timestamp=this.make_date(t),now=new Date;var e=timestamp.getTime(),n=now.getTime(),i=n-e,a=36e5*now.getHours()+6e4*now.getMinutes()+1e3*now.getSeconds()+now.getMilliseconds(),r="";return i<6048e5-a?(r=this.get_weekday(timestamp),i<1728e5-a&&(r="Yesterday",i<a&&(timestamp,r="Today")),r):timestamp.toLocaleDateString()},Plex.common.get_weekday=function(t){var e=t.getDay(),n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return n[e]},Plex.common.make_date=function(t){var e=t.split(" "),n=e[0],i=e[1],a=n.split("-"),r=a[0],s=a[1];s=parseInt(s),s--;var o=a[2],c=i.split(":"),l=c[0],h=c[1],d=c[2],u=new Date(Date.UTC(r,s,o,l,h,d));return u},Plex.common.get_timestamp_time=function(t){timestamp_date=this.make_date(t);var e=timestamp_date.toLocaleTimeString();return formatted_time_arr=e.split(":",2),formatted_time_suffix_arr=e.split(" "),timestamp_time=formatted_time_arr[0]+":"+formatted_time_arr[1]+" "+formatted_time_suffix_arr[1],timestamp_time},Plex.common.slideHide=function(t,e,n,i){var a="left";"left"===n&&(a="right"),$(t).hide("slide",{direction:n},i,function(){Plex.common.slideShow(e,a,i)})},Plex.common.slideShow=function(t,e,n){$(t).show("slide",{direction:e},n)};